{"file_contents":{"components/ThemedText.tsx":{"content":"import { Text, type TextProps } from \"react-native\";\n\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { Typography } from \"@/constants/theme\";\n\nexport type ThemedTextProps = TextProps & {\n  lightColor?: string;\n  darkColor?: string;\n  type?: \"h1\" | \"h2\" | \"h3\" | \"h4\" | \"body\" | \"small\" | \"caption\" | \"link\";\n};\n\nexport function ThemedText({\n  style,\n  lightColor,\n  darkColor,\n  type = \"body\",\n  ...rest\n}: ThemedTextProps) {\n  const { theme, isDark } = useTheme();\n\n  const getColor = () => {\n    if (isDark && darkColor) {\n      return darkColor;\n    }\n\n    if (!isDark && lightColor) {\n      return lightColor;\n    }\n\n    if (type === \"link\") {\n      return theme.link;\n    }\n\n    return theme.text;\n  };\n\n  const getTypeStyle = () => {\n    switch (type) {\n      case \"h1\":\n        return Typography.h1;\n      case \"h2\":\n        return Typography.h2;\n      case \"h3\":\n        return Typography.h3;\n      case \"h4\":\n        return Typography.h4;\n      case \"body\":\n        return Typography.body;\n      case \"small\":\n        return Typography.small;\n      case \"caption\":\n        return Typography.caption;\n      case \"link\":\n        return Typography.link;\n      default:\n        return Typography.body;\n    }\n  };\n\n  return (\n    <Text style={[{ color: getColor() }, getTypeStyle(), style]} {...rest} />\n  );\n}\n","path":null,"size_bytes":1320,"size_tokens":null},"navigation/OrgsStackNavigator.tsx":{"content":"import React from \"react\";\nimport { Pressable } from \"react-native\";\nimport { createNativeStackNavigator } from \"@react-navigation/native-stack\";\nimport { Feather } from \"@expo/vector-icons\";\nimport OrganizationsScreen from \"@/screens/OrganizationsScreen\";\nimport OrganizationHubScreen from \"@/screens/OrganizationHubScreen\";\nimport CreateOrganizationScreen from \"@/screens/CreateOrganizationScreen\";\nimport CreatePostScreen from \"@/screens/CreatePostScreen\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { getCommonScreenOptions } from \"@/navigation/screenOptions\";\n\nexport type OrgsStackParamList = {\n  Organizations: undefined;\n  OrganizationHub: { orgId: string };\n  CreateOrganization: undefined;\n  CreatePost: { orgId?: string; orgName?: string; postToOrgFeed?: boolean };\n};\n\nconst Stack = createNativeStackNavigator<OrgsStackParamList>();\n\nexport default function OrgsStackNavigator() {\n  const { theme, isDark } = useTheme();\n\n  return (\n    <Stack.Navigator\n      screenOptions={{\n        ...getCommonScreenOptions({ theme, isDark, transparent: false }),\n      }}\n    >\n      <Stack.Screen\n        name=\"Organizations\"\n        component={OrganizationsScreen}\n        options={({ navigation }) => ({\n          headerTitle: \"Organizations\",\n          headerRight: () => (\n            <Pressable\n              onPress={() => navigation.navigate(\"CreateOrganization\")}\n              style={({ pressed }) => ({ opacity: pressed ? 0.7 : 1 })}\n            >\n              <Feather name=\"plus\" size={24} color={theme.text} />\n            </Pressable>\n          ),\n        })}\n      />\n      <Stack.Screen\n        name=\"OrganizationHub\"\n        component={OrganizationHubScreen}\n        options={{\n          headerTitle: \"\",\n          headerTransparent: true,\n        }}\n      />\n      <Stack.Screen\n        name=\"CreateOrganization\"\n        component={CreateOrganizationScreen}\n        options={{\n          headerTitle: \"New Organization\",\n          presentation: \"modal\",\n        }}\n      />\n      <Stack.Screen\n        name=\"CreatePost\"\n        component={CreatePostScreen}\n        options={{\n          headerShown: false,\n          presentation: \"modal\",\n        }}\n      />\n    </Stack.Navigator>\n  );\n}\n","path":null,"size_bytes":2217,"size_tokens":null},"screens/MessagesScreen.tsx":{"content":"import React, { useCallback } from \"react\";\nimport {\n  View,\n  StyleSheet,\n  FlatList,\n  Pressable,\n  RefreshControl,\n} from \"react-native\";\nimport { useBottomTabBarHeight } from \"@react-navigation/bottom-tabs\";\nimport { useNavigation } from \"@react-navigation/native\";\nimport { NativeStackNavigationProp } from \"@react-navigation/native-stack\";\nimport { Feather } from \"@expo/vector-icons\";\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { ThemedView } from \"@/components/ThemedView\";\nimport { ScreenScrollView } from \"@/components/ScreenScrollView\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { useData } from \"@/contexts/DataContext\";\nimport { Spacing, BorderRadius } from \"@/constants/theme\";\nimport { Conversation } from \"@/types\";\nimport { MessagesStackParamList } from \"@/navigation/MessagesStackNavigator\";\n\nfunction ConversationRow({\n  conversation,\n  onPress,\n}: {\n  conversation: Conversation;\n  onPress: () => void;\n}) {\n  const { theme } = useTheme();\n  const displayName =\n    conversation.type === \"group\"\n      ? conversation.participantNames.join(\", \")\n      : conversation.participantNames[0] || \"Unknown\";\n\n  const initial = displayName.charAt(0).toUpperCase();\n  const timeAgo = conversation.lastMessageAt\n    ? getTimeAgo(conversation.lastMessageAt)\n    : \"\";\n\n  return (\n    <Pressable\n      style={({ pressed }) => [\n        styles.conversationRow,\n        {\n          backgroundColor: pressed ? theme.backgroundSecondary : \"transparent\",\n        },\n      ]}\n      onPress={onPress}\n    >\n      <View\n        style={[\n          styles.avatar,\n          { backgroundColor: theme.primary },\n        ]}\n      >\n        {conversation.type === \"group\" ? (\n          <Feather name=\"users\" size={20} color=\"#fff\" />\n        ) : (\n          <ThemedText type=\"body\" style={styles.avatarText} lightColor=\"#fff\" darkColor=\"#fff\">\n            {initial}\n          </ThemedText>\n        )}\n      </View>\n\n      <View style={styles.conversationContent}>\n        <View style={styles.conversationHeader}>\n          <View style={styles.nameRow}>\n            <ThemedText type=\"h4\" numberOfLines={1} style={styles.conversationName}>\n              {displayName}\n            </ThemedText>\n            {conversation.isEncrypted ? (\n              <Feather name=\"lock\" size={12} color={theme.success} />\n            ) : null}\n          </View>\n          <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n            {timeAgo}\n          </ThemedText>\n        </View>\n        <View style={styles.messagePreviewRow}>\n          <ThemedText\n            type=\"body\"\n            numberOfLines={1}\n            style={[styles.messagePreview, { color: theme.textSecondary }]}\n          >\n            {conversation.lastMessage || \"No messages yet\"}\n          </ThemedText>\n          {conversation.unreadCount > 0 ? (\n            <View style={[styles.unreadBadge, { backgroundColor: theme.primary }]}>\n              <ThemedText type=\"caption\" style={styles.unreadText}>\n                {conversation.unreadCount}\n              </ThemedText>\n            </View>\n          ) : null}\n        </View>\n      </View>\n    </Pressable>\n  );\n}\n\nexport default function MessagesScreen() {\n  const { theme } = useTheme();\n  const navigation = useNavigation<NativeStackNavigationProp<MessagesStackParamList>>();\n  const tabBarHeight = useBottomTabBarHeight();\n  const { conversations, refreshConversations } = useData();\n  const [refreshing, setRefreshing] = React.useState(false);\n\n  const onRefresh = useCallback(async () => {\n    setRefreshing(true);\n    await refreshConversations();\n    setRefreshing(false);\n  }, [refreshConversations]);\n\n  const handleConversationPress = (conversation: Conversation) => {\n    navigation.navigate(\"Conversation\", { conversationId: conversation.id });\n  };\n\n  const handleNewMessage = () => {\n    navigation.navigate(\"NewConversation\", {});\n  };\n\n  const sortedConversations = [...conversations].sort((a, b) => {\n    const aTime = a.lastMessageAt || 0;\n    const bTime = b.lastMessageAt || 0;\n    return bTime - aTime;\n  });\n\n  const renderConversation = ({ item }: { item: Conversation }) => (\n    <ConversationRow\n      conversation={item}\n      onPress={() => handleConversationPress(item)}\n    />\n  );\n\n  const renderEmpty = () => (\n    <View style={styles.emptyContainer}>\n      <Feather name=\"message-circle\" size={48} color={theme.textSecondary} />\n      <ThemedText type=\"h3\" style={styles.emptyTitle}>\n        No messages yet\n      </ThemedText>\n      <ThemedText type=\"body\" style={[styles.emptyText, { color: theme.textSecondary }]}>\n        Start a conversation with a comrade\n      </ThemedText>\n      <Pressable\n        style={({ pressed }) => [\n          styles.startButton,\n          { backgroundColor: theme.primary, opacity: pressed ? 0.8 : 1 },\n        ]}\n        onPress={handleNewMessage}\n      >\n        <ThemedText type=\"body\" style={{ color: \"#fff\", fontWeight: \"600\" }}>\n          Start a Conversation\n        </ThemedText>\n      </Pressable>\n    </View>\n  );\n\n  return (\n    <ThemedView style={styles.container}>\n      <FlatList\n        data={sortedConversations}\n        renderItem={renderConversation}\n        keyExtractor={(item) => item.id}\n        contentContainerStyle={[\n          styles.listContent,\n          { paddingBottom: tabBarHeight + Spacing.xl },\n        ]}\n        ItemSeparatorComponent={() => (\n          <View style={[styles.separator, { backgroundColor: theme.border }]} />\n        )}\n        ListEmptyComponent={renderEmpty}\n        refreshControl={\n          <RefreshControl\n            refreshing={refreshing}\n            onRefresh={onRefresh}\n            tintColor={theme.primary}\n          />\n        }\n        showsVerticalScrollIndicator={false}\n      />\n    </ThemedView>\n  );\n}\n\nfunction getTimeAgo(timestamp: number): string {\n  const now = Date.now();\n  const diff = now - timestamp;\n  const minutes = Math.floor(diff / 60000);\n  const hours = Math.floor(diff / 3600000);\n  const days = Math.floor(diff / 86400000);\n\n  if (minutes < 1) return \"Now\";\n  if (minutes < 60) return `${minutes}m`;\n  if (hours < 24) return `${hours}h`;\n  if (days < 7) return `${days}d`;\n  return new Date(timestamp).toLocaleDateString();\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  listContent: {\n    flexGrow: 1,\n  },\n  conversationRow: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.md,\n  },\n  avatar: {\n    width: 50,\n    height: 50,\n    borderRadius: 25,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  avatarText: {\n    fontSize: 18,\n    fontWeight: \"600\",\n  },\n  conversationContent: {\n    flex: 1,\n    marginLeft: Spacing.md,\n  },\n  conversationHeader: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"space-between\",\n    marginBottom: Spacing.xs,\n  },\n  nameRow: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    gap: Spacing.sm,\n    flex: 1,\n  },\n  conversationName: {\n    flex: 1,\n  },\n  messagePreviewRow: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n  },\n  messagePreview: {\n    flex: 1,\n  },\n  unreadBadge: {\n    minWidth: 20,\n    height: 20,\n    borderRadius: 10,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    paddingHorizontal: 6,\n    marginLeft: Spacing.sm,\n  },\n  unreadText: {\n    color: \"#fff\",\n    fontSize: 11,\n    fontWeight: \"600\",\n  },\n  separator: {\n    height: 1,\n    marginLeft: 66 + Spacing.lg,\n  },\n  emptyContainer: {\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    paddingHorizontal: Spacing.xl,\n    paddingTop: Spacing[\"5xl\"],\n  },\n  emptyTitle: {\n    marginTop: Spacing.lg,\n    marginBottom: Spacing.sm,\n  },\n  emptyText: {\n    textAlign: \"center\",\n    marginBottom: Spacing.xl,\n  },\n  startButton: {\n    paddingHorizontal: Spacing.xl,\n    paddingVertical: Spacing.md,\n    borderRadius: BorderRadius.full,\n  },\n});\n","path":null,"size_bytes":7935,"size_tokens":null},"constants/theme.ts":{"content":"import { Platform } from \"react-native\";\n\nexport const Colors = {\n  light: {\n    text: \"#2C2416\",\n    textSecondary: \"#6B5D4F\",\n    buttonText: \"#FFFFFF\",\n    tabIconDefault: \"#6B5D4F\",\n    tabIconSelected: \"#8B7355\",\n    link: \"#8B7355\",\n    backgroundRoot: \"#fffff0\",\n    backgroundDefault: \"#ffffff\",\n    backgroundSecondary: \"#F5F5F0\",\n    backgroundTertiary: \"#E5DDD3\",\n    primary: \"#8B7355\",\n    secondary: \"#D4A373\",\n    surface: \"#ffffff\",\n    border: \"#E5DDD3\",\n    success: \"#6B8E23\",\n    error: \"#C1440E\",\n    inputBackground: \"#ffffff\",\n  },\n  dark: {\n    text: \"#F5F5F0\",\n    textSecondary: \"#A89B8C\",\n    buttonText: \"#FFFFFF\",\n    tabIconDefault: \"#A89B8C\",\n    tabIconSelected: \"#D4A373\",\n    link: \"#D4A373\",\n    backgroundRoot: \"#1A1612\",\n    backgroundDefault: \"#252019\",\n    backgroundSecondary: \"#302A22\",\n    backgroundTertiary: \"#3B342B\",\n    primary: \"#D4A373\",\n    secondary: \"#8B7355\",\n    surface: \"#252019\",\n    border: \"#3B342B\",\n    success: \"#8DB343\",\n    error: \"#E05A1E\",\n    inputBackground: \"#252019\",\n  },\n};\n\nexport const Spacing = {\n  xs: 4,\n  sm: 8,\n  md: 12,\n  lg: 16,\n  xl: 20,\n  \"2xl\": 24,\n  \"3xl\": 32,\n  \"4xl\": 40,\n  \"5xl\": 48,\n  inputHeight: 48,\n  buttonHeight: 52,\n};\n\nexport const BorderRadius = {\n  xs: 8,\n  sm: 12,\n  md: 18,\n  lg: 24,\n  xl: 30,\n  \"2xl\": 40,\n  \"3xl\": 50,\n  full: 9999,\n};\n\nexport const Typography = {\n  h1: {\n    fontSize: 28,\n    fontWeight: \"700\" as const,\n  },\n  h2: {\n    fontSize: 22,\n    fontWeight: \"600\" as const,\n  },\n  h3: {\n    fontSize: 18,\n    fontWeight: \"600\" as const,\n  },\n  h4: {\n    fontSize: 16,\n    fontWeight: \"600\" as const,\n  },\n  body: {\n    fontSize: 16,\n    fontWeight: \"400\" as const,\n  },\n  small: {\n    fontSize: 14,\n    fontWeight: \"400\" as const,\n  },\n  caption: {\n    fontSize: 12,\n    fontWeight: \"400\" as const,\n  },\n  link: {\n    fontSize: 16,\n    fontWeight: \"400\" as const,\n  },\n};\n\nexport const Fonts = Platform.select({\n  ios: {\n    sans: \"system-ui\",\n    serif: \"ui-serif\",\n    rounded: \"ui-rounded\",\n    mono: \"ui-monospace\",\n  },\n  default: {\n    sans: \"normal\",\n    serif: \"serif\",\n    rounded: \"normal\",\n    mono: \"monospace\",\n  },\n  web: {\n    sans: \"system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif\",\n    serif: \"Georgia, 'Times New Roman', serif\",\n    rounded:\n      \"'SF Pro Rounded', 'Hiragino Maru Gothic ProN', Meiryo, 'MS PGothic', sans-serif\",\n    mono: \"SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace\",\n  },\n});\n\nexport const Shadows = {\n  fab: {\n    shadowColor: \"#000\",\n    shadowOffset: { width: 0, height: 2 },\n    shadowOpacity: 0.1,\n    shadowRadius: 2,\n    elevation: 3,\n  },\n};\n","path":null,"size_bytes":2690,"size_tokens":null},"components/ThemedView.tsx":{"content":"import { View, type ViewProps } from \"react-native\";\n\nimport { useTheme } from \"@/hooks/useTheme\";\n\nexport type ThemedViewProps = ViewProps & {\n  lightColor?: string;\n  darkColor?: string;\n};\n\nexport function ThemedView({\n  style,\n  lightColor,\n  darkColor,\n  ...otherProps\n}: ThemedViewProps) {\n  const { theme, isDark } = useTheme();\n\n  const backgroundColor =\n    isDark && darkColor\n      ? darkColor\n      : !isDark && lightColor\n        ? lightColor\n        : theme.backgroundRoot;\n\n  return <View style={[{ backgroundColor }, style]} {...otherProps} />;\n}\n","path":null,"size_bytes":563,"size_tokens":null},"screens/CreateOrganizationScreen.tsx":{"content":"import React, { useState } from \"react\";\nimport {\n  View,\n  StyleSheet,\n  TextInput,\n  Pressable,\n  Switch,\n} from \"react-native\";\nimport { useNavigation } from \"@react-navigation/native\";\nimport { Feather } from \"@expo/vector-icons\";\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { ScreenKeyboardAwareScrollView } from \"@/components/ScreenKeyboardAwareScrollView\";\nimport { Button } from \"@/components/Button\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { useData } from \"@/contexts/DataContext\";\nimport { Spacing, BorderRadius } from \"@/constants/theme\";\n\nexport default function CreateOrganizationScreen() {\n  const { theme } = useTheme();\n  const navigation = useNavigation();\n  const { createOrganization } = useData();\n  const [name, setName] = useState(\"\");\n  const [description, setDescription] = useState(\"\");\n  const [isPublic, setIsPublic] = useState(true);\n  const [isCreating, setIsCreating] = useState(false);\n\n  const handleCreate = async () => {\n    if (!name.trim()) return;\n\n    setIsCreating(true);\n    try {\n      await createOrganization(name.trim(), description.trim(), isPublic);\n      navigation.goBack();\n    } catch (error) {\n      console.error(\"Failed to create organization:\", error);\n    } finally {\n      setIsCreating(false);\n    }\n  };\n\n  return (\n    <ScreenKeyboardAwareScrollView contentContainerStyle={styles.content}>\n      <View style={styles.previewContainer}>\n        <View style={[styles.previewAvatar, { backgroundColor: theme.primary }]}>\n          <Feather name=\"briefcase\" size={32} color=\"#fff\" />\n        </View>\n        <ThemedText type=\"h3\" style={styles.previewName}>\n          {name || \"Organization Name\"}\n        </ThemedText>\n      </View>\n\n      <View style={styles.inputContainer}>\n        <ThemedText type=\"small\" style={styles.label}>\n          Name\n        </ThemedText>\n        <TextInput\n          style={[\n            styles.input,\n            {\n              backgroundColor: theme.inputBackground,\n              borderColor: theme.border,\n              color: theme.text,\n            },\n          ]}\n          placeholder=\"Enter organization name\"\n          placeholderTextColor={theme.textSecondary}\n          value={name}\n          onChangeText={setName}\n          autoCapitalize=\"words\"\n          maxLength={50}\n        />\n      </View>\n\n      <View style={styles.inputContainer}>\n        <ThemedText type=\"small\" style={styles.label}>\n          Description\n        </ThemedText>\n        <TextInput\n          style={[\n            styles.textArea,\n            {\n              backgroundColor: theme.inputBackground,\n              borderColor: theme.border,\n              color: theme.text,\n            },\n          ]}\n          placeholder=\"What is this organization about?\"\n          placeholderTextColor={theme.textSecondary}\n          value={description}\n          onChangeText={setDescription}\n          multiline\n          numberOfLines={4}\n          maxLength={200}\n          textAlignVertical=\"top\"\n        />\n        <ThemedText type=\"caption\" style={[styles.charCount, { color: theme.textSecondary }]}>\n          {description.length}/200\n        </ThemedText>\n      </View>\n\n      <View style={[styles.settingRow, { borderColor: theme.border }]}>\n        <View style={styles.settingInfo}>\n          <Feather\n            name={isPublic ? \"globe\" : \"lock\"}\n            size={20}\n            color={theme.text}\n          />\n          <View style={styles.settingText}>\n            <ThemedText type=\"body\">\n              {isPublic ? \"Public Organization\" : \"Private Organization\"}\n            </ThemedText>\n            <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n              {isPublic\n                ? \"Anyone can discover and join\"\n                : \"Only invited comrades can join\"}\n            </ThemedText>\n          </View>\n        </View>\n        <Switch\n          value={isPublic}\n          onValueChange={setIsPublic}\n          trackColor={{ false: theme.backgroundTertiary, true: theme.success }}\n          thumbColor=\"#fff\"\n        />\n      </View>\n\n      <Button\n        onPress={handleCreate}\n        disabled={!name.trim() || isCreating}\n        style={[styles.createButton, { backgroundColor: theme.primary }]}\n      >\n        {isCreating ? \"Creating...\" : \"Create Organization\"}\n      </Button>\n    </ScreenKeyboardAwareScrollView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  content: {\n    paddingHorizontal: Spacing.xl,\n  },\n  previewContainer: {\n    alignItems: \"center\",\n    marginBottom: Spacing[\"3xl\"],\n  },\n  previewAvatar: {\n    width: 80,\n    height: 80,\n    borderRadius: BorderRadius.md,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    marginBottom: Spacing.md,\n  },\n  previewName: {\n    textAlign: \"center\",\n  },\n  inputContainer: {\n    marginBottom: Spacing.xl,\n  },\n  label: {\n    marginBottom: Spacing.sm,\n    fontWeight: \"500\",\n  },\n  input: {\n    height: Spacing.inputHeight,\n    borderWidth: 1,\n    borderRadius: BorderRadius.xs,\n    paddingHorizontal: Spacing.lg,\n    fontSize: 16,\n  },\n  textArea: {\n    minHeight: 100,\n    borderWidth: 1,\n    borderRadius: BorderRadius.xs,\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.md,\n    fontSize: 16,\n  },\n  charCount: {\n    textAlign: \"right\",\n    marginTop: Spacing.xs,\n  },\n  settingRow: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"space-between\",\n    paddingVertical: Spacing.lg,\n    borderTopWidth: 1,\n    borderBottomWidth: 1,\n    marginBottom: Spacing.xl,\n  },\n  settingInfo: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    flex: 1,\n  },\n  settingText: {\n    marginLeft: Spacing.md,\n    flex: 1,\n  },\n  createButton: {\n    marginTop: Spacing.lg,\n  },\n});\n","path":null,"size_bytes":5732,"size_tokens":null},"components/ScreenKeyboardAwareScrollView.tsx":{"content":"import { Platform, StyleSheet } from \"react-native\";\nimport {\n  KeyboardAwareScrollView,\n  KeyboardAwareScrollViewProps,\n} from \"react-native-keyboard-controller\";\nimport { useSafeAreaInsets } from \"react-native-safe-area-context\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { Spacing } from \"@/constants/theme\";\nimport { ScreenScrollView } from \"./ScreenScrollView\";\n\ninterface ScreenKeyboardAwareScrollViewProps extends KeyboardAwareScrollViewProps {\n  hasTabBar?: boolean;\n  hasHeader?: boolean;\n}\n\nexport function ScreenKeyboardAwareScrollView({\n  children,\n  contentContainerStyle,\n  style,\n  keyboardShouldPersistTaps = \"handled\",\n  hasTabBar = true,\n  hasHeader = true,\n  ...scrollViewProps\n}: ScreenKeyboardAwareScrollViewProps) {\n  const { theme } = useTheme();\n  const insets = useSafeAreaInsets();\n\n  const paddingTop = hasHeader ? Spacing.xl : insets.top + Spacing.xl;\n  const paddingBottom = hasTabBar ? 88 + Spacing.xl : insets.bottom + Spacing.xl;\n\n  if (Platform.OS === \"web\") {\n    return (\n      <ScreenScrollView\n        style={style}\n        contentContainerStyle={contentContainerStyle}\n        keyboardShouldPersistTaps={keyboardShouldPersistTaps}\n        hasTabBar={hasTabBar}\n        hasHeader={hasHeader}\n        {...scrollViewProps}\n      >\n        {children}\n      </ScreenScrollView>\n    );\n  }\n\n  return (\n    <KeyboardAwareScrollView\n      style={[\n        styles.container,\n        { backgroundColor: theme.backgroundRoot },\n        style,\n      ]}\n      contentContainerStyle={[\n        {\n          paddingTop,\n          paddingBottom,\n        },\n        styles.contentContainer,\n        contentContainerStyle,\n      ]}\n      scrollIndicatorInsets={{ bottom: insets.bottom + 16 }}\n      keyboardShouldPersistTaps={keyboardShouldPersistTaps}\n      {...scrollViewProps}\n    >\n      {children}\n    </KeyboardAwareScrollView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  contentContainer: {\n    paddingHorizontal: Spacing.xl,\n  },\n});\n","path":null,"size_bytes":2005,"size_tokens":null},"components/ScreenScrollView.tsx":{"content":"import { ScrollView, ScrollViewProps, StyleSheet } from \"react-native\";\nimport { useSafeAreaInsets } from \"react-native-safe-area-context\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { Spacing } from \"@/constants/theme\";\n\ninterface ScreenScrollViewProps extends ScrollViewProps {\n  hasTabBar?: boolean;\n  hasHeader?: boolean;\n}\n\nexport function ScreenScrollView({\n  children,\n  contentContainerStyle,\n  style,\n  hasTabBar = true,\n  hasHeader = true,\n  ...scrollViewProps\n}: ScreenScrollViewProps) {\n  const { theme } = useTheme();\n  const insets = useSafeAreaInsets();\n\n  const paddingTop = hasHeader ? Spacing.xl : insets.top + Spacing.xl;\n  const paddingBottom = hasTabBar ? 88 + Spacing.xl : insets.bottom + Spacing.xl;\n\n  return (\n    <ScrollView\n      style={[\n        styles.container,\n        { backgroundColor: theme.backgroundRoot },\n        style,\n      ]}\n      contentContainerStyle={[\n        {\n          paddingTop,\n          paddingBottom,\n        },\n        styles.contentContainer,\n        contentContainerStyle,\n      ]}\n      scrollIndicatorInsets={{ bottom: insets.bottom + 16 }}\n      {...scrollViewProps}\n    >\n      {children}\n    </ScrollView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  contentContainer: {\n    paddingHorizontal: Spacing.xl,\n  },\n});\n","path":null,"size_bytes":1319,"size_tokens":null},"components/ScreenFlatList.tsx":{"content":"import React from \"react\";\nimport { FlatList, FlatListProps, StyleSheet } from \"react-native\";\n\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { useScreenInsets } from \"@/hooks/useScreenInsets\";\nimport { Spacing } from \"@/constants/theme\";\n\nexport function ScreenFlatList<T>({\n  contentContainerStyle,\n  style,\n  ...flatListProps\n}: FlatListProps<T>) {\n  const { theme } = useTheme();\n  const { paddingTop, paddingBottom, scrollInsetBottom } = useScreenInsets();\n\n  return (\n    <FlatList\n      style={[\n        styles.container,\n        { backgroundColor: theme.backgroundRoot },\n        style,\n      ]}\n      contentContainerStyle={[\n        {\n          paddingTop,\n          paddingBottom,\n        },\n        styles.contentContainer,\n        contentContainerStyle,\n      ]}\n      scrollIndicatorInsets={{ bottom: scrollInsetBottom }}\n      {...flatListProps}\n    />\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  contentContainer: {\n    paddingHorizontal: Spacing.xl,\n  },\n});\n","path":null,"size_bytes":1016,"size_tokens":null},"hooks/useScreenInsets.ts":{"content":"import { useSafeAreaInsets } from \"react-native-safe-area-context\";\nimport { Spacing } from \"@/constants/theme\";\n\ntype ScreenInsetsOptions = {\n  hasTabBar?: boolean;\n  hasTransparentHeader?: boolean;\n  headerHeight?: number;\n  tabBarHeight?: number;\n};\n\nexport function useScreenInsets(options: ScreenInsetsOptions = {}) {\n  const {\n    hasTabBar = true,\n    hasTransparentHeader = true,\n    headerHeight = 0,\n    tabBarHeight = 88,\n  } = options;\n\n  const insets = useSafeAreaInsets();\n\n  const paddingTop = hasTransparentHeader\n    ? insets.top + headerHeight + Spacing.xl\n    : Spacing.xl;\n\n  const paddingBottom = hasTabBar\n    ? tabBarHeight + Spacing.xl\n    : insets.bottom + Spacing.xl;\n\n  const scrollInsetBottom = insets.bottom + 16;\n\n  return {\n    insets,\n    paddingTop,\n    paddingBottom,\n    scrollInsetBottom,\n  };\n}\n","path":null,"size_bytes":832,"size_tokens":null},"screens/AuthScreen.tsx":{"content":"import React, { useState, useEffect } from \"react\";\nimport {\n  View,\n  StyleSheet,\n  Image,\n  TextInput,\n  Pressable,\n  Platform,\n} from \"react-native\";\nimport * as Location from \"expo-location\";\nimport { Feather } from \"@expo/vector-icons\";\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { ThemedView } from \"@/components/ThemedView\";\nimport { Button } from \"@/components/Button\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { useAuth } from \"@/contexts/AuthContext\";\nimport { Spacing, BorderRadius } from \"@/constants/theme\";\nimport { ScreenKeyboardAwareScrollView } from \"@/components/ScreenKeyboardAwareScrollView\";\nimport { findNearestCity, getMajorCities, searchCities } from \"@/utils/locationUtils\";\n\nexport default function AuthScreen() {\n  const { theme } = useTheme();\n  const { login, biometricAvailable, authenticateWithBiometric } = useAuth();\n  const [displayName, setDisplayName] = useState(\"\");\n  const [selectedCity, setSelectedCity] = useState(\"\");\n  const [citySearch, setCitySearch] = useState(\"\");\n  const [showCitySuggestions, setShowCitySuggestions] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const [isDetectingLocation, setIsDetectingLocation] = useState(true);\n  const [detectionError, setDetectionError] = useState<string | null>(null);\n\n  // Use lazy-loaded cities - starts with major cities, searches all on input\n  const filteredCities = citySearch.trim()\n    ? searchCities(citySearch)\n    : getMajorCities();\n\n  useEffect(() => {\n    detectUserLocation();\n  }, []);\n\n  const detectUserLocation = async () => {\n    try {\n      setIsDetectingLocation(true);\n      setDetectionError(null);\n\n      const { status } = await Location.requestForegroundPermissionsAsync();\n\n      if (status !== \"granted\") {\n        setDetectionError(\"Location permission denied\");\n        setIsDetectingLocation(false);\n        return;\n      }\n\n      if (Platform.OS === \"web\") {\n        setDetectionError(\n          \"Run in Expo Go to automatically detect your city\"\n        );\n        setIsDetectingLocation(false);\n        return;\n      }\n\n      const location = await Location.getCurrentPositionAsync({\n        accuracy: Location.Accuracy.Balanced,\n      });\n\n      const cityName = findNearestCity(\n        location.coords.latitude,\n        location.coords.longitude\n      );\n      setSelectedCity(cityName);\n      setCitySearch(cityName);\n      setDetectionError(null);\n    } catch (error) {\n      console.error(\"Error detecting location:\", error);\n      setDetectionError(\"Could not detect location\");\n    } finally {\n      setIsDetectingLocation(false);\n    }\n  };\n\n  const handleLogin = async () => {\n    if (!displayName.trim() || !selectedCity.trim()) return;\n    \n    setIsLoading(true);\n    try {\n      if (biometricAvailable && Platform.OS !== \"web\") {\n        const success = await authenticateWithBiometric();\n        if (!success) {\n          setIsLoading(false);\n          return;\n        }\n      }\n      await login(displayName.trim(), selectedCity);\n    } catch (error) {\n      console.error(\"Login failed:\", error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <ThemedView style={styles.container}>\n      <ScreenKeyboardAwareScrollView\n        hasTabBar={false}\n        hasHeader={false}\n        contentContainerStyle={styles.scrollContent}\n      >\n        <View style={styles.logoContainer}>\n          <Image\n            source={require(\"../assets/images/icon.png\")}\n            style={styles.logo}\n            resizeMode=\"contain\"\n          />\n          <ThemedText type=\"h1\" style={styles.appName}>\n            Comrade\n          </ThemedText>\n          <ThemedText type=\"body\" style={[styles.tagline, { color: theme.textSecondary }]}>\n            Connect with your community\n          </ThemedText>\n        </View>\n\n        <View style={styles.formContainer}>\n          <View style={styles.inputContainer}>\n            <ThemedText type=\"small\" style={styles.label}>\n              Display Name\n            </ThemedText>\n            <TextInput\n              style={[\n                styles.input,\n                {\n                  backgroundColor: theme.inputBackground,\n                  borderColor: theme.border,\n                  color: theme.text,\n                },\n              ]}\n              placeholder=\"Enter your name\"\n              placeholderTextColor={theme.textSecondary}\n              value={displayName}\n              onChangeText={setDisplayName}\n              autoCapitalize=\"words\"\n              autoCorrect={false}\n            />\n          </View>\n\n          <View style={styles.inputContainer}>\n            <ThemedText type=\"small\" style={styles.label}>\n              Your City {!isDetectingLocation && !detectionError && \"âœ“\"}\n            </ThemedText>\n\n            {detectionError ? (\n              <View\n                style={[\n                  styles.detectionErrorContainer,\n                  { backgroundColor: theme.backgroundSecondary },\n                ]}\n              >\n                <Feather name=\"alert-circle\" size={16} color={theme.warning} />\n                <ThemedText\n                  type=\"caption\"\n                  style={[styles.detectionErrorText, { color: theme.warning }]}\n                >\n                  {detectionError}\n                </ThemedText>\n              </View>\n            ) : null}\n\n            <View style={styles.cityInputWrapper}>\n              <View\n                style={[\n                  styles.cityInputContainer,\n                  {\n                    backgroundColor: theme.inputBackground,\n                    borderColor: theme.border,\n                  },\n                ]}\n              >\n                <Feather\n                  name=\"search\"\n                  size={18}\n                  color={theme.textSecondary}\n                  style={styles.searchIcon}\n                />\n                <TextInput\n                  style={[\n                    styles.cityInput,\n                    {\n                      color: theme.text,\n                    },\n                  ]}\n                  placeholder=\"Search cities...\"\n                  placeholderTextColor={theme.textSecondary}\n                  value={citySearch}\n                  onChangeText={(text) => {\n                    setCitySearch(text);\n                    setShowCitySuggestions(true);\n                  }}\n                  onFocus={() => setShowCitySuggestions(true)}\n                  editable={!isDetectingLocation}\n                />\n              </View>\n\n              {showCitySuggestions && filteredCities.length > 0 ? (\n                <View\n                  style={[\n                    styles.citySuggestions,\n                    {\n                      backgroundColor: theme.surface,\n                      borderColor: theme.border,\n                    },\n                  ]}\n                >\n                  {filteredCities.map((city) => (\n                    <Pressable\n                      key={city}\n                      style={({ pressed }) => [\n                        styles.citySuggestion,\n                        {\n                          backgroundColor:\n                            selectedCity === city\n                              ? theme.backgroundSecondary\n                              : pressed\n                                ? theme.backgroundSecondary\n                                : \"transparent\",\n                        },\n                      ]}\n                      onPress={() => {\n                        setSelectedCity(city);\n                        setCitySearch(city);\n                        setShowCitySuggestions(false);\n                      }}\n                    >\n                      <ThemedText type=\"body\">{city}</ThemedText>\n                      {selectedCity === city ? (\n                        <Feather\n                          name=\"check\"\n                          size={18}\n                          color={theme.primary}\n                        />\n                      ) : null}\n                    </Pressable>\n                  ))}\n                </View>\n              ) : null}\n            </View>\n          </View>\n\n          <Button\n            onPress={handleLogin}\n            disabled={!displayName.trim() || !selectedCity.trim() || isLoading}\n            style={[styles.loginButton, { backgroundColor: theme.primary }]}\n          >\n            {isLoading ? \"Setting up...\" : \"Get Started\"}\n          </Button>\n\n          {biometricAvailable && Platform.OS !== \"web\" ? (\n            <View style={styles.biometricHint}>\n              <Feather name=\"shield\" size={16} color={theme.success} />\n              <ThemedText\n                type=\"caption\"\n                style={[styles.hintText, { color: theme.textSecondary }]}\n              >\n                Secured with biometric authentication\n              </ThemedText>\n            </View>\n          ) : null}\n        </View>\n\n        <View style={styles.footer}>\n          <ThemedText\n            type=\"caption\"\n            style={[styles.footerText, { color: theme.textSecondary }]}\n          >\n            By continuing, you agree to our Terms of Service and Privacy Policy\n          </ThemedText>\n        </View>\n      </ScreenKeyboardAwareScrollView>\n    </ThemedView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  scrollContent: {\n    flexGrow: 1,\n    paddingHorizontal: Spacing[\"2xl\"],\n    paddingBottom: Spacing[\"4xl\"],\n  },\n  logoContainer: {\n    alignItems: \"center\",\n    marginBottom: Spacing[\"4xl\"],\n  },\n  logo: {\n    width: 100,\n    height: 100,\n    marginBottom: Spacing.lg,\n  },\n  appName: {\n    marginBottom: Spacing.sm,\n  },\n  tagline: {\n    textAlign: \"center\",\n  },\n  formContainer: {\n    flex: 1,\n    justifyContent: \"center\",\n  },\n  inputContainer: {\n    marginBottom: Spacing.xl,\n  },\n  label: {\n    marginBottom: Spacing.sm,\n    fontWeight: \"500\",\n  },\n  input: {\n    height: Spacing.inputHeight,\n    borderWidth: 1,\n    borderRadius: BorderRadius.xs,\n    paddingHorizontal: Spacing.lg,\n    fontSize: 16,\n  },\n  cityInputWrapper: {\n    position: \"relative\",\n  },\n  cityInputContainer: {\n    height: Spacing.inputHeight,\n    borderWidth: 1,\n    borderRadius: BorderRadius.xs,\n    paddingHorizontal: Spacing.lg,\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    gap: Spacing.sm,\n  },\n  searchIcon: {\n    marginRight: Spacing.xs,\n  },\n  cityInput: {\n    flex: 1,\n    fontSize: 16,\n  },\n  citySuggestions: {\n    marginTop: Spacing.sm,\n    borderWidth: 1,\n    borderRadius: BorderRadius.xs,\n    maxHeight: 180,\n  },\n  citySuggestion: {\n    height: 44,\n    paddingHorizontal: Spacing.lg,\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"space-between\",\n  },\n  detectionErrorContainer: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.sm,\n    borderRadius: BorderRadius.xs,\n    marginBottom: Spacing.sm,\n    gap: Spacing.sm,\n  },\n  detectionErrorText: {\n    flex: 1,\n  },\n  loginButton: {\n    marginTop: Spacing.lg,\n  },\n  biometricHint: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    marginTop: Spacing.xl,\n    gap: Spacing.sm,\n  },\n  hintText: {\n    textAlign: \"center\",\n  },\n  footer: {\n    paddingTop: Spacing[\"2xl\"],\n  },\n  footerText: {\n    textAlign: \"center\",\n  },\n});\n","path":null,"size_bytes":11386,"size_tokens":null},"screens/UserProfileScreen.tsx":{"content":"import React, { useState } from \"react\";\nimport {\n  View,\n  StyleSheet,\n  Pressable,\n  Image,\n  Platform,\n} from \"react-native\";\nimport { useNavigation } from \"@react-navigation/native\";\nimport { NativeStackNavigationProp } from \"@react-navigation/native-stack\";\nimport { useBottomTabBarHeight } from \"@react-navigation/bottom-tabs\";\nimport { Feather } from \"@expo/vector-icons\";\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { ThemedView } from \"@/components/ThemedView\";\nimport { ScreenScrollView } from \"@/components/ScreenScrollView\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { useAuth } from \"@/contexts/AuthContext\";\nimport { useData } from \"@/contexts/DataContext\";\nimport { Spacing, BorderRadius } from \"@/constants/theme\";\nimport { ProfileStackParamList } from \"@/navigation/ProfileStackNavigator\";\n\nexport default function UserProfileScreen() {\n  const { theme } = useTheme();\n  const { user } = useAuth();\n  const navigation = useNavigation<NativeStackNavigationProp<ProfileStackParamList>>();\n  const tabBarHeight = useBottomTabBarHeight();\n  const { comrades, posts } = useData();\n  const [showQR, setShowQR] = useState(false);\n\n  const userPosts = posts.filter((p) => p.authorId === user?.id);\n\n  const handleSettings = () => {\n    navigation.navigate(\"Settings\");\n  };\n\n  const handleScanQR = () => {\n    navigation.navigate(\"QRScanner\");\n  };\n\n  const handleEditProfile = () => {\n    navigation.navigate(\"EditProfile\");\n  };\n\n  if (!user) {\n    return (\n      <ThemedView style={styles.container}>\n        <View style={styles.notFound}>\n          <ThemedText type=\"body\">Not logged in</ThemedText>\n        </View>\n      </ThemedView>\n    );\n  }\n\n  return (\n    <ScreenScrollView contentContainerStyle={{ paddingBottom: tabBarHeight + Spacing.xl }}>\n      <View style={styles.profileHeader}>\n        <View style={[styles.avatar, { backgroundColor: user.avatarColor }]}>\n          <ThemedText\n            type=\"h1\"\n            lightColor=\"#fff\"\n            darkColor=\"#fff\"\n            style={styles.avatarText}\n          >\n            {user.displayName.charAt(0).toUpperCase()}\n          </ThemedText>\n        </View>\n        <ThemedText type=\"h2\" style={styles.displayName}>\n          {user.displayName}\n        </ThemedText>\n        {user.bio ? (\n          <ThemedText type=\"body\" style={[styles.bio, { color: theme.textSecondary }]}>\n            {user.bio}\n          </ThemedText>\n        ) : null}\n        <View style={styles.statsRow}>\n          <View style={styles.statItem}>\n            <ThemedText type=\"h3\">{comrades.length}</ThemedText>\n            <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n              Comrades\n            </ThemedText>\n          </View>\n          <View style={[styles.statDivider, { backgroundColor: theme.border }]} />\n          <View style={styles.statItem}>\n            <ThemedText type=\"h3\">{userPosts.length}</ThemedText>\n            <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n              Posts\n            </ThemedText>\n          </View>\n        </View>\n        <Pressable\n          style={({ pressed }) => [\n            styles.editButton,\n            { borderColor: theme.border, opacity: pressed ? 0.8 : 1 },\n          ]}\n          onPress={handleEditProfile}\n        >\n          <ThemedText type=\"body\" style={{ color: theme.primary }}>\n            Edit Profile\n          </ThemedText>\n        </Pressable>\n      </View>\n\n      <View style={[styles.qrSection, { backgroundColor: theme.surface, borderColor: theme.border }]}>\n        <View style={styles.qrHeader}>\n          <ThemedText type=\"h4\">My QR Code</ThemedText>\n          <Pressable\n            style={({ pressed }) => [{ opacity: pressed ? 0.7 : 1 }]}\n            onPress={() => setShowQR(!showQR)}\n          >\n            <Feather\n              name={showQR ? \"chevron-up\" : \"chevron-down\"}\n              size={24}\n              color={theme.text}\n            />\n          </Pressable>\n        </View>\n        {showQR ? (\n          <View style={styles.qrContainer}>\n            <View style={[styles.qrPlaceholder, { backgroundColor: theme.backgroundSecondary }]}>\n              <Image\n                source={require(\"../assets/images/icon.png\")}\n                style={styles.qrLogo}\n                resizeMode=\"contain\"\n              />\n              <ThemedText type=\"caption\" style={{ color: theme.textSecondary, marginTop: Spacing.sm }}>\n                QR Code for {user.displayName}\n              </ThemedText>\n              <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n                ID: {user.id.substring(0, 8)}\n              </ThemedText>\n            </View>\n            <ThemedText type=\"small\" style={[styles.qrHint, { color: theme.textSecondary }]}>\n              Share this QR code with comrades to connect\n            </ThemedText>\n          </View>\n        ) : null}\n      </View>\n\n      <Pressable\n        style={({ pressed }) => [\n          styles.actionCard,\n          { backgroundColor: theme.surface, borderColor: theme.border, opacity: pressed ? 0.9 : 1 },\n        ]}\n        onPress={handleScanQR}\n      >\n        <View style={[styles.actionIcon, { backgroundColor: theme.primary }]}>\n          <Feather name=\"camera\" size={20} color=\"#fff\" />\n        </View>\n        <View style={styles.actionContent}>\n          <ThemedText type=\"h4\">Add Comrade</ThemedText>\n          <ThemedText type=\"small\" style={{ color: theme.textSecondary }}>\n            Scan a QR code to connect\n          </ThemedText>\n        </View>\n        <Feather name=\"chevron-right\" size={20} color={theme.textSecondary} />\n      </Pressable>\n\n      <View style={styles.postsSection}>\n        <ThemedText type=\"h4\" style={styles.sectionTitle}>\n          My Posts\n        </ThemedText>\n        {userPosts.length > 0 ? (\n          userPosts.slice(0, 5).map((post) => (\n            <View\n              key={post.id}\n              style={[styles.postPreview, { backgroundColor: theme.surface, borderColor: theme.border }]}\n            >\n              <ThemedText type=\"body\" numberOfLines={2}>\n                {post.content}\n              </ThemedText>\n              <View style={styles.postMeta}>\n                <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n                  {new Date(post.createdAt).toLocaleDateString()}\n                </ThemedText>\n                <View style={styles.postStats}>\n                  <Feather name=\"heart\" size={12} color={theme.textSecondary} />\n                  <ThemedText type=\"caption\" style={{ color: theme.textSecondary, marginLeft: 4 }}>\n                    {post.likes}\n                  </ThemedText>\n                  <Feather name=\"message-circle\" size={12} color={theme.textSecondary} style={{ marginLeft: 8 }} />\n                  <ThemedText type=\"caption\" style={{ color: theme.textSecondary, marginLeft: 4 }}>\n                    {post.commentCount}\n                  </ThemedText>\n                </View>\n              </View>\n            </View>\n          ))\n        ) : (\n          <View style={styles.emptyPosts}>\n            <ThemedText type=\"body\" style={{ color: theme.textSecondary }}>\n              No posts yet\n            </ThemedText>\n          </View>\n        )}\n      </View>\n    </ScreenScrollView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  notFound: {\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  profileHeader: {\n    alignItems: \"center\",\n    marginBottom: Spacing.xl,\n  },\n  avatar: {\n    width: 100,\n    height: 100,\n    borderRadius: 50,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    marginBottom: Spacing.md,\n  },\n  avatarText: {\n    fontSize: 40,\n  },\n  displayName: {\n    marginBottom: Spacing.xs,\n  },\n  bio: {\n    textAlign: \"center\",\n    marginBottom: Spacing.md,\n  },\n  statsRow: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    marginVertical: Spacing.lg,\n  },\n  statItem: {\n    alignItems: \"center\",\n    paddingHorizontal: Spacing.xl,\n  },\n  statDivider: {\n    width: 1,\n    height: 30,\n  },\n  editButton: {\n    paddingHorizontal: Spacing.xl,\n    paddingVertical: Spacing.sm,\n    borderRadius: BorderRadius.full,\n    borderWidth: 1,\n  },\n  qrSection: {\n    borderRadius: BorderRadius.sm,\n    borderWidth: 1,\n    padding: Spacing.lg,\n    marginBottom: Spacing.lg,\n  },\n  qrHeader: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"space-between\",\n  },\n  qrContainer: {\n    alignItems: \"center\",\n    marginTop: Spacing.lg,\n  },\n  qrPlaceholder: {\n    width: 200,\n    height: 200,\n    borderRadius: BorderRadius.sm,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  qrLogo: {\n    width: 60,\n    height: 60,\n  },\n  qrHint: {\n    marginTop: Spacing.md,\n    textAlign: \"center\",\n  },\n  actionCard: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    borderRadius: BorderRadius.sm,\n    borderWidth: 1,\n    padding: Spacing.lg,\n    marginBottom: Spacing.lg,\n  },\n  actionIcon: {\n    width: 44,\n    height: 44,\n    borderRadius: 22,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  actionContent: {\n    flex: 1,\n    marginLeft: Spacing.md,\n  },\n  postsSection: {\n    marginTop: Spacing.md,\n  },\n  sectionTitle: {\n    marginBottom: Spacing.md,\n  },\n  postPreview: {\n    borderRadius: BorderRadius.sm,\n    borderWidth: 1,\n    padding: Spacing.lg,\n    marginBottom: Spacing.md,\n  },\n  postMeta: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"space-between\",\n    marginTop: Spacing.sm,\n  },\n  postStats: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n  },\n  emptyPosts: {\n    alignItems: \"center\",\n    padding: Spacing.xl,\n  },\n});\n","path":null,"size_bytes":9712,"size_tokens":null},"design_guidelines.md":{"content":"# Design Guidelines: E2EE Social & Organization Hub App\n\n## Architecture Decisions\n\n### Authentication\n**Auth Required** - Multi-user social app with encrypted messaging and organization features.\n\n**Implementation:**\n- Biometric authentication (Face ID/Touch ID) as primary login method\n- SSO fallback: Apple Sign-In (iOS required) + Google Sign-In\n- Initial setup flow: SSO â†’ Biometric enrollment â†’ Profile creation\n- Auth state persists locally with encrypted credentials\n- Login screen: Minimalist with biometric prompt, \"Use Email\" fallback link\n- Include Privacy Policy & Terms of Service links\n- Account screen includes: Log out (with confirmation), Delete account (nested under Settings > Account > Delete with double confirmation and data retention warning)\n\n### Navigation Architecture\n**Tab Navigation** (5 tabs with center floating action button for core \"Create Post\" action):\n\n1. **Feed Tab** - City-based activity feed\n2. **Messages Tab** - Direct & group conversations\n3. **Create (FAB)** - Floating action button for new post\n4. **Organizations Tab** - Organization discovery & management\n5. **Profile Tab** - User profile, QR sharing, settings\n\n**Stack Structure:**\n- Each tab maintains its own navigation stack\n- Modals: QR Scanner, Post Creation, Organization Creation, Comment Threads, Settings\n\n### Screen Specifications\n\n#### 1. City Feed Screen (Home)\n**Purpose:** Browse and interact with local user activity\n\n**Layout:**\n- Header: Custom transparent header\n  - Left: City selector dropdown (e.g., \"San Francisco â–¼\")\n  - Right: Search icon button\n  - No header title, transparent background\n- Content: Scrollable FlatList of feed cards\n  - Pull-to-refresh functionality\n  - Each card shows: author avatar, name, timestamp, content, image (if any), engagement (likes, comments)\n  - Tap card â†’ opens detailed post view with comments\n- Floating: Create FAB (center tab)\n- Safe area: top: headerHeight + Spacing.xl, bottom: tabBarHeight + Spacing.xl\n\n**Components:** FeedCard, CitySelector, SearchBar (modal), PostDetail (modal)\n\n#### 2. Post Detail Screen (Modal)\n**Purpose:** View post with threaded comments\n\n**Layout:**\n- Header: Default navigation header\n  - Left: Close button\n  - Title: \"Post\"\n  - Right: Share icon\n- Content: ScrollView\n  - Post content (full size)\n  - Comment input bar (pinned above keyboard)\n  - Threaded comment list (nested indentation for replies)\n- Safe area: top: Spacing.xl, bottom: insets.bottom + Spacing.xl\n\n#### 3. Messages Screen\n**Purpose:** View all conversations (DMs & group chats)\n\n**Layout:**\n- Header: Default opaque header\n  - Title: \"Messages\"\n  - Right: New message icon\n- Content: Searchable list of conversation previews\n  - Each row: Avatar/group icon, name, last message preview, timestamp, unread badge\n  - Swipe actions: Pin, Mute, Delete\n- Safe area: top: Spacing.xl, bottom: tabBarHeight + Spacing.xl\n\n#### 4. Conversation Screen\n**Purpose:** 1:1 or group encrypted messaging\n\n**Layout:**\n- Header: Custom header\n  - Left: Back button\n  - Center: Avatar + Name (tap for details)\n  - Right: Video/call icon (future), More menu\n- Content: Inverted FlatList (messages bottom-up)\n  - Message bubbles: sender on right (primary color), receiver on left (light gray)\n  - Typing indicator\n  - E2EE badge in header (small lock icon)\n- Input: Fixed bottom message bar with text input, attach button, send button\n- Safe area: top: Spacing.xl, bottom: insets.bottom + Spacing.xl\n\n#### 5. Organizations Screen\n**Purpose:** Browse and manage organization memberships\n\n**Layout:**\n- Header: Default header\n  - Title: \"Organizations\"\n  - Right: Create organization icon\n- Content: Segmented control tabs\n  - \"My Orgs\" - Organizations user owns/is member of (scrollable grid/list)\n  - \"Discover\" - Browse public organizations in city (searchable list)\n- Safe area: top: Spacing.xl, bottom: tabBarHeight + Spacing.xl\n\n#### 6. Organization Hub Screen\n**Purpose:** View organization profile, feed, and members\n\n**Layout:**\n- Header: Custom transparent header with large org avatar/logo\n  - Parallax scroll effect\n  - Left: Back button\n  - Right: More menu (join/leave, settings if owner)\n- Content: ScrollView with nested tabs\n  - Organization header: Name, description, member count\n  - Tab selector: Feed | Members | About\n  - Feed tab: Dual-post buttons (Post to City | Post to Org)\n  - Members tab: List with roles (Owner, Member), invite button for owners\n- Safe area: top: headerHeight + Spacing.xl, bottom: tabBarHeight + Spacing.xl\n\n#### 7. Profile Screen\n**Purpose:** User profile, QR sharing, settings\n\n**Layout:**\n- Header: Default header\n  - Title: User's display name\n  - Right: Settings icon\n- Content: ScrollView\n  - Profile section: Large avatar, bio, comrade count\n  - QR Code card: \"Share My QR\" button â†’ expands QR code\n  - QR Scanner button: \"Add Comrade\" â†’ opens camera scanner\n  - Activity section: User's posts grid\n  - Settings nested under Settings icon\n- Safe area: top: Spacing.xl, bottom: tabBarHeight + Spacing.xl\n\n#### 8. QR Code Scanner Screen (Modal)\n**Purpose:** Scan comrade QR codes to add connections\n\n**Layout:**\n- Full-screen camera view\n- Header overlay: Semi-transparent\n  - Left: Close button\n  - Title: \"Scan QR Code\"\n- Center: Scanning frame overlay\n- Bottom overlay: \"Point camera at QR code\" helper text\n- Success state: Shows scanned comrade preview with \"Add Comrade\" button\n\n## Design System\n\n### Color Palette\n- **Background:** #fffff0 (cream, primary app background)\n- **Primary:** #8B7355 (earthy brown, derived from logo aesthetic)\n- **Secondary:** #D4A373 (warm tan, accents)\n- **Surface:** #ffffff (white cards, elevated surfaces)\n- **Text Primary:** #2C2416 (dark brown, high contrast on cream)\n- **Text Secondary:** #6B5D4F (medium brown, secondary text)\n- **Border:** #E5DDD3 (subtle cream border)\n- **Success:** #6B8E23 (olive green for E2EE indicators)\n- **Error:** #C1440E (warm red)\n- **System Gray:** #F5F5F0 (lighter cream for disabled states)\n\n### Typography\n- **Headings:** SF Pro Display (iOS) / Roboto (Android) - Bold\n  - H1: 28pt, Bold\n  - H2: 22pt, Semibold\n  - H3: 18pt, Semibold\n- **Body:** SF Pro Text (iOS) / Roboto (Android)\n  - Body: 16pt, Regular\n  - Caption: 14pt, Regular\n  - Small: 12pt, Regular\n- **Color:** Text Primary for headings, Text Secondary for body\n\n### Visual Design\n\n**Logo Usage:**\n- Custom flower logo appears on splash screen, login screen header\n- Favicon-sized version in header of profile screen\n- DO NOT use emoji anywhere\n\n**Icons:**\n- Use Feather icon set from @expo/vector-icons\n- Icon color: Text Primary (#2C2416) or Primary (#8B7355) for active states\n- Size: 24px standard, 20px for tab bar\n\n**Cards & Surfaces:**\n- Feed cards: White background, 12px border radius, 1px solid Border color\n- NO drop shadows on cards\n- Subtle pressed state: reduce opacity to 0.8\n\n**Floating Action Button (Create Post):**\n- Position: Center of tab bar, elevated above tabs\n- Shape: 56x56px circle\n- Background: Primary color (#8B7355)\n- Icon: Feather \"plus\" in white\n- Drop shadow: EXACT specifications:\n  - shadowOffset: {width: 0, height: 2}\n  - shadowOpacity: 0.10\n  - shadowRadius: 2\n\n**Buttons:**\n- Primary: Primary color background, white text, 12px radius\n- Secondary: Transparent with Primary border, Primary text\n- Pressed state: opacity 0.8 (no shadows)\n\n**Forms:**\n- Input fields: White background, 8px radius, 1px Border color\n- Focus state: 2px Primary color border\n- Submit buttons in header (right side) for modal forms\n- Inline submit for message input\n\n**E2EE Indicators:**\n- Small lock icon (Feather \"lock\") in Success color next to conversation titles\n- \"End-to-end encrypted\" badge in conversation headers\n\n**QR Codes:**\n- Generate with custom flower logo embedded in center\n- Display on white Surface background with 16px padding\n\n**Avatars:**\n- Generate 6 preset avatars with abstract flower/nature aesthetic matching logo style\n- Circular, 40px for lists, 80px for profiles, 120px for org hubs\n- Default state: Initials on Primary background\n\n**Accessibility:**\n- Minimum touch targets: 44x44px\n- Color contrast: WCAG AA compliant (4.5:1 for body text on cream)\n- VoiceOver labels for all interactive elements\n- Support dynamic type scaling","path":null,"size_bytes":8223,"size_tokens":null},"navigation/FeedStackNavigator.tsx":{"content":"import React from \"react\";\nimport { Pressable } from \"react-native\";\nimport { createNativeStackNavigator } from \"@react-navigation/native-stack\";\nimport { Feather } from \"@expo/vector-icons\";\nimport FeedScreen from \"@/screens/FeedScreen\";\nimport PostDetailScreen from \"@/screens/PostDetailScreen\";\nimport NewConversationScreen from \"@/screens/NewConversationScreen\";\nimport { HeaderTitle } from \"@/components/HeaderTitle\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { getCommonScreenOptions } from \"@/navigation/screenOptions\";\nimport { useData } from \"@/contexts/DataContext\";\n\nexport type FeedStackParamList = {\n  Feed: undefined;\n  PostDetail: { postId: string };\n  NewConversation: { userId?: string; userName?: string };\n};\n\nconst Stack = createNativeStackNavigator<FeedStackParamList>();\n\nexport default function FeedStackNavigator() {\n  const { theme, isDark } = useTheme();\n  const { selectedCity, getCityName } = useData();\n\n  return (\n    <Stack.Navigator\n      screenOptions={{\n        ...getCommonScreenOptions({ theme, isDark }),\n      }}\n    >\n      <Stack.Screen\n        name=\"Feed\"\n        component={FeedScreen}\n        options={({ navigation }) => ({\n          headerTitle: () => (\n            <HeaderTitle title={getCityName(selectedCity)} />\n          ),\n          headerRight: () => (\n            <Pressable\n              onPress={() => {}}\n              style={({ pressed }) => ({ opacity: pressed ? 0.7 : 1 })}\n            >\n              <Feather name=\"search\" size={22} color={theme.text} />\n            </Pressable>\n          ),\n        })}\n      />\n      <Stack.Screen\n        name=\"PostDetail\"\n        component={PostDetailScreen}\n        options={{\n          headerTitle: \"Post\",\n        }}\n      />\n      <Stack.Screen\n        name=\"NewConversation\"\n        component={NewConversationScreen}\n        options={{\n          headerTitle: \"New Message\",\n          presentation: \"modal\",\n        }}\n      />\n    </Stack.Navigator>\n  );\n}\n","path":null,"size_bytes":1971,"size_tokens":null},"contexts/AuthContext.tsx":{"content":"import React, { createContext, useContext, useState, useEffect, ReactNode } from \"react\";\nimport * as LocalAuthentication from \"expo-local-authentication\";\nimport { Platform } from \"react-native\";\nimport { User } from \"@/types\";\nimport {\n  getUser,\n  saveUser,\n  createUser,\n  clearUser,\n  getBiometricEnabled,\n  setBiometricEnabled,\n  clearAllData,\n} from \"@/utils/storage\";\n\ninterface AuthContextType {\n  user: User | null;\n  isLoading: boolean;\n  isAuthenticated: boolean;\n  biometricEnabled: boolean;\n  biometricAvailable: boolean;\n  login: (displayName: string, city: string) => Promise<void>;\n  logout: () => Promise<void>;\n  updateProfile: (updates: Partial<User>) => Promise<void>;\n  authenticateWithBiometric: () => Promise<boolean>;\n  enableBiometric: () => Promise<boolean>;\n  disableBiometric: () => Promise<void>;\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\nexport function AuthProvider({ children }: { children: ReactNode }) {\n  const [user, setUser] = useState<User | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [biometricEnabled, setBiometricEnabledState] = useState(false);\n  const [biometricAvailable, setBiometricAvailable] = useState(false);\n\n  useEffect(() => {\n    loadUser();\n    checkBiometricAvailability();\n  }, []);\n\n  async function loadUser() {\n    try {\n      const storedUser = await getUser();\n      const bioEnabled = await getBiometricEnabled();\n      setUser(storedUser);\n      setBiometricEnabledState(bioEnabled);\n    } catch (error) {\n      console.error(\"Failed to load user:\", error);\n    } finally {\n      setIsLoading(false);\n    }\n  }\n\n  async function checkBiometricAvailability() {\n    try {\n      if (Platform.OS === \"web\") {\n        setBiometricAvailable(false);\n        return;\n      }\n      const hasHardware = await LocalAuthentication.hasHardwareAsync();\n      const isEnrolled = await LocalAuthentication.isEnrolledAsync();\n      setBiometricAvailable(hasHardware && isEnrolled);\n    } catch {\n      setBiometricAvailable(false);\n    }\n  }\n\n  async function login(displayName: string, city: string) {\n    const newUser = await createUser(displayName, city);\n    setUser(newUser);\n  }\n\n  async function logout() {\n    await clearAllData();\n    setUser(null);\n    setBiometricEnabledState(false);\n  }\n\n  async function updateProfile(updates: Partial<User>) {\n    if (!user) return;\n    const updatedUser = { ...user, ...updates };\n    await saveUser(updatedUser);\n    setUser(updatedUser);\n  }\n\n  async function authenticateWithBiometric(): Promise<boolean> {\n    if (Platform.OS === \"web\") {\n      return true;\n    }\n    \n    try {\n      const result = await LocalAuthentication.authenticateAsync({\n        promptMessage: \"Authenticate to access Comrade\",\n        fallbackLabel: \"Use Passcode\",\n        cancelLabel: \"Cancel\",\n        disableDeviceFallback: false,\n      });\n      return result.success;\n    } catch {\n      return false;\n    }\n  }\n\n  async function enableBiometric(): Promise<boolean> {\n    const success = await authenticateWithBiometric();\n    if (success) {\n      await setBiometricEnabled(true);\n      setBiometricEnabledState(true);\n    }\n    return success;\n  }\n\n  async function disableBiometric() {\n    await setBiometricEnabled(false);\n    setBiometricEnabledState(false);\n  }\n\n  return (\n    <AuthContext.Provider\n      value={{\n        user,\n        isLoading,\n        isAuthenticated: !!user,\n        biometricEnabled,\n        biometricAvailable,\n        login,\n        logout,\n        updateProfile,\n        authenticateWithBiometric,\n        enableBiometric,\n        disableBiometric,\n      }}\n    >\n      {children}\n    </AuthContext.Provider>\n  );\n}\n\nexport function useAuth() {\n  const context = useContext(AuthContext);\n  if (context === undefined) {\n    throw new Error(\"useAuth must be used within an AuthProvider\");\n  }\n  return context;\n}\n","path":null,"size_bytes":3892,"size_tokens":null},"screens/NewConversationScreen.tsx":{"content":"import React, { useState, useEffect } from \"react\";\nimport {\n  View,\n  StyleSheet,\n  TextInput,\n  Pressable,\n  FlatList,\n} from \"react-native\";\nimport { useNavigation, useRoute, RouteProp } from \"@react-navigation/native\";\nimport { NativeStackNavigationProp } from \"@react-navigation/native-stack\";\nimport { Feather } from \"@expo/vector-icons\";\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { ThemedView } from \"@/components/ThemedView\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { useAuth } from \"@/contexts/AuthContext\";\nimport { useData } from \"@/contexts/DataContext\";\nimport { Spacing, BorderRadius } from \"@/constants/theme\";\nimport { MessagesStackParamList } from \"@/navigation/MessagesStackNavigator\";\nimport { AVATAR_COLORS } from \"@/types\";\n\ntype NewConversationRouteProp = RouteProp<MessagesStackParamList, \"NewConversation\">;\n\ninterface MockComrade {\n  id: string;\n  name: string;\n  avatarColor: string;\n}\n\nexport default function NewConversationScreen() {\n  const { theme } = useTheme();\n  const { user } = useAuth();\n  const navigation = useNavigation<NativeStackNavigationProp<MessagesStackParamList>>();\n  const route = useRoute<NewConversationRouteProp>();\n  const { comrades, createConversation, conversations } = useData();\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [selectedComrades, setSelectedComrades] = useState<MockComrade[]>([]);\n  const [isCreating, setIsCreating] = useState(false);\n\n  const mockComrades: MockComrade[] = [\n    { id: \"1\", name: \"Alex Chen\", avatarColor: AVATAR_COLORS[0] },\n    { id: \"2\", name: \"Jordan Smith\", avatarColor: AVATAR_COLORS[1] },\n    { id: \"3\", name: \"Taylor Brown\", avatarColor: AVATAR_COLORS[2] },\n    { id: \"4\", name: \"Morgan Lee\", avatarColor: AVATAR_COLORS[3] },\n    { id: \"5\", name: \"Casey Wilson\", avatarColor: AVATAR_COLORS[4] },\n  ];\n\n  useEffect(() => {\n    if (route.params?.userId && route.params?.userName) {\n      const preselected = {\n        id: route.params.userId,\n        name: route.params.userName,\n        avatarColor: AVATAR_COLORS[Math.floor(Math.random() * AVATAR_COLORS.length)],\n      };\n      setSelectedComrades([preselected]);\n    }\n  }, [route.params]);\n\n  const filteredComrades = mockComrades.filter((c) =>\n    c.name.toLowerCase().includes(searchQuery.toLowerCase())\n  );\n\n  const toggleComrade = (comrade: MockComrade) => {\n    const isSelected = selectedComrades.find((c) => c.id === comrade.id);\n    if (isSelected) {\n      setSelectedComrades(selectedComrades.filter((c) => c.id !== comrade.id));\n    } else {\n      setSelectedComrades([...selectedComrades, comrade]);\n    }\n  };\n\n  const handleCreateConversation = async () => {\n    if (selectedComrades.length === 0 || !user) return;\n\n    setIsCreating(true);\n    try {\n      const participantIds = [user.id, ...selectedComrades.map((c) => c.id)];\n      const participantNames = selectedComrades.map((c) => c.name);\n      const type = selectedComrades.length > 1 ? \"group\" : \"direct\";\n\n      const conversation = await createConversation(\n        participantIds,\n        participantNames,\n        type\n      );\n\n      navigation.replace(\"Conversation\", { conversationId: conversation.id });\n    } catch (error) {\n      console.error(\"Failed to create conversation:\", error);\n    } finally {\n      setIsCreating(false);\n    }\n  };\n\n  const renderComrade = ({ item }: { item: MockComrade }) => {\n    const isSelected = selectedComrades.find((c) => c.id === item.id);\n    return (\n      <Pressable\n        style={({ pressed }) => [\n          styles.comradeRow,\n          {\n            backgroundColor: pressed ? theme.backgroundSecondary : \"transparent\",\n          },\n        ]}\n        onPress={() => toggleComrade(item)}\n      >\n        <View style={[styles.avatar, { backgroundColor: item.avatarColor }]}>\n          <ThemedText type=\"body\" style={styles.avatarText} lightColor=\"#fff\" darkColor=\"#fff\">\n            {item.name.charAt(0)}\n          </ThemedText>\n        </View>\n        <ThemedText type=\"body\" style={styles.comradeName}>\n          {item.name}\n        </ThemedText>\n        <View\n          style={[\n            styles.checkbox,\n            {\n              backgroundColor: isSelected ? theme.primary : \"transparent\",\n              borderColor: isSelected ? theme.primary : theme.border,\n            },\n          ]}\n        >\n          {isSelected ? <Feather name=\"check\" size={14} color=\"#fff\" /> : null}\n        </View>\n      </Pressable>\n    );\n  };\n\n  return (\n    <ThemedView style={styles.container}>\n      <View style={[styles.searchContainer, { borderBottomColor: theme.border }]}>\n        <View\n          style={[\n            styles.searchInputContainer,\n            { backgroundColor: theme.backgroundSecondary },\n          ]}\n        >\n          <Feather name=\"search\" size={18} color={theme.textSecondary} />\n          <TextInput\n            style={[styles.searchInput, { color: theme.text }]}\n            placeholder=\"Search comrades...\"\n            placeholderTextColor={theme.textSecondary}\n            value={searchQuery}\n            onChangeText={setSearchQuery}\n          />\n        </View>\n      </View>\n\n      {selectedComrades.length > 0 ? (\n        <View style={[styles.selectedContainer, { borderBottomColor: theme.border }]}>\n          <FlatList\n            horizontal\n            data={selectedComrades}\n            keyExtractor={(item) => item.id}\n            renderItem={({ item }) => (\n              <Pressable\n                style={[styles.selectedChip, { backgroundColor: theme.backgroundSecondary }]}\n                onPress={() => toggleComrade(item)}\n              >\n                <ThemedText type=\"small\">{item.name}</ThemedText>\n                <Feather name=\"x\" size={14} color={theme.textSecondary} />\n              </Pressable>\n            )}\n            showsHorizontalScrollIndicator={false}\n            contentContainerStyle={styles.selectedList}\n          />\n        </View>\n      ) : null}\n\n      <FlatList\n        data={filteredComrades}\n        renderItem={renderComrade}\n        keyExtractor={(item) => item.id}\n        contentContainerStyle={styles.listContent}\n        ListEmptyComponent={\n          <View style={styles.emptyContainer}>\n            <ThemedText type=\"body\" style={{ color: theme.textSecondary }}>\n              No comrades found\n            </ThemedText>\n          </View>\n        }\n      />\n\n      {selectedComrades.length > 0 ? (\n        <View style={[styles.footer, { backgroundColor: theme.surface, borderTopColor: theme.border }]}>\n          <Pressable\n            style={({ pressed }) => [\n              styles.createButton,\n              {\n                backgroundColor: theme.primary,\n                opacity: isCreating ? 0.5 : pressed ? 0.8 : 1,\n              },\n            ]}\n            onPress={handleCreateConversation}\n            disabled={isCreating}\n          >\n            <ThemedText type=\"body\" style={{ color: \"#fff\", fontWeight: \"600\" }}>\n              {selectedComrades.length > 1 ? \"Create Group Chat\" : \"Start Chat\"}\n            </ThemedText>\n          </Pressable>\n        </View>\n      ) : null}\n    </ThemedView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  searchContainer: {\n    padding: Spacing.lg,\n    borderBottomWidth: 1,\n  },\n  searchInputContainer: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    paddingHorizontal: Spacing.md,\n    height: 40,\n    borderRadius: BorderRadius.xs,\n    gap: Spacing.sm,\n  },\n  searchInput: {\n    flex: 1,\n    fontSize: 16,\n  },\n  selectedContainer: {\n    paddingVertical: Spacing.sm,\n    borderBottomWidth: 1,\n  },\n  selectedList: {\n    paddingHorizontal: Spacing.lg,\n    gap: Spacing.sm,\n  },\n  selectedChip: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.xs,\n    borderRadius: BorderRadius.full,\n    gap: Spacing.xs,\n    marginRight: Spacing.sm,\n  },\n  listContent: {\n    paddingBottom: 100,\n  },\n  comradeRow: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.md,\n  },\n  avatar: {\n    width: 44,\n    height: 44,\n    borderRadius: 22,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  avatarText: {\n    fontSize: 16,\n    fontWeight: \"600\",\n  },\n  comradeName: {\n    flex: 1,\n    marginLeft: Spacing.md,\n  },\n  checkbox: {\n    width: 24,\n    height: 24,\n    borderRadius: 12,\n    borderWidth: 2,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  emptyContainer: {\n    padding: Spacing.xl,\n    alignItems: \"center\",\n  },\n  footer: {\n    position: \"absolute\",\n    bottom: 0,\n    left: 0,\n    right: 0,\n    padding: Spacing.lg,\n    borderTopWidth: 1,\n  },\n  createButton: {\n    height: Spacing.buttonHeight,\n    borderRadius: BorderRadius.full,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n});\n","path":null,"size_bytes":8860,"size_tokens":null},"contexts/DataContext.tsx":{"content":"import React, { createContext, useContext, useState, useEffect, ReactNode, useCallback } from \"react\";\nimport {\n  Post,\n  Comment,\n  Conversation,\n  Message,\n  Organization,\n  OrgMembership,\n  Comrade,\n} from \"@/types\";\nimport {\n  getPosts,\n  createPost as createPostStorage,\n  togglePostLike as togglePostLikeStorage,\n  getComments,\n  createComment as createCommentStorage,\n  getConversations,\n  createConversation as createConversationStorage,\n  getMessages,\n  sendMessage as sendMessageStorage,\n  getOrganizations,\n  createOrganization as createOrgStorage,\n  getMemberships,\n  getUserMemberships,\n  getOrgMemberships,\n  addMembership as addMembershipStorage,\n  getComrades,\n  addComrade as addComradeStorage,\n  getSelectedCity,\n  setSelectedCity as setSelectedCityStorage,\n  getUser,\n} from \"@/utils/storage\";\nimport { useAuth } from \"./AuthContext\";\n\ninterface DataContextType {\n  posts: Post[];\n  conversations: Conversation[];\n  organizations: Organization[];\n  userMemberships: OrgMembership[];\n  comrades: Comrade[];\n  selectedCity: string;\n  isLoading: boolean;\n  refreshPosts: () => Promise<void>;\n  createPost: (content: string, orgId?: string, orgName?: string) => Promise<Post>;\n  togglePostLike: (postId: string) => Promise<void>;\n  getPostComments: (postId: string) => Promise<Comment[]>;\n  createComment: (postId: string, content: string, parentId?: string) => Promise<Comment>;\n  refreshConversations: () => Promise<void>;\n  createConversation: (participantIds: string[], participantNames: string[], type?: \"direct\" | \"group\") => Promise<Conversation>;\n  getConversationMessages: (conversationId: string) => Promise<Message[]>;\n  sendMessage: (conversationId: string, content: string) => Promise<Message>;\n  refreshOrganizations: () => Promise<void>;\n  createOrganization: (name: string, description: string, isPublic?: boolean) => Promise<Organization>;\n  joinOrganization: (orgId: string) => Promise<void>;\n  getOrganizationMembers: (orgId: string) => Promise<OrgMembership[]>;\n  refreshComrades: () => Promise<void>;\n  addComrade: (comradeUserId: string) => Promise<Comrade>;\n  setSelectedCity: (cityId: string) => Promise<void>;\n  getCityName: (cityId: string) => string;\n}\n\nconst DataContext = createContext<DataContextType | undefined>(undefined);\n\nexport function DataProvider({ children }: { children: ReactNode }) {\n  const { user } = useAuth();\n  const [posts, setPosts] = useState<Post[]>([]);\n  const [conversations, setConversations] = useState<Conversation[]>([]);\n  const [organizations, setOrganizations] = useState<Organization[]>([]);\n  const [userMemberships, setUserMemberships] = useState<OrgMembership[]>([]);\n  const [comrades, setComrades] = useState<Comrade[]>([]);\n  const [selectedCity, setSelectedCityState] = useState<string>(\"sf\");\n  const [isLoading, setIsLoading] = useState(true);\n\n  useEffect(() => {\n    if (user) {\n      loadAllData();\n    }\n  }, [user]);\n\n  async function loadAllData() {\n    setIsLoading(true);\n    try {\n      await Promise.all([\n        refreshPosts(),\n        refreshConversations(),\n        refreshOrganizations(),\n        refreshComrades(),\n        loadSelectedCity(),\n      ]);\n    } finally {\n      setIsLoading(false);\n    }\n  }\n\n  async function loadSelectedCity() {\n    const city = await getSelectedCity();\n    setSelectedCityState(city);\n  }\n\n  const refreshPosts = useCallback(async () => {\n    const allPosts = await getPosts();\n    setPosts(allPosts);\n  }, []);\n\n  async function createPost(content: string, orgId?: string, orgName?: string): Promise<Post> {\n    const post = await createPostStorage(content, selectedCity, orgId, orgName);\n    await refreshPosts();\n    return post;\n  }\n\n  async function togglePostLike(postId: string) {\n    await togglePostLikeStorage(postId);\n    await refreshPosts();\n  }\n\n  async function getPostComments(postId: string): Promise<Comment[]> {\n    return getComments(postId);\n  }\n\n  async function createComment(postId: string, content: string, parentId?: string): Promise<Comment> {\n    const comment = await createCommentStorage(postId, content, parentId);\n    await refreshPosts();\n    return comment;\n  }\n\n  const refreshConversations = useCallback(async () => {\n    const allConversations = await getConversations();\n    setConversations(allConversations);\n  }, []);\n\n  async function createConversation(\n    participantIds: string[],\n    participantNames: string[],\n    type: \"direct\" | \"group\" = \"direct\"\n  ): Promise<Conversation> {\n    const conversation = await createConversationStorage(participantIds, participantNames, type);\n    await refreshConversations();\n    return conversation;\n  }\n\n  async function getConversationMessages(conversationId: string): Promise<Message[]> {\n    return getMessages(conversationId);\n  }\n\n  async function sendMessage(conversationId: string, content: string): Promise<Message> {\n    const message = await sendMessageStorage(conversationId, content);\n    await refreshConversations();\n    return message;\n  }\n\n  const refreshOrganizations = useCallback(async () => {\n    const [allOrgs, allMemberships] = await Promise.all([\n      getOrganizations(),\n      getMemberships(),\n    ]);\n    setOrganizations(allOrgs);\n    \n    const currentUser = await getUser();\n    if (currentUser) {\n      const userMems = allMemberships.filter((m) => m.userId === currentUser.id);\n      setUserMemberships(userMems);\n    }\n  }, []);\n\n  async function createOrganization(\n    name: string,\n    description: string,\n    isPublic: boolean = true\n  ): Promise<Organization> {\n    const org = await createOrgStorage(name, description, selectedCity, isPublic);\n    await refreshOrganizations();\n    return org;\n  }\n\n  async function joinOrganization(orgId: string) {\n    const currentUser = await getUser();\n    if (!currentUser) return;\n    await addMembershipStorage(orgId, currentUser.id, \"member\");\n    await refreshOrganizations();\n  }\n\n  async function getOrganizationMembers(orgId: string): Promise<OrgMembership[]> {\n    return getOrgMemberships(orgId);\n  }\n\n  const refreshComrades = useCallback(async () => {\n    const allComrades = await getComrades();\n    setComrades(allComrades);\n  }, []);\n\n  async function addComrade(comradeUserId: string): Promise<Comrade> {\n    const comrade = await addComradeStorage(comradeUserId);\n    await refreshComrades();\n    return comrade;\n  }\n\n  async function setSelectedCity(cityId: string) {\n    await setSelectedCityStorage(cityId);\n    setSelectedCityState(cityId);\n  }\n\n  function getCityName(cityName: string): string {\n    return cityName || \"Unknown\";\n  }\n\n  return (\n    <DataContext.Provider\n      value={{\n        posts,\n        conversations,\n        organizations,\n        userMemberships,\n        comrades,\n        selectedCity,\n        isLoading,\n        refreshPosts,\n        createPost,\n        togglePostLike,\n        getPostComments,\n        createComment,\n        refreshConversations,\n        createConversation,\n        getConversationMessages,\n        sendMessage,\n        refreshOrganizations,\n        createOrganization,\n        joinOrganization,\n        getOrganizationMembers,\n        refreshComrades,\n        addComrade,\n        setSelectedCity,\n        getCityName,\n      }}\n    >\n      {children}\n    </DataContext.Provider>\n  );\n}\n\nexport function useData() {\n  const context = useContext(DataContext);\n  if (context === undefined) {\n    throw new Error(\"useData must be used within a DataProvider\");\n  }\n  return context;\n}\n","path":null,"size_bytes":7450,"size_tokens":null},"navigation/RootNavigator.tsx":{"content":"import React from \"react\";\nimport { createNativeStackNavigator } from \"@react-navigation/native-stack\";\nimport MainTabNavigator from \"@/navigation/MainTabNavigator\";\nimport AuthScreen from \"@/screens/AuthScreen\";\nimport CreatePostScreen from \"@/screens/CreatePostScreen\";\nimport { useAuth } from \"@/contexts/AuthContext\";\nimport { useTheme } from \"@/hooks/useTheme\";\n\nexport type RootStackParamList = {\n  Auth: undefined;\n  Main: undefined;\n  CreatePostModal: { orgId?: string; orgName?: string; postToOrgFeed?: boolean };\n};\n\nconst Stack = createNativeStackNavigator<RootStackParamList>();\n\nexport default function RootNavigator() {\n  const { isAuthenticated, isLoading } = useAuth();\n  const { theme } = useTheme();\n\n  if (isLoading) {\n    return null;\n  }\n\n  return (\n    <Stack.Navigator\n      screenOptions={{\n        headerShown: false,\n        contentStyle: { backgroundColor: theme.backgroundRoot },\n      }}\n    >\n      {isAuthenticated ? (\n        <>\n          <Stack.Screen name=\"Main\" component={MainTabNavigator} />\n          <Stack.Screen\n            name=\"CreatePostModal\"\n            component={CreatePostScreen}\n            options={{\n              presentation: \"modal\",\n              animation: \"slide_from_bottom\",\n            }}\n          />\n        </>\n      ) : (\n        <Stack.Screen name=\"Auth\" component={AuthScreen} />\n      )}\n    </Stack.Navigator>\n  );\n}\n","path":null,"size_bytes":1386,"size_tokens":null},"screens/SettingsScreen.tsx":{"content":"import React, { useState } from \"react\";\nimport {\n  View,\n  StyleSheet,\n  Pressable,\n  Switch,\n  Alert,\n  Platform,\n} from \"react-native\";\nimport { useNavigation } from \"@react-navigation/native\";\nimport { Feather } from \"@expo/vector-icons\";\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { ScreenScrollView } from \"@/components/ScreenScrollView\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { useAuth } from \"@/contexts/AuthContext\";\nimport { Spacing, BorderRadius } from \"@/constants/theme\";\n\nexport default function SettingsScreen() {\n  const { theme } = useTheme();\n  const navigation = useNavigation();\n  const {\n    user,\n    biometricEnabled,\n    biometricAvailable,\n    enableBiometric,\n    disableBiometric,\n    logout,\n  } = useAuth();\n  const [isLoggingOut, setIsLoggingOut] = useState(false);\n\n  const handleBiometricToggle = async (value: boolean) => {\n    if (value) {\n      await enableBiometric();\n    } else {\n      await disableBiometric();\n    }\n  };\n\n  const handleLogout = () => {\n    if (Platform.OS === \"web\") {\n      performLogout();\n      return;\n    }\n\n    Alert.alert(\n      \"Log Out\",\n      \"Are you sure you want to log out? Your data will be cleared from this device.\",\n      [\n        { text: \"Cancel\", style: \"cancel\" },\n        {\n          text: \"Log Out\",\n          style: \"destructive\",\n          onPress: performLogout,\n        },\n      ]\n    );\n  };\n\n  const performLogout = async () => {\n    setIsLoggingOut(true);\n    try {\n      await logout();\n    } catch (error) {\n      console.error(\"Failed to logout:\", error);\n    } finally {\n      setIsLoggingOut(false);\n    }\n  };\n\n  const renderSettingRow = ({\n    icon,\n    title,\n    subtitle,\n    rightElement,\n    onPress,\n    danger,\n  }: {\n    icon: string;\n    title: string;\n    subtitle?: string;\n    rightElement?: React.ReactNode;\n    onPress?: () => void;\n    danger?: boolean;\n  }) => (\n    <Pressable\n      style={({ pressed }) => [\n        styles.settingRow,\n        { opacity: onPress && pressed ? 0.7 : 1 },\n      ]}\n      onPress={onPress}\n      disabled={!onPress}\n    >\n      <View style={[styles.settingIcon, { backgroundColor: danger ? theme.error : theme.backgroundSecondary }]}>\n        <Feather name={icon as any} size={18} color={danger ? \"#fff\" : theme.text} />\n      </View>\n      <View style={styles.settingContent}>\n        <ThemedText type=\"body\" style={danger ? { color: theme.error } : undefined}>\n          {title}\n        </ThemedText>\n        {subtitle ? (\n          <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n            {subtitle}\n          </ThemedText>\n        ) : null}\n      </View>\n      {rightElement}\n    </Pressable>\n  );\n\n  return (\n    <ScreenScrollView>\n      <View style={styles.section}>\n        <ThemedText type=\"caption\" style={[styles.sectionTitle, { color: theme.textSecondary }]}>\n          SECURITY\n        </ThemedText>\n        <View style={[styles.sectionContent, { backgroundColor: theme.surface, borderColor: theme.border }]}>\n          {renderSettingRow({\n            icon: \"shield\",\n            title: \"Biometric Authentication\",\n            subtitle: biometricAvailable\n              ? biometricEnabled\n                ? \"Enabled\"\n                : \"Disabled\"\n              : \"Not available on this device\",\n            rightElement: biometricAvailable ? (\n              <Switch\n                value={biometricEnabled}\n                onValueChange={handleBiometricToggle}\n                trackColor={{ false: theme.backgroundTertiary, true: theme.success }}\n                thumbColor=\"#fff\"\n              />\n            ) : null,\n          })}\n          {renderSettingRow({\n            icon: \"lock\",\n            title: \"End-to-End Encryption\",\n            subtitle: \"All messages are encrypted\",\n            rightElement: (\n              <Feather name=\"check-circle\" size={20} color={theme.success} />\n            ),\n          })}\n        </View>\n      </View>\n\n      <View style={styles.section}>\n        <ThemedText type=\"caption\" style={[styles.sectionTitle, { color: theme.textSecondary }]}>\n          ACCOUNT\n        </ThemedText>\n        <View style={[styles.sectionContent, { backgroundColor: theme.surface, borderColor: theme.border }]}>\n          {renderSettingRow({\n            icon: \"user\",\n            title: \"Profile\",\n            subtitle: user?.displayName,\n            rightElement: <Feather name=\"chevron-right\" size={20} color={theme.textSecondary} />,\n            onPress: () => navigation.navigate(\"EditProfile\" as never),\n          })}\n          {renderSettingRow({\n            icon: \"map-pin\",\n            title: \"City\",\n            subtitle: user?.city || \"Not set\",\n            rightElement: <Feather name=\"chevron-right\" size={20} color={theme.textSecondary} />,\n          })}\n        </View>\n      </View>\n\n      <View style={styles.section}>\n        <ThemedText type=\"caption\" style={[styles.sectionTitle, { color: theme.textSecondary }]}>\n          ABOUT\n        </ThemedText>\n        <View style={[styles.sectionContent, { backgroundColor: theme.surface, borderColor: theme.border }]}>\n          {renderSettingRow({\n            icon: \"info\",\n            title: \"Version\",\n            rightElement: (\n              <ThemedText type=\"body\" style={{ color: theme.textSecondary }}>\n                1.0.0\n              </ThemedText>\n            ),\n          })}\n          {renderSettingRow({\n            icon: \"file-text\",\n            title: \"Privacy Policy\",\n            rightElement: <Feather name=\"external-link\" size={18} color={theme.textSecondary} />,\n          })}\n          {renderSettingRow({\n            icon: \"file-text\",\n            title: \"Terms of Service\",\n            rightElement: <Feather name=\"external-link\" size={18} color={theme.textSecondary} />,\n          })}\n        </View>\n      </View>\n\n      <View style={styles.section}>\n        <View style={[styles.sectionContent, { backgroundColor: theme.surface, borderColor: theme.border }]}>\n          {renderSettingRow({\n            icon: \"log-out\",\n            title: isLoggingOut ? \"Logging out...\" : \"Log Out\",\n            onPress: handleLogout,\n            danger: true,\n          })}\n        </View>\n      </View>\n\n      <View style={styles.footer}>\n        <ThemedText type=\"caption\" style={{ color: theme.textSecondary, textAlign: \"center\" }}>\n          Made with care for your community\n        </ThemedText>\n      </View>\n    </ScreenScrollView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  section: {\n    marginBottom: Spacing.xl,\n  },\n  sectionTitle: {\n    marginBottom: Spacing.sm,\n    paddingHorizontal: Spacing.xs,\n    fontWeight: \"600\",\n  },\n  sectionContent: {\n    borderRadius: BorderRadius.sm,\n    borderWidth: 1,\n    overflow: \"hidden\",\n  },\n  settingRow: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    paddingVertical: Spacing.md,\n    paddingHorizontal: Spacing.lg,\n  },\n  settingIcon: {\n    width: 36,\n    height: 36,\n    borderRadius: BorderRadius.xs,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  settingContent: {\n    flex: 1,\n    marginLeft: Spacing.md,\n  },\n  footer: {\n    paddingVertical: Spacing.xl,\n  },\n});\n","path":null,"size_bytes":7157,"size_tokens":null},"screens/OrganizationHubScreen.tsx":{"content":"import React, { useState, useEffect, useCallback } from \"react\";\nimport {\n  View,\n  StyleSheet,\n  ScrollView,\n  Pressable,\n  FlatList,\n} from \"react-native\";\nimport { useSafeAreaInsets } from \"react-native-safe-area-context\";\nimport { useRoute, RouteProp, useNavigation } from \"@react-navigation/native\";\nimport { NativeStackNavigationProp } from \"@react-navigation/native-stack\";\nimport { Feather } from \"@expo/vector-icons\";\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { ThemedView } from \"@/components/ThemedView\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { useAuth } from \"@/contexts/AuthContext\";\nimport { useData } from \"@/contexts/DataContext\";\nimport { Spacing, BorderRadius } from \"@/constants/theme\";\nimport { Post, OrgMembership } from \"@/types\";\nimport { OrgsStackParamList } from \"@/navigation/OrgsStackNavigator\";\n\ntype OrgHubRouteProp = RouteProp<OrgsStackParamList, \"OrganizationHub\">;\n\nexport default function OrganizationHubScreen() {\n  const { theme } = useTheme();\n  const { user } = useAuth();\n  const route = useRoute<OrgHubRouteProp>();\n  const navigation = useNavigation<NativeStackNavigationProp<OrgsStackParamList>>();\n  const insets = useSafeAreaInsets();\n  const {\n    organizations,\n    userMemberships,\n    posts,\n    getOrganizationMembers,\n    joinOrganization,\n  } = useData();\n  const [activeTab, setActiveTab] = useState<\"feed\" | \"members\" | \"about\">(\"feed\");\n  const [members, setMembers] = useState<OrgMembership[]>([]);\n  const [isJoining, setIsJoining] = useState(false);\n\n  const org = organizations.find((o) => o.id === route.params.orgId);\n  const isMember = userMemberships.some((m) => m.organizationId === route.params.orgId);\n  const isOwner = org?.ownerId === user?.id;\n  const orgPosts = posts.filter((p) => p.organizationId === route.params.orgId);\n\n  const loadMembers = useCallback(async () => {\n    if (!org) return;\n    const orgMembers = await getOrganizationMembers(org.id);\n    setMembers(orgMembers);\n  }, [org, getOrganizationMembers]);\n\n  useEffect(() => {\n    loadMembers();\n  }, [loadMembers]);\n\n  const handleJoin = async () => {\n    if (!org) return;\n    setIsJoining(true);\n    try {\n      await joinOrganization(org.id);\n    } catch (error) {\n      console.error(\"Failed to join organization:\", error);\n    } finally {\n      setIsJoining(false);\n    }\n  };\n\n  const handleCreatePost = (postToOrg: boolean) => {\n    navigation.navigate(\"CreatePost\", {\n      orgId: org?.id,\n      orgName: org?.name,\n      postToOrgFeed: postToOrg,\n    });\n  };\n\n  if (!org) {\n    return (\n      <ThemedView style={styles.container}>\n        <View style={styles.notFound}>\n          <ThemedText type=\"body\">Organization not found</ThemedText>\n        </View>\n      </ThemedView>\n    );\n  }\n\n  const renderFeedTab = () => (\n    <View style={styles.tabContent}>\n      {isMember ? (\n        <View style={[styles.postButtonsRow, { borderBottomColor: theme.border }]}>\n          <Pressable\n            style={({ pressed }) => [\n              styles.postButton,\n              { backgroundColor: theme.primary, opacity: pressed ? 0.8 : 1 },\n            ]}\n            onPress={() => handleCreatePost(false)}\n          >\n            <Feather name=\"globe\" size={16} color=\"#fff\" />\n            <ThemedText type=\"small\" style={{ color: \"#fff\", marginLeft: Spacing.xs }}>\n              Post to City\n            </ThemedText>\n          </Pressable>\n          <Pressable\n            style={({ pressed }) => [\n              styles.postButton,\n              { backgroundColor: theme.secondary, opacity: pressed ? 0.8 : 1 },\n            ]}\n            onPress={() => handleCreatePost(true)}\n          >\n            <Feather name=\"briefcase\" size={16} color=\"#fff\" />\n            <ThemedText type=\"small\" style={{ color: \"#fff\", marginLeft: Spacing.xs }}>\n              Post to Org\n            </ThemedText>\n          </Pressable>\n        </View>\n      ) : null}\n      {orgPosts.length > 0 ? (\n        orgPosts.map((post) => (\n          <View\n            key={post.id}\n            style={[styles.postCard, { backgroundColor: theme.surface, borderColor: theme.border }]}\n          >\n            <ThemedText type=\"small\" style={{ fontWeight: \"600\" }}>\n              {post.authorName}\n            </ThemedText>\n            <ThemedText type=\"body\" style={{ marginTop: Spacing.xs }}>\n              {post.content}\n            </ThemedText>\n            <ThemedText type=\"caption\" style={{ color: theme.textSecondary, marginTop: Spacing.sm }}>\n              {getTimeAgo(post.createdAt)}\n            </ThemedText>\n          </View>\n        ))\n      ) : (\n        <View style={styles.emptyTab}>\n          <ThemedText type=\"body\" style={{ color: theme.textSecondary }}>\n            No posts yet\n          </ThemedText>\n        </View>\n      )}\n    </View>\n  );\n\n  const renderMembersTab = () => (\n    <View style={styles.tabContent}>\n      {members.map((membership) => (\n        <View\n          key={membership.id}\n          style={[styles.memberRow, { borderBottomColor: theme.border }]}\n        >\n          <View style={[styles.memberAvatar, { backgroundColor: theme.primary }]}>\n            <Feather name=\"user\" size={18} color=\"#fff\" />\n          </View>\n          <View style={styles.memberInfo}>\n            <ThemedText type=\"body\">\n              {membership.userId === user?.id ? user.displayName : \"Comrade\"}\n            </ThemedText>\n            <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n              {membership.role.charAt(0).toUpperCase() + membership.role.slice(1)}\n            </ThemedText>\n          </View>\n          {membership.role === \"owner\" ? (\n            <Feather name=\"star\" size={18} color={theme.secondary} />\n          ) : null}\n        </View>\n      ))}\n      {isOwner ? (\n        <Pressable\n          style={({ pressed }) => [\n            styles.inviteButton,\n            { backgroundColor: theme.backgroundSecondary, opacity: pressed ? 0.8 : 1 },\n          ]}\n        >\n          <Feather name=\"user-plus\" size={18} color={theme.primary} />\n          <ThemedText type=\"body\" style={{ color: theme.primary, marginLeft: Spacing.sm }}>\n            Invite Comrades\n          </ThemedText>\n        </Pressable>\n      ) : null}\n    </View>\n  );\n\n  const renderAboutTab = () => (\n    <View style={styles.tabContent}>\n      <View style={styles.aboutSection}>\n        <ThemedText type=\"h4\" style={styles.aboutLabel}>\n          Description\n        </ThemedText>\n        <ThemedText type=\"body\" style={{ color: theme.textSecondary }}>\n          {org.description || \"No description provided.\"}\n        </ThemedText>\n      </View>\n      <View style={styles.aboutSection}>\n        <ThemedText type=\"h4\" style={styles.aboutLabel}>\n          Created\n        </ThemedText>\n        <ThemedText type=\"body\" style={{ color: theme.textSecondary }}>\n          {new Date(org.createdAt).toLocaleDateString()}\n        </ThemedText>\n      </View>\n      <View style={styles.aboutSection}>\n        <ThemedText type=\"h4\" style={styles.aboutLabel}>\n          Visibility\n        </ThemedText>\n        <View style={styles.visibilityRow}>\n          <Feather\n            name={org.isPublic ? \"globe\" : \"lock\"}\n            size={16}\n            color={theme.textSecondary}\n          />\n          <ThemedText type=\"body\" style={{ color: theme.textSecondary, marginLeft: Spacing.sm }}>\n            {org.isPublic ? \"Public\" : \"Private\"}\n          </ThemedText>\n        </View>\n      </View>\n    </View>\n  );\n\n  return (\n    <ThemedView style={styles.container}>\n      <ScrollView\n        contentContainerStyle={{ paddingBottom: insets.bottom + Spacing.xl }}\n        showsVerticalScrollIndicator={false}\n      >\n        <View style={[styles.header, { backgroundColor: org.avatarColor }]}>\n          <Feather name=\"briefcase\" size={48} color=\"#fff\" />\n          <ThemedText type=\"h2\" style={styles.orgName} lightColor=\"#fff\" darkColor=\"#fff\">\n            {org.name}\n          </ThemedText>\n          <View style={styles.metaRow}>\n            <Feather name=\"users\" size={14} color=\"rgba(255,255,255,0.8)\" />\n            <ThemedText\n              type=\"small\"\n              lightColor=\"rgba(255,255,255,0.8)\"\n              darkColor=\"rgba(255,255,255,0.8)\"\n              style={{ marginLeft: Spacing.xs }}\n            >\n              {org.memberCount} members\n            </ThemedText>\n          </View>\n          {!isMember ? (\n            <Pressable\n              style={({ pressed }) => [\n                styles.joinButton,\n                { backgroundColor: \"#fff\", opacity: isJoining ? 0.5 : pressed ? 0.9 : 1 },\n              ]}\n              onPress={handleJoin}\n              disabled={isJoining}\n            >\n              <ThemedText type=\"body\" style={{ color: org.avatarColor, fontWeight: \"600\" }}>\n                {isJoining ? \"Joining...\" : \"Join Organization\"}\n              </ThemedText>\n            </Pressable>\n          ) : (\n            <View style={[styles.memberBadge, { backgroundColor: \"rgba(255,255,255,0.2)\" }]}>\n              <Feather name=\"check\" size={14} color=\"#fff\" />\n              <ThemedText type=\"small\" lightColor=\"#fff\" darkColor=\"#fff\" style={{ marginLeft: 4 }}>\n                {isOwner ? \"Owner\" : \"Member\"}\n              </ThemedText>\n            </View>\n          )}\n        </View>\n\n        <View style={[styles.tabsContainer, { borderBottomColor: theme.border }]}>\n          {([\"feed\", \"members\", \"about\"] as const).map((tab) => (\n            <Pressable\n              key={tab}\n              style={[\n                styles.tab,\n                activeTab === tab && [styles.activeTab, { borderBottomColor: theme.primary }],\n              ]}\n              onPress={() => setActiveTab(tab)}\n            >\n              <ThemedText\n                type=\"body\"\n                style={[\n                  styles.tabText,\n                  { color: activeTab === tab ? theme.primary : theme.textSecondary },\n                ]}\n              >\n                {tab.charAt(0).toUpperCase() + tab.slice(1)}\n              </ThemedText>\n            </Pressable>\n          ))}\n        </View>\n\n        {activeTab === \"feed\" && renderFeedTab()}\n        {activeTab === \"members\" && renderMembersTab()}\n        {activeTab === \"about\" && renderAboutTab()}\n      </ScrollView>\n    </ThemedView>\n  );\n}\n\nfunction getTimeAgo(timestamp: number): string {\n  const now = Date.now();\n  const diff = now - timestamp;\n  const minutes = Math.floor(diff / 60000);\n  const hours = Math.floor(diff / 3600000);\n  const days = Math.floor(diff / 86400000);\n\n  if (minutes < 1) return \"Just now\";\n  if (minutes < 60) return `${minutes}m ago`;\n  if (hours < 24) return `${hours}h ago`;\n  if (days < 7) return `${days}d ago`;\n  return new Date(timestamp).toLocaleDateString();\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  notFound: {\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  header: {\n    padding: Spacing.xl,\n    paddingTop: Spacing[\"3xl\"],\n    paddingBottom: Spacing[\"2xl\"],\n    alignItems: \"center\",\n  },\n  orgName: {\n    marginTop: Spacing.md,\n    textAlign: \"center\",\n  },\n  metaRow: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    marginTop: Spacing.sm,\n  },\n  joinButton: {\n    marginTop: Spacing.lg,\n    paddingHorizontal: Spacing.xl,\n    paddingVertical: Spacing.md,\n    borderRadius: BorderRadius.full,\n  },\n  memberBadge: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    marginTop: Spacing.lg,\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.sm,\n    borderRadius: BorderRadius.full,\n  },\n  tabsContainer: {\n    flexDirection: \"row\",\n    borderBottomWidth: 1,\n  },\n  tab: {\n    flex: 1,\n    paddingVertical: Spacing.md,\n    alignItems: \"center\",\n  },\n  activeTab: {\n    borderBottomWidth: 2,\n  },\n  tabText: {\n    fontWeight: \"600\",\n  },\n  tabContent: {\n    padding: Spacing.lg,\n  },\n  postButtonsRow: {\n    flexDirection: \"row\",\n    gap: Spacing.md,\n    paddingBottom: Spacing.lg,\n    marginBottom: Spacing.lg,\n    borderBottomWidth: 1,\n  },\n  postButton: {\n    flex: 1,\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    paddingVertical: Spacing.md,\n    borderRadius: BorderRadius.sm,\n  },\n  postCard: {\n    padding: Spacing.lg,\n    borderRadius: BorderRadius.sm,\n    borderWidth: 1,\n    marginBottom: Spacing.md,\n  },\n  emptyTab: {\n    alignItems: \"center\",\n    paddingVertical: Spacing[\"3xl\"],\n  },\n  memberRow: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    paddingVertical: Spacing.md,\n    borderBottomWidth: 1,\n  },\n  memberAvatar: {\n    width: 40,\n    height: 40,\n    borderRadius: 20,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  memberInfo: {\n    flex: 1,\n    marginLeft: Spacing.md,\n  },\n  inviteButton: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    paddingVertical: Spacing.lg,\n    marginTop: Spacing.lg,\n    borderRadius: BorderRadius.sm,\n  },\n  aboutSection: {\n    marginBottom: Spacing.xl,\n  },\n  aboutLabel: {\n    marginBottom: Spacing.sm,\n  },\n  visibilityRow: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n  },\n});\n","path":null,"size_bytes":13126,"size_tokens":null},"navigation/screenOptions.ts":{"content":"import { Platform } from \"react-native\";\nimport { NativeStackNavigationOptions } from \"@react-navigation/native-stack\";\nimport { isLiquidGlassAvailable } from \"expo-glass-effect\";\n\ninterface ScreenOptionsParams {\n  theme: {\n    backgroundRoot: string;\n    text: string;\n  };\n  isDark: boolean;\n  transparent?: boolean;\n}\n\nexport const getCommonScreenOptions = ({\n  theme,\n  isDark,\n  transparent = true,\n}: ScreenOptionsParams): NativeStackNavigationOptions => ({\n  headerTitleAlign: \"center\",\n  headerTransparent: transparent,\n  headerBlurEffect: isDark ? \"dark\" : \"light\",\n  headerTintColor: theme.text,\n  headerStyle: {\n    backgroundColor: Platform.select({\n      ios: undefined,\n      android: theme.backgroundRoot,\n      web: theme.backgroundRoot,\n    }),\n  },\n  gestureEnabled: true,\n  gestureDirection: \"horizontal\",\n  fullScreenGestureEnabled: isLiquidGlassAvailable() ? false : true,\n  contentStyle: {\n    backgroundColor: theme.backgroundRoot,\n  },\n});\n","path":null,"size_bytes":964,"size_tokens":null},"components/Card.tsx":{"content":"import React from \"react\";\nimport { StyleSheet, Pressable } from \"react-native\";\nimport Animated, {\n  useAnimatedStyle,\n  useSharedValue,\n  withSpring,\n  WithSpringConfig,\n} from \"react-native-reanimated\";\n\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { Spacing, BorderRadius } from \"@/constants/theme\";\n\ninterface CardProps {\n  elevation: number;\n  onPress?: () => void;\n}\n\nconst springConfig: WithSpringConfig = {\n  damping: 15,\n  mass: 0.3,\n  stiffness: 150,\n  overshootClamping: true,\n  energyThreshold: 0.001,\n};\n\nconst getBackgroundColorForElevation = (\n  elevation: number,\n  theme: any,\n): string => {\n  switch (elevation) {\n    case 1:\n      return theme.backgroundDefault;\n    case 2:\n      return theme.backgroundSecondary;\n    case 3:\n      return theme.backgroundTertiary;\n    default:\n      return theme.backgroundRoot;\n  }\n};\n\nconst AnimatedPressable = Animated.createAnimatedComponent(Pressable);\n\nexport function Card({ elevation, onPress }: CardProps) {\n  const { theme } = useTheme();\n  const scale = useSharedValue(1);\n\n  const cardBackgroundColor = getBackgroundColorForElevation(elevation, theme);\n\n  const animatedStyle = useAnimatedStyle(() => ({\n    transform: [{ scale: scale.value }],\n  }));\n\n  const handlePressIn = () => {\n    scale.value = withSpring(0.98, springConfig);\n  };\n\n  const handlePressOut = () => {\n    scale.value = withSpring(1, springConfig);\n  };\n\n  return (\n    <AnimatedPressable\n      onPress={onPress}\n      onPressIn={handlePressIn}\n      onPressOut={handlePressOut}\n      style={[\n        styles.card,\n        {\n          backgroundColor: cardBackgroundColor,\n        },\n        animatedStyle,\n      ]}\n    >\n      <ThemedText type=\"h4\" style={styles.cardTitle}>\n        Card - Elevation {elevation}\n      </ThemedText>\n      <ThemedText type=\"small\" style={styles.cardDescription}>\n        This card has an elevation of {elevation}\n      </ThemedText>\n    </AnimatedPressable>\n  );\n}\n\nconst styles = StyleSheet.create({\n  card: {\n    padding: Spacing.xl,\n    borderRadius: BorderRadius[\"2xl\"],\n  },\n  cardTitle: {\n    marginBottom: Spacing.sm,\n  },\n  cardDescription: {\n    opacity: 0.7,\n  },\n});\n","path":null,"size_bytes":2211,"size_tokens":null},"screens/ConversationScreen.tsx":{"content":"import React, { useState, useEffect, useCallback, useRef } from \"react\";\nimport {\n  View,\n  StyleSheet,\n  TextInput,\n  Pressable,\n  FlatList,\n  Platform,\n} from \"react-native\";\nimport { useSafeAreaInsets } from \"react-native-safe-area-context\";\nimport { useRoute, RouteProp } from \"@react-navigation/native\";\nimport { Feather } from \"@expo/vector-icons\";\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { ThemedView } from \"@/components/ThemedView\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { useAuth } from \"@/contexts/AuthContext\";\nimport { useData } from \"@/contexts/DataContext\";\nimport { Spacing, BorderRadius } from \"@/constants/theme\";\nimport { Message } from \"@/types\";\nimport { MessagesStackParamList } from \"@/navigation/MessagesStackNavigator\";\n\ntype ConversationRouteProp = RouteProp<MessagesStackParamList, \"Conversation\">;\n\nfunction MessageBubble({\n  message,\n  isOwn,\n}: {\n  message: Message;\n  isOwn: boolean;\n}) {\n  const { theme } = useTheme();\n  const timeAgo = formatTime(message.createdAt);\n\n  return (\n    <View\n      style={[\n        styles.messageBubbleContainer,\n        isOwn ? styles.ownMessage : styles.otherMessage,\n      ]}\n    >\n      <View\n        style={[\n          styles.messageBubble,\n          {\n            backgroundColor: isOwn ? theme.primary : theme.backgroundSecondary,\n          },\n        ]}\n      >\n        <ThemedText\n          type=\"body\"\n          style={[styles.messageText, { color: isOwn ? \"#fff\" : theme.text }]}\n        >\n          {message.content}\n        </ThemedText>\n      </View>\n      <ThemedText\n        type=\"caption\"\n        style={[\n          styles.messageTime,\n          { color: theme.textSecondary },\n          isOwn ? styles.ownTime : styles.otherTime,\n        ]}\n      >\n        {timeAgo}\n      </ThemedText>\n    </View>\n  );\n}\n\nexport default function ConversationScreen() {\n  const { theme } = useTheme();\n  const { user } = useAuth();\n  const route = useRoute<ConversationRouteProp>();\n  const insets = useSafeAreaInsets();\n  const { conversations, getConversationMessages, sendMessage } = useData();\n  const [messages, setMessages] = useState<Message[]>([]);\n  const [newMessage, setNewMessage] = useState(\"\");\n  const [isLoading, setIsLoading] = useState(false);\n  const flatListRef = useRef<FlatList>(null);\n\n  const conversation = conversations.find(\n    (c) => c.id === route.params.conversationId\n  );\n\n  const loadMessages = useCallback(async () => {\n    if (!conversation) return;\n    const msgs = await getConversationMessages(conversation.id);\n    setMessages(msgs.sort((a, b) => b.createdAt - a.createdAt));\n  }, [conversation, getConversationMessages]);\n\n  useEffect(() => {\n    loadMessages();\n  }, [loadMessages]);\n\n  const handleSendMessage = async () => {\n    if (!newMessage.trim() || !conversation) return;\n\n    setIsLoading(true);\n    try {\n      await sendMessage(conversation.id, newMessage.trim());\n      setNewMessage(\"\");\n      await loadMessages();\n    } catch (error) {\n      console.error(\"Failed to send message:\", error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const renderMessage = ({ item }: { item: Message }) => (\n    <MessageBubble message={item} isOwn={item.senderId === user?.id} />\n  );\n\n  if (!conversation) {\n    return (\n      <ThemedView style={styles.container}>\n        <View style={styles.notFound}>\n          <ThemedText type=\"body\">Conversation not found</ThemedText>\n        </View>\n      </ThemedView>\n    );\n  }\n\n  return (\n    <ThemedView style={styles.container}>\n      <View style={[styles.encryptedBanner, { backgroundColor: theme.backgroundSecondary }]}>\n        <Feather name=\"lock\" size={14} color={theme.success} />\n        <ThemedText type=\"caption\" style={{ color: theme.success, marginLeft: Spacing.xs }}>\n          End-to-end encrypted\n        </ThemedText>\n      </View>\n\n      <FlatList\n        ref={flatListRef}\n        data={messages}\n        renderItem={renderMessage}\n        keyExtractor={(item) => item.id}\n        inverted\n        contentContainerStyle={styles.messagesList}\n        showsVerticalScrollIndicator={false}\n        ListEmptyComponent={\n          <View style={styles.emptyMessages}>\n            <ThemedText type=\"body\" style={{ color: theme.textSecondary }}>\n              Start the conversation!\n            </ThemedText>\n          </View>\n        }\n      />\n\n      <View\n        style={[\n          styles.inputContainer,\n          {\n            backgroundColor: theme.surface,\n            borderTopColor: theme.border,\n            paddingBottom: Platform.OS === \"ios\" ? insets.bottom : Spacing.md,\n          },\n        ]}\n      >\n        <View style={styles.inputRow}>\n          <Pressable\n            style={({ pressed }) => [\n              styles.attachButton,\n              { opacity: pressed ? 0.7 : 1 },\n            ]}\n          >\n            <Feather name=\"plus\" size={24} color={theme.textSecondary} />\n          </Pressable>\n          <TextInput\n            style={[\n              styles.input,\n              {\n                backgroundColor: theme.inputBackground,\n                borderColor: theme.border,\n                color: theme.text,\n              },\n            ]}\n            placeholder=\"Message...\"\n            placeholderTextColor={theme.textSecondary}\n            value={newMessage}\n            onChangeText={setNewMessage}\n            multiline\n            maxLength={1000}\n          />\n          <Pressable\n            style={({ pressed }) => [\n              styles.sendButton,\n              {\n                backgroundColor: theme.primary,\n                opacity: (!newMessage.trim() || isLoading) ? 0.5 : pressed ? 0.8 : 1,\n              },\n            ]}\n            onPress={handleSendMessage}\n            disabled={!newMessage.trim() || isLoading}\n          >\n            <Feather name=\"send\" size={18} color=\"#fff\" />\n          </Pressable>\n        </View>\n      </View>\n    </ThemedView>\n  );\n}\n\nfunction formatTime(timestamp: number): string {\n  const date = new Date(timestamp);\n  return date.toLocaleTimeString([], { hour: \"2-digit\", minute: \"2-digit\" });\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  notFound: {\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  encryptedBanner: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    paddingVertical: Spacing.sm,\n  },\n  messagesList: {\n    paddingHorizontal: Spacing.lg,\n    paddingTop: Spacing.lg,\n    paddingBottom: 100,\n  },\n  emptyMessages: {\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    transform: [{ scaleY: -1 }],\n    paddingTop: Spacing[\"4xl\"],\n  },\n  messageBubbleContainer: {\n    marginBottom: Spacing.sm,\n    maxWidth: \"80%\",\n  },\n  ownMessage: {\n    alignSelf: \"flex-end\",\n  },\n  otherMessage: {\n    alignSelf: \"flex-start\",\n  },\n  messageBubble: {\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderRadius: BorderRadius.md,\n  },\n  messageText: {},\n  messageTime: {\n    marginTop: Spacing.xs,\n  },\n  ownTime: {\n    textAlign: \"right\",\n  },\n  otherTime: {\n    textAlign: \"left\",\n  },\n  inputContainer: {\n    position: \"absolute\",\n    bottom: 0,\n    left: 0,\n    right: 0,\n    borderTopWidth: 1,\n    padding: Spacing.md,\n  },\n  inputRow: {\n    flexDirection: \"row\",\n    alignItems: \"flex-end\",\n    gap: Spacing.sm,\n  },\n  attachButton: {\n    width: 40,\n    height: 40,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  input: {\n    flex: 1,\n    minHeight: 40,\n    maxHeight: 100,\n    borderWidth: 1,\n    borderRadius: BorderRadius.xl,\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.sm,\n    fontSize: 16,\n  },\n  sendButton: {\n    width: 40,\n    height: 40,\n    borderRadius: 20,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n});\n","path":null,"size_bytes":7815,"size_tokens":null},"babel.config.js":{"content":"module.exports = function (api) {\n  api.cache(true);\n  return {\n    presets: [\"babel-preset-expo\"],\n    plugins: [\n      [\n        \"module-resolver\",\n        {\n          root: [\"./\"],\n          alias: {\n            \"@\": \"./\",\n          },\n          extensions: [\".ios.js\", \".android.js\", \".js\", \".ts\", \".tsx\", \".json\"],\n        },\n      ],\n      \"react-native-reanimated/plugin\",\n    ],\n  };\n};\n","path":null,"size_bytes":395,"size_tokens":null},"utils/storage.ts":{"content":"import AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport {\n  User,\n  Comrade,\n  Post,\n  Comment,\n  Conversation,\n  Message,\n  Organization,\n  OrgMembership,\n  AVATAR_COLORS,\n} from \"@/types\";\n\nconst KEYS = {\n  USER: \"comrade_user\",\n  COMRADES: \"comrade_comrades\",\n  POSTS: \"comrade_posts\",\n  COMMENTS: \"comrade_comments\",\n  CONVERSATIONS: \"comrade_conversations\",\n  MESSAGES: \"comrade_messages\",\n  ORGANIZATIONS: \"comrade_organizations\",\n  MEMBERSHIPS: \"comrade_memberships\",\n  BIOMETRIC_ENABLED: \"comrade_biometric_enabled\",\n  SELECTED_CITY: \"comrade_selected_city\",\n};\n\nexport async function getUser(): Promise<User | null> {\n  try {\n    const data = await AsyncStorage.getItem(KEYS.USER);\n    return data ? JSON.parse(data) : null;\n  } catch {\n    return null;\n  }\n}\n\nexport async function saveUser(user: User): Promise<void> {\n  await AsyncStorage.setItem(KEYS.USER, JSON.stringify(user));\n}\n\nexport async function createUser(displayName: string, city: string): Promise<User> {\n  const user: User = {\n    id: generateId(),\n    displayName,\n    bio: \"\",\n    avatarColor: AVATAR_COLORS[Math.floor(Math.random() * AVATAR_COLORS.length)],\n    city,\n    createdAt: Date.now(),\n    publicKey: generateId(),\n  };\n  await saveUser(user);\n  return user;\n}\n\nexport async function clearUser(): Promise<void> {\n  await AsyncStorage.removeItem(KEYS.USER);\n}\n\nexport async function getComrades(): Promise<Comrade[]> {\n  try {\n    const data = await AsyncStorage.getItem(KEYS.COMRADES);\n    return data ? JSON.parse(data) : [];\n  } catch {\n    return [];\n  }\n}\n\nexport async function saveComrades(comrades: Comrade[]): Promise<void> {\n  await AsyncStorage.setItem(KEYS.COMRADES, JSON.stringify(comrades));\n}\n\nexport async function addComrade(comradeUserId: string): Promise<Comrade> {\n  const user = await getUser();\n  if (!user) throw new Error(\"No user logged in\");\n  \n  const comrades = await getComrades();\n  const comrade: Comrade = {\n    id: generateId(),\n    userId: user.id,\n    comradeId: comradeUserId,\n    addedAt: Date.now(),\n  };\n  comrades.push(comrade);\n  await saveComrades(comrades);\n  return comrade;\n}\n\nexport async function getPosts(): Promise<Post[]> {\n  try {\n    const data = await AsyncStorage.getItem(KEYS.POSTS);\n    return data ? JSON.parse(data) : [];\n  } catch {\n    return [];\n  }\n}\n\nexport async function savePosts(posts: Post[]): Promise<void> {\n  await AsyncStorage.setItem(KEYS.POSTS, JSON.stringify(posts));\n}\n\nexport async function createPost(\n  content: string,\n  city: string,\n  organizationId?: string,\n  organizationName?: string\n): Promise<Post> {\n  const user = await getUser();\n  if (!user) throw new Error(\"No user logged in\");\n  \n  const posts = await getPosts();\n  const post: Post = {\n    id: generateId(),\n    authorId: user.id,\n    authorName: user.displayName,\n    authorAvatarColor: user.avatarColor,\n    content,\n    city,\n    organizationId,\n    organizationName,\n    isOrgPost: !!organizationId,\n    createdAt: Date.now(),\n    likes: 0,\n    commentCount: 0,\n    isLiked: false,\n  };\n  posts.unshift(post);\n  await savePosts(posts);\n  return post;\n}\n\nexport async function togglePostLike(postId: string): Promise<void> {\n  const posts = await getPosts();\n  const post = posts.find((p) => p.id === postId);\n  if (post) {\n    post.isLiked = !post.isLiked;\n    post.likes += post.isLiked ? 1 : -1;\n    await savePosts(posts);\n  }\n}\n\nexport async function getComments(postId: string): Promise<Comment[]> {\n  try {\n    const data = await AsyncStorage.getItem(KEYS.COMMENTS);\n    const allComments: Comment[] = data ? JSON.parse(data) : [];\n    return allComments.filter((c) => c.postId === postId);\n  } catch {\n    return [];\n  }\n}\n\nexport async function saveAllComments(comments: Comment[]): Promise<void> {\n  await AsyncStorage.setItem(KEYS.COMMENTS, JSON.stringify(comments));\n}\n\nexport async function createComment(\n  postId: string,\n  content: string,\n  parentId?: string\n): Promise<Comment> {\n  const user = await getUser();\n  if (!user) throw new Error(\"No user logged in\");\n  \n  const data = await AsyncStorage.getItem(KEYS.COMMENTS);\n  const allComments: Comment[] = data ? JSON.parse(data) : [];\n  \n  const comment: Comment = {\n    id: generateId(),\n    postId,\n    authorId: user.id,\n    authorName: user.displayName,\n    authorAvatarColor: user.avatarColor,\n    content,\n    parentId,\n    createdAt: Date.now(),\n    likes: 0,\n    isLiked: false,\n  };\n  allComments.push(comment);\n  await saveAllComments(allComments);\n  \n  const posts = await getPosts();\n  const post = posts.find((p) => p.id === postId);\n  if (post) {\n    post.commentCount += 1;\n    await savePosts(posts);\n  }\n  \n  return comment;\n}\n\nexport async function getConversations(): Promise<Conversation[]> {\n  try {\n    const data = await AsyncStorage.getItem(KEYS.CONVERSATIONS);\n    return data ? JSON.parse(data) : [];\n  } catch {\n    return [];\n  }\n}\n\nexport async function saveConversations(conversations: Conversation[]): Promise<void> {\n  await AsyncStorage.setItem(KEYS.CONVERSATIONS, JSON.stringify(conversations));\n}\n\nexport async function createConversation(\n  participantIds: string[],\n  participantNames: string[],\n  type: \"direct\" | \"group\" = \"direct\"\n): Promise<Conversation> {\n  const conversations = await getConversations();\n  const conversation: Conversation = {\n    id: generateId(),\n    type,\n    participantIds,\n    participantNames,\n    unreadCount: 0,\n    isEncrypted: true,\n  };\n  conversations.unshift(conversation);\n  await saveConversations(conversations);\n  return conversation;\n}\n\nexport async function getMessages(conversationId: string): Promise<Message[]> {\n  try {\n    const data = await AsyncStorage.getItem(KEYS.MESSAGES);\n    const allMessages: Message[] = data ? JSON.parse(data) : [];\n    return allMessages.filter((m) => m.conversationId === conversationId);\n  } catch {\n    return [];\n  }\n}\n\nexport async function saveAllMessages(messages: Message[]): Promise<void> {\n  await AsyncStorage.setItem(KEYS.MESSAGES, JSON.stringify(messages));\n}\n\nexport async function sendMessage(\n  conversationId: string,\n  content: string\n): Promise<Message> {\n  const user = await getUser();\n  if (!user) throw new Error(\"No user logged in\");\n  \n  const data = await AsyncStorage.getItem(KEYS.MESSAGES);\n  const allMessages: Message[] = data ? JSON.parse(data) : [];\n  \n  const message: Message = {\n    id: generateId(),\n    conversationId,\n    senderId: user.id,\n    senderName: user.displayName,\n    content,\n    createdAt: Date.now(),\n    isRead: false,\n  };\n  allMessages.push(message);\n  await saveAllMessages(allMessages);\n  \n  const conversations = await getConversations();\n  const conversation = conversations.find((c) => c.id === conversationId);\n  if (conversation) {\n    conversation.lastMessage = content;\n    conversation.lastMessageAt = Date.now();\n    await saveConversations(conversations);\n  }\n  \n  return message;\n}\n\nexport async function getOrganizations(): Promise<Organization[]> {\n  try {\n    const data = await AsyncStorage.getItem(KEYS.ORGANIZATIONS);\n    return data ? JSON.parse(data) : [];\n  } catch {\n    return [];\n  }\n}\n\nexport async function saveOrganizations(orgs: Organization[]): Promise<void> {\n  await AsyncStorage.setItem(KEYS.ORGANIZATIONS, JSON.stringify(orgs));\n}\n\nexport async function createOrganization(\n  name: string,\n  description: string,\n  city: string,\n  isPublic: boolean = true\n): Promise<Organization> {\n  const user = await getUser();\n  if (!user) throw new Error(\"No user logged in\");\n  \n  const orgs = await getOrganizations();\n  const org: Organization = {\n    id: generateId(),\n    name,\n    description,\n    avatarColor: AVATAR_COLORS[Math.floor(Math.random() * AVATAR_COLORS.length)],\n    ownerId: user.id,\n    city,\n    memberCount: 1,\n    isPublic,\n    createdAt: Date.now(),\n  };\n  orgs.push(org);\n  await saveOrganizations(orgs);\n  \n  await addMembership(org.id, user.id, \"owner\");\n  \n  return org;\n}\n\nexport async function getMemberships(): Promise<OrgMembership[]> {\n  try {\n    const data = await AsyncStorage.getItem(KEYS.MEMBERSHIPS);\n    return data ? JSON.parse(data) : [];\n  } catch {\n    return [];\n  }\n}\n\nexport async function saveMemberships(memberships: OrgMembership[]): Promise<void> {\n  await AsyncStorage.setItem(KEYS.MEMBERSHIPS, JSON.stringify(memberships));\n}\n\nexport async function addMembership(\n  organizationId: string,\n  userId: string,\n  role: \"owner\" | \"admin\" | \"member\" = \"member\"\n): Promise<OrgMembership> {\n  const memberships = await getMemberships();\n  const membership: OrgMembership = {\n    id: generateId(),\n    organizationId,\n    userId,\n    role,\n    joinedAt: Date.now(),\n  };\n  memberships.push(membership);\n  await saveMemberships(memberships);\n  return membership;\n}\n\nexport async function getUserMemberships(userId: string): Promise<OrgMembership[]> {\n  const memberships = await getMemberships();\n  return memberships.filter((m) => m.userId === userId);\n}\n\nexport async function getOrgMemberships(orgId: string): Promise<OrgMembership[]> {\n  const memberships = await getMemberships();\n  return memberships.filter((m) => m.organizationId === orgId);\n}\n\nexport async function getBiometricEnabled(): Promise<boolean> {\n  try {\n    const data = await AsyncStorage.getItem(KEYS.BIOMETRIC_ENABLED);\n    return data === \"true\";\n  } catch {\n    return false;\n  }\n}\n\nexport async function setBiometricEnabled(enabled: boolean): Promise<void> {\n  await AsyncStorage.setItem(KEYS.BIOMETRIC_ENABLED, enabled ? \"true\" : \"false\");\n}\n\nexport async function getSelectedCity(): Promise<string> {\n  try {\n    const data = await AsyncStorage.getItem(KEYS.SELECTED_CITY);\n    return data || \"sf\";\n  } catch {\n    return \"sf\";\n  }\n}\n\nexport async function setSelectedCity(cityId: string): Promise<void> {\n  await AsyncStorage.setItem(KEYS.SELECTED_CITY, cityId);\n}\n\nexport async function clearAllData(): Promise<void> {\n  await AsyncStorage.multiRemove(Object.values(KEYS));\n}\n\nfunction generateId(): string {\n  return Math.random().toString(36).substring(2, 15) + \n         Math.random().toString(36).substring(2, 15);\n}\n","path":null,"size_bytes":10067,"size_tokens":null},"navigation/MainTabNavigator.tsx":{"content":"import React from \"react\";\nimport { View, Pressable, StyleSheet, Platform } from \"react-native\";\nimport { createBottomTabNavigator } from \"@react-navigation/bottom-tabs\";\nimport { useNavigation } from \"@react-navigation/native\";\nimport { NativeStackNavigationProp } from \"@react-navigation/native-stack\";\nimport { Feather } from \"@expo/vector-icons\";\nimport { BlurView } from \"expo-blur\";\nimport FeedStackNavigator from \"@/navigation/FeedStackNavigator\";\nimport MessagesStackNavigator from \"@/navigation/MessagesStackNavigator\";\nimport OrgsStackNavigator from \"@/navigation/OrgsStackNavigator\";\nimport ProfileStackNavigator from \"@/navigation/ProfileStackNavigator\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { Spacing, Shadows } from \"@/constants/theme\";\n\nexport type MainTabParamList = {\n  FeedTab: undefined;\n  MessagesTab: undefined;\n  CreateTab: undefined;\n  OrgsTab: undefined;\n  ProfileTab: undefined;\n};\n\nconst Tab = createBottomTabNavigator<MainTabParamList>();\n\nfunction CreateTabPlaceholder() {\n  return null;\n}\n\nfunction CreatePostFAB() {\n  const { theme } = useTheme();\n  const navigation = useNavigation<NativeStackNavigationProp<any>>();\n\n  const handlePress = () => {\n    navigation.navigate(\"CreatePostModal\");\n  };\n\n  return (\n    <Pressable\n      style={({ pressed }) => [\n        styles.fab,\n        {\n          backgroundColor: theme.primary,\n          opacity: pressed ? 0.9 : 1,\n          transform: [{ scale: pressed ? 0.95 : 1 }],\n        },\n        Shadows.fab,\n      ]}\n      onPress={handlePress}\n    >\n      <Feather name=\"plus\" size={28} color=\"#fff\" />\n    </Pressable>\n  );\n}\n\nexport default function MainTabNavigator() {\n  const { theme, isDark } = useTheme();\n\n  return (\n    <View style={styles.container}>\n      <Tab.Navigator\n        initialRouteName=\"FeedTab\"\n        screenOptions={{\n          tabBarActiveTintColor: theme.tabIconSelected,\n          tabBarInactiveTintColor: theme.tabIconDefault,\n          tabBarStyle: {\n            position: \"absolute\",\n            backgroundColor: Platform.select({\n              ios: \"transparent\",\n              android: theme.backgroundRoot,\n              web: theme.backgroundRoot,\n            }),\n            borderTopWidth: 0,\n            elevation: 0,\n            height: Platform.OS === \"ios\" ? 88 : 60,\n          },\n          tabBarBackground: () =>\n            Platform.OS === \"ios\" ? (\n              <BlurView\n                intensity={100}\n                tint={isDark ? \"dark\" : \"light\"}\n                style={StyleSheet.absoluteFill}\n              />\n            ) : null,\n          headerShown: false,\n          tabBarLabelStyle: {\n            fontSize: 11,\n            fontWeight: \"500\",\n          },\n        }}\n      >\n        <Tab.Screen\n          name=\"FeedTab\"\n          component={FeedStackNavigator}\n          options={{\n            title: \"Feed\",\n            tabBarIcon: ({ color, size }) => (\n              <Feather name=\"home\" size={size} color={color} />\n            ),\n          }}\n        />\n        <Tab.Screen\n          name=\"MessagesTab\"\n          component={MessagesStackNavigator}\n          options={{\n            title: \"Messages\",\n            tabBarIcon: ({ color, size }) => (\n              <Feather name=\"message-circle\" size={size} color={color} />\n            ),\n          }}\n        />\n        <Tab.Screen\n          name=\"CreateTab\"\n          component={CreateTabPlaceholder}\n          options={{\n            title: \"\",\n            tabBarIcon: () => null,\n            tabBarButton: () => <CreatePostFAB />,\n          }}\n        />\n        <Tab.Screen\n          name=\"OrgsTab\"\n          component={OrgsStackNavigator}\n          options={{\n            title: \"Orgs\",\n            tabBarIcon: ({ color, size }) => (\n              <Feather name=\"briefcase\" size={size} color={color} />\n            ),\n          }}\n        />\n        <Tab.Screen\n          name=\"ProfileTab\"\n          component={ProfileStackNavigator}\n          options={{\n            title: \"Profile\",\n            tabBarIcon: ({ color, size }) => (\n              <Feather name=\"user\" size={size} color={color} />\n            ),\n          }}\n        />\n      </Tab.Navigator>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  fab: {\n    position: \"absolute\",\n    bottom: Platform.OS === \"ios\" ? 24 : 8,\n    alignSelf: \"center\",\n    width: 56,\n    height: 56,\n    borderRadius: 28,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n});\n","path":null,"size_bytes":4474,"size_tokens":null},"screens/FeedScreen.tsx":{"content":"import React, { useState, useCallback } from \"react\";\nimport {\n  View,\n  StyleSheet,\n  Pressable,\n  RefreshControl,\n  Modal,\n} from \"react-native\";\nimport { useNavigation } from \"@react-navigation/native\";\nimport { NativeStackNavigationProp } from \"@react-navigation/native-stack\";\nimport { Feather } from \"@expo/vector-icons\";\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { ScreenFlatList } from \"@/components/ScreenFlatList\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { useData } from \"@/contexts/DataContext\";\nimport { Spacing, BorderRadius } from \"@/constants/theme\";\nimport { Post } from \"@/types\";\nimport { FeedStackParamList } from \"@/navigation/FeedStackNavigator\";\n\nfunction Avatar({ color, size = 40, name }: { color: string; size?: number; name: string }) {\n  const initial = name.charAt(0).toUpperCase();\n  return (\n    <View\n      style={[\n        styles.avatar,\n        { backgroundColor: color, width: size, height: size, borderRadius: size / 2 },\n      ]}\n    >\n      <ThemedText\n        type=\"body\"\n        style={[styles.avatarText, { fontSize: size * 0.4 }]}\n        lightColor=\"#fff\"\n        darkColor=\"#fff\"\n      >\n        {initial}\n      </ThemedText>\n    </View>\n  );\n}\n\nfunction PostCard({\n  post,\n  onPress,\n  onLike,\n  onComment,\n  onMessage,\n}: {\n  post: Post;\n  onPress: () => void;\n  onLike: () => void;\n  onComment: () => void;\n  onMessage: () => void;\n}) {\n  const { theme } = useTheme();\n  const timeAgo = getTimeAgo(post.createdAt);\n\n  return (\n    <Pressable\n      style={({ pressed }) => [\n        styles.postCard,\n        {\n          backgroundColor: theme.surface,\n          borderColor: theme.border,\n          opacity: pressed ? 0.9 : 1,\n        },\n      ]}\n      onPress={onPress}\n    >\n      <View style={styles.postHeader}>\n        <Avatar color={post.authorAvatarColor} name={post.authorName} />\n        <View style={styles.postHeaderText}>\n          <View style={styles.authorRow}>\n            <ThemedText type=\"h4\">{post.authorName}</ThemedText>\n            {post.isOrgPost && post.organizationName ? (\n              <View style={[styles.orgBadge, { backgroundColor: theme.backgroundSecondary }]}>\n                <Feather name=\"briefcase\" size={12} color={theme.primary} />\n                <ThemedText type=\"caption\" style={{ color: theme.primary, marginLeft: 4 }}>\n                  {post.organizationName}\n                </ThemedText>\n              </View>\n            ) : null}\n          </View>\n          <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n            {timeAgo}\n          </ThemedText>\n        </View>\n      </View>\n\n      <ThemedText type=\"body\" style={styles.postContent}>\n        {post.content}\n      </ThemedText>\n\n      <View style={styles.postActions}>\n        <Pressable\n          style={({ pressed }) => [styles.actionButton, { opacity: pressed ? 0.7 : 1 }]}\n          onPress={onLike}\n        >\n          <Feather\n            name={post.isLiked ? \"heart\" : \"heart\"}\n            size={20}\n            color={post.isLiked ? theme.error : theme.textSecondary}\n          />\n          <ThemedText type=\"small\" style={{ color: theme.textSecondary, marginLeft: 6 }}>\n            {post.likes}\n          </ThemedText>\n        </Pressable>\n\n        <Pressable\n          style={({ pressed }) => [styles.actionButton, { opacity: pressed ? 0.7 : 1 }]}\n          onPress={onComment}\n        >\n          <Feather name=\"message-circle\" size={20} color={theme.textSecondary} />\n          <ThemedText type=\"small\" style={{ color: theme.textSecondary, marginLeft: 6 }}>\n            {post.commentCount}\n          </ThemedText>\n        </Pressable>\n\n        <Pressable\n          style={({ pressed }) => [styles.actionButton, { opacity: pressed ? 0.7 : 1 }]}\n          onPress={onMessage}\n        >\n          <Feather name=\"send\" size={20} color={theme.textSecondary} />\n        </Pressable>\n      </View>\n    </Pressable>\n  );\n}\n\nexport default function FeedScreen() {\n  const { theme } = useTheme();\n  const navigation = useNavigation<NativeStackNavigationProp<FeedStackParamList>>();\n  const { posts, selectedCity, getCityName, refreshPosts, togglePostLike, isLoading } = useData();\n  const [refreshing, setRefreshing] = useState(false);\n\n  const filteredPosts = posts.filter((p) => p.city === selectedCity);\n\n  const onRefresh = useCallback(async () => {\n    setRefreshing(true);\n    await refreshPosts();\n    setRefreshing(false);\n  }, [refreshPosts]);\n\n  const handlePostPress = (post: Post) => {\n    navigation.navigate(\"PostDetail\", { postId: post.id });\n  };\n\n  const handleLike = async (postId: string) => {\n    await togglePostLike(postId);\n  };\n\n  const handleComment = (post: Post) => {\n    navigation.navigate(\"PostDetail\", { postId: post.id });\n  };\n\n  const handleMessage = (post: Post) => {\n    navigation.navigate(\"NewConversation\", {\n      userId: post.authorId,\n      userName: post.authorName,\n    });\n  };\n\n  const renderPost = ({ item }: { item: Post }) => (\n    <PostCard\n      post={item}\n      onPress={() => handlePostPress(item)}\n      onLike={() => handleLike(item.id)}\n      onComment={() => handleComment(item)}\n      onMessage={() => handleMessage(item)}\n    />\n  );\n\n  const renderEmpty = () => (\n    <View style={styles.emptyContainer}>\n      <Feather name=\"inbox\" size={48} color={theme.textSecondary} />\n      <ThemedText type=\"h3\" style={styles.emptyTitle}>\n        No posts yet\n      </ThemedText>\n      <ThemedText type=\"body\" style={[styles.emptyText, { color: theme.textSecondary }]}>\n        Be the first to share something in {getCityName(selectedCity)}\n      </ThemedText>\n    </View>\n  );\n\n  return (\n    <ScreenFlatList\n      hasTabBar\n      hasHeader\n      data={filteredPosts}\n      renderItem={renderPost}\n      keyExtractor={(item) => item.id}\n      contentContainerStyle={styles.listContent}\n      ItemSeparatorComponent={() => <View style={styles.separator} />}\n      ListEmptyComponent={renderEmpty}\n      refreshControl={\n        <RefreshControl\n          refreshing={refreshing}\n          onRefresh={onRefresh}\n          tintColor={theme.primary}\n        />\n      }\n      showsVerticalScrollIndicator={false}\n    />\n  );\n}\n\nfunction getTimeAgo(timestamp: number): string {\n  const now = Date.now();\n  const diff = now - timestamp;\n  const minutes = Math.floor(diff / 60000);\n  const hours = Math.floor(diff / 3600000);\n  const days = Math.floor(diff / 86400000);\n\n  if (minutes < 1) return \"Just now\";\n  if (minutes < 60) return `${minutes}m ago`;\n  if (hours < 24) return `${hours}h ago`;\n  if (days < 7) return `${days}d ago`;\n  return new Date(timestamp).toLocaleDateString();\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  listContent: {\n    paddingHorizontal: Spacing.lg,\n  },\n  separator: {\n    height: Spacing.md,\n  },\n  postCard: {\n    borderRadius: BorderRadius.sm,\n    borderWidth: 1,\n    padding: Spacing.lg,\n  },\n  postHeader: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    marginBottom: Spacing.md,\n  },\n  avatar: {\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  avatarText: {\n    fontWeight: \"600\",\n  },\n  postHeaderText: {\n    marginLeft: Spacing.md,\n    flex: 1,\n  },\n  authorRow: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    flexWrap: \"wrap\",\n    gap: Spacing.sm,\n  },\n  orgBadge: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    paddingHorizontal: Spacing.sm,\n    paddingVertical: 2,\n    borderRadius: BorderRadius.xs,\n  },\n  postContent: {\n    marginBottom: Spacing.lg,\n  },\n  postActions: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    gap: Spacing.xl,\n  },\n  actionButton: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    paddingVertical: Spacing.xs,\n  },\n  emptyContainer: {\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    paddingTop: Spacing[\"5xl\"],\n    paddingHorizontal: Spacing.xl,\n  },\n  emptyTitle: {\n    marginTop: Spacing.lg,\n    marginBottom: Spacing.sm,\n  },\n  emptyText: {\n    textAlign: \"center\",\n  },\n  modalOverlay: {\n    flex: 1,\n    backgroundColor: \"rgba(0,0,0,0.3)\",\n  },\n  cityPickerModal: {\n    position: \"absolute\",\n    left: Spacing.lg,\n    right: Spacing.lg,\n    borderRadius: BorderRadius.sm,\n    maxHeight: 300,\n    shadowColor: \"#000\",\n    shadowOffset: { width: 0, height: 2 },\n    shadowOpacity: 0.1,\n    shadowRadius: 8,\n    elevation: 5,\n  },\n  cityOption: {\n    height: 48,\n    paddingHorizontal: Spacing.lg,\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"space-between\",\n  },\n});\n","path":null,"size_bytes":8532,"size_tokens":null},"components/HeaderTitle.tsx":{"content":"import React from \"react\";\nimport { View, StyleSheet, Image, Pressable } from \"react-native\";\nimport { Feather } from \"@expo/vector-icons\";\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { Spacing } from \"@/constants/theme\";\n\ninterface HeaderTitleProps {\n  title: string;\n  showDropdown?: boolean;\n  onPress?: () => void;\n}\n\nexport function HeaderTitle({ title, showDropdown, onPress }: HeaderTitleProps) {\n  const { theme } = useTheme();\n\n  const content = (\n    <View style={styles.container}>\n      <Image\n        source={require(\"../assets/images/icon.png\")}\n        style={styles.icon}\n        resizeMode=\"contain\"\n      />\n      <ThemedText style={styles.title}>{title}</ThemedText>\n      {showDropdown ? (\n        <Feather name=\"chevron-down\" size={16} color={theme.text} style={styles.chevron} />\n      ) : null}\n    </View>\n  );\n\n  if (onPress) {\n    return (\n      <Pressable\n        onPress={onPress}\n        style={({ pressed }) => [{ opacity: pressed ? 0.7 : 1 }]}\n      >\n        {content}\n      </Pressable>\n    );\n  }\n\n  return content;\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"flex-start\",\n  },\n  icon: {\n    width: 28,\n    height: 28,\n    marginRight: Spacing.sm,\n  },\n  title: {\n    fontSize: 17,\n    fontWeight: \"600\",\n  },\n  chevron: {\n    marginLeft: Spacing.xs,\n  },\n});\n","path":null,"size_bytes":1438,"size_tokens":null},"components/Spacer.tsx":{"content":"import { View } from \"react-native\";\n\ntype Props = {\n  width?: number;\n  height?: number;\n};\n\nexport default function Spacer(props: Props) {\n  const width: number = props.width ?? 1;\n  const height: number = props.height ?? 1;\n\n  return (\n    <View\n      style={{\n        width,\n        height,\n      }}\n    />\n  );\n}\n","path":null,"size_bytes":318,"size_tokens":null},"screens/PostDetailScreen.tsx":{"content":"import React, { useState, useEffect, useCallback } from \"react\";\nimport {\n  View,\n  StyleSheet,\n  TextInput,\n  Pressable,\n  FlatList,\n  Platform,\n} from \"react-native\";\nimport { useSafeAreaInsets } from \"react-native-safe-area-context\";\nimport { useRoute, RouteProp, useNavigation } from \"@react-navigation/native\";\nimport { Feather } from \"@expo/vector-icons\";\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { ThemedView } from \"@/components/ThemedView\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { useData } from \"@/contexts/DataContext\";\nimport { Spacing, BorderRadius } from \"@/constants/theme\";\nimport { Post, Comment } from \"@/types\";\nimport { FeedStackParamList } from \"@/navigation/FeedStackNavigator\";\n\ntype PostDetailRouteProp = RouteProp<FeedStackParamList, \"PostDetail\">;\n\nfunction Avatar({ color, size = 40, name }: { color: string; size?: number; name: string }) {\n  const initial = name.charAt(0).toUpperCase();\n  return (\n    <View\n      style={[\n        { backgroundColor: color, width: size, height: size, borderRadius: size / 2, alignItems: \"center\", justifyContent: \"center\" },\n      ]}\n    >\n      <ThemedText\n        type=\"body\"\n        style={{ fontSize: size * 0.4, fontWeight: \"600\" }}\n        lightColor=\"#fff\"\n        darkColor=\"#fff\"\n      >\n        {initial}\n      </ThemedText>\n    </View>\n  );\n}\n\nfunction CommentItem({\n  comment,\n  onReply,\n  isReply = false,\n}: {\n  comment: Comment;\n  onReply: (comment: Comment) => void;\n  isReply?: boolean;\n}) {\n  const { theme } = useTheme();\n  const timeAgo = getTimeAgo(comment.createdAt);\n\n  return (\n    <View style={[styles.commentItem, isReply && styles.replyItem]}>\n      <Avatar color={comment.authorAvatarColor} size={32} name={comment.authorName} />\n      <View style={styles.commentContent}>\n        <View style={styles.commentHeader}>\n          <ThemedText type=\"small\" style={{ fontWeight: \"600\" }}>\n            {comment.authorName}\n          </ThemedText>\n          <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n            {timeAgo}\n          </ThemedText>\n        </View>\n        <ThemedText type=\"body\" style={styles.commentText}>\n          {comment.content}\n        </ThemedText>\n        {!isReply ? (\n          <Pressable\n            style={({ pressed }) => [styles.replyButton, { opacity: pressed ? 0.7 : 1 }]}\n            onPress={() => onReply(comment)}\n          >\n            <ThemedText type=\"caption\" style={{ color: theme.primary }}>\n              Reply\n            </ThemedText>\n          </Pressable>\n        ) : null}\n      </View>\n    </View>\n  );\n}\n\nexport default function PostDetailScreen() {\n  const { theme } = useTheme();\n  const route = useRoute<PostDetailRouteProp>();\n  const navigation = useNavigation();\n  const insets = useSafeAreaInsets();\n  const { posts, getPostComments, createComment, togglePostLike } = useData();\n  const [comments, setComments] = useState<Comment[]>([]);\n  const [newComment, setNewComment] = useState(\"\");\n  const [replyingTo, setReplyingTo] = useState<Comment | null>(null);\n  const [isLoading, setIsLoading] = useState(false);\n\n  const post = posts.find((p) => p.id === route.params.postId);\n\n  const loadComments = useCallback(async () => {\n    if (!post) return;\n    const postComments = await getPostComments(post.id);\n    setComments(postComments.sort((a, b) => a.createdAt - b.createdAt));\n  }, [post, getPostComments]);\n\n  useEffect(() => {\n    loadComments();\n  }, [loadComments]);\n\n  const handleSubmitComment = async () => {\n    if (!newComment.trim() || !post) return;\n\n    setIsLoading(true);\n    try {\n      await createComment(post.id, newComment.trim(), replyingTo?.id);\n      setNewComment(\"\");\n      setReplyingTo(null);\n      await loadComments();\n    } catch (error) {\n      console.error(\"Failed to create comment:\", error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleReply = (comment: Comment) => {\n    setReplyingTo(comment);\n  };\n\n  const cancelReply = () => {\n    setReplyingTo(null);\n  };\n\n  if (!post) {\n    return (\n      <ThemedView style={styles.container}>\n        <View style={styles.notFound}>\n          <ThemedText type=\"body\">Post not found</ThemedText>\n        </View>\n      </ThemedView>\n    );\n  }\n\n  const rootComments = comments.filter((c) => !c.parentId);\n  const getReplies = (parentId: string) =>\n    comments.filter((c) => c.parentId === parentId);\n\n  const renderComment = ({ item }: { item: Comment }) => (\n    <View>\n      <CommentItem comment={item} onReply={handleReply} />\n      {getReplies(item.id).map((reply) => (\n        <CommentItem\n          key={reply.id}\n          comment={reply}\n          onReply={handleReply}\n          isReply\n        />\n      ))}\n    </View>\n  );\n\n  const timeAgo = getTimeAgo(post.createdAt);\n\n  return (\n    <ThemedView style={styles.container}>\n      <FlatList\n        data={rootComments}\n        renderItem={renderComment}\n        keyExtractor={(item) => item.id}\n        contentContainerStyle={[styles.listContent]}\n        ListHeaderComponent={\n          <View style={[styles.postSection, { borderBottomColor: theme.border }]}>\n            <View style={styles.postHeader}>\n              <Avatar color={post.authorAvatarColor} name={post.authorName} />\n              <View style={styles.postHeaderText}>\n                <ThemedText type=\"h4\">{post.authorName}</ThemedText>\n                <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n                  {timeAgo}\n                </ThemedText>\n              </View>\n            </View>\n            <ThemedText type=\"body\" style={styles.postContent}>\n              {post.content}\n            </ThemedText>\n            <View style={styles.postActions}>\n              <Pressable\n                style={({ pressed }) => [styles.actionButton, { opacity: pressed ? 0.7 : 1 }]}\n                onPress={() => togglePostLike(post.id)}\n              >\n                <Feather\n                  name=\"heart\"\n                  size={20}\n                  color={post.isLiked ? theme.error : theme.textSecondary}\n                />\n                <ThemedText type=\"small\" style={{ color: theme.textSecondary, marginLeft: 6 }}>\n                  {post.likes}\n                </ThemedText>\n              </Pressable>\n              <View style={styles.actionButton}>\n                <Feather name=\"message-circle\" size={20} color={theme.textSecondary} />\n                <ThemedText type=\"small\" style={{ color: theme.textSecondary, marginLeft: 6 }}>\n                  {comments.length}\n                </ThemedText>\n              </View>\n            </View>\n          </View>\n        }\n        ListEmptyComponent={\n          <View style={styles.emptyComments}>\n            <ThemedText type=\"body\" style={{ color: theme.textSecondary }}>\n              No comments yet. Be the first to comment!\n            </ThemedText>\n          </View>\n        }\n        ItemSeparatorComponent={() => <View style={{ height: Spacing.sm }} />}\n      />\n\n      <View\n        style={[\n          styles.inputContainer,\n          {\n            backgroundColor: theme.surface,\n            borderTopColor: theme.border,\n            paddingBottom: Platform.OS === \"ios\" ? insets.bottom : Spacing.md,\n          },\n        ]}\n      >\n        {replyingTo ? (\n          <View style={[styles.replyingTo, { backgroundColor: theme.backgroundSecondary }]}>\n            <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n              Replying to {replyingTo.authorName}\n            </ThemedText>\n            <Pressable onPress={cancelReply}>\n              <Feather name=\"x\" size={16} color={theme.textSecondary} />\n            </Pressable>\n          </View>\n        ) : null}\n        <View style={styles.inputRow}>\n          <TextInput\n            style={[\n              styles.input,\n              {\n                backgroundColor: theme.inputBackground,\n                borderColor: theme.border,\n                color: theme.text,\n              },\n            ]}\n            placeholder=\"Add a comment...\"\n            placeholderTextColor={theme.textSecondary}\n            value={newComment}\n            onChangeText={setNewComment}\n            multiline\n            maxLength={500}\n          />\n          <Pressable\n            style={({ pressed }) => [\n              styles.sendButton,\n              {\n                backgroundColor: theme.primary,\n                opacity: (!newComment.trim() || isLoading) ? 0.5 : pressed ? 0.8 : 1,\n              },\n            ]}\n            onPress={handleSubmitComment}\n            disabled={!newComment.trim() || isLoading}\n          >\n            <Feather name=\"send\" size={18} color=\"#fff\" />\n          </Pressable>\n        </View>\n      </View>\n    </ThemedView>\n  );\n}\n\nfunction getTimeAgo(timestamp: number): string {\n  const now = Date.now();\n  const diff = now - timestamp;\n  const minutes = Math.floor(diff / 60000);\n  const hours = Math.floor(diff / 3600000);\n  const days = Math.floor(diff / 86400000);\n\n  if (minutes < 1) return \"Just now\";\n  if (minutes < 60) return `${minutes}m ago`;\n  if (hours < 24) return `${hours}h ago`;\n  if (days < 7) return `${days}d ago`;\n  return new Date(timestamp).toLocaleDateString();\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  notFound: {\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  listContent: {\n    paddingHorizontal: Spacing.lg,\n    paddingBottom: 100,\n  },\n  postSection: {\n    paddingVertical: Spacing.lg,\n    borderBottomWidth: 1,\n    marginBottom: Spacing.lg,\n  },\n  postHeader: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    marginBottom: Spacing.md,\n  },\n  postHeaderText: {\n    marginLeft: Spacing.md,\n  },\n  postContent: {\n    marginBottom: Spacing.lg,\n  },\n  postActions: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    gap: Spacing.xl,\n  },\n  actionButton: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    paddingVertical: Spacing.xs,\n  },\n  emptyComments: {\n    padding: Spacing.xl,\n    alignItems: \"center\",\n  },\n  commentItem: {\n    flexDirection: \"row\",\n    paddingVertical: Spacing.sm,\n  },\n  replyItem: {\n    marginLeft: Spacing[\"3xl\"],\n  },\n  commentContent: {\n    marginLeft: Spacing.md,\n    flex: 1,\n  },\n  commentHeader: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    gap: Spacing.sm,\n    marginBottom: Spacing.xs,\n  },\n  commentText: {\n    marginBottom: Spacing.xs,\n  },\n  replyButton: {\n    paddingVertical: Spacing.xs,\n  },\n  inputContainer: {\n    position: \"absolute\",\n    bottom: 0,\n    left: 0,\n    right: 0,\n    borderTopWidth: 1,\n    padding: Spacing.md,\n  },\n  replyingTo: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"space-between\",\n    padding: Spacing.sm,\n    borderRadius: BorderRadius.xs,\n    marginBottom: Spacing.sm,\n  },\n  inputRow: {\n    flexDirection: \"row\",\n    alignItems: \"flex-end\",\n    gap: Spacing.sm,\n  },\n  input: {\n    flex: 1,\n    minHeight: 40,\n    maxHeight: 100,\n    borderWidth: 1,\n    borderRadius: BorderRadius.xs,\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    fontSize: 16,\n  },\n  sendButton: {\n    width: 40,\n    height: 40,\n    borderRadius: 20,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n});\n","path":null,"size_bytes":11261,"size_tokens":null},"screens/OrganizationsScreen.tsx":{"content":"import React, { useState, useCallback } from \"react\";\nimport {\n  View,\n  StyleSheet,\n  FlatList,\n  Pressable,\n  RefreshControl,\n} from \"react-native\";\nimport { useBottomTabBarHeight } from \"@react-navigation/bottom-tabs\";\nimport { useNavigation } from \"@react-navigation/native\";\nimport { NativeStackNavigationProp } from \"@react-navigation/native-stack\";\nimport { Feather } from \"@expo/vector-icons\";\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { ThemedView } from \"@/components/ThemedView\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { useAuth } from \"@/contexts/AuthContext\";\nimport { useData } from \"@/contexts/DataContext\";\nimport { Spacing, BorderRadius } from \"@/constants/theme\";\nimport { Organization } from \"@/types\";\nimport { OrgsStackParamList } from \"@/navigation/OrgsStackNavigator\";\n\nfunction OrgCard({\n  org,\n  isMember,\n  onPress,\n}: {\n  org: Organization;\n  isMember: boolean;\n  onPress: () => void;\n}) {\n  const { theme } = useTheme();\n\n  return (\n    <Pressable\n      style={({ pressed }) => [\n        styles.orgCard,\n        {\n          backgroundColor: theme.surface,\n          borderColor: theme.border,\n          opacity: pressed ? 0.9 : 1,\n        },\n      ]}\n      onPress={onPress}\n    >\n      <View style={[styles.orgAvatar, { backgroundColor: org.avatarColor }]}>\n        <Feather name=\"briefcase\" size={24} color=\"#fff\" />\n      </View>\n      <View style={styles.orgContent}>\n        <ThemedText type=\"h4\" numberOfLines={1}>\n          {org.name}\n        </ThemedText>\n        <ThemedText\n          type=\"small\"\n          numberOfLines={2}\n          style={{ color: theme.textSecondary }}\n        >\n          {org.description}\n        </ThemedText>\n        <View style={styles.orgMeta}>\n          <Feather name=\"users\" size={14} color={theme.textSecondary} />\n          <ThemedText type=\"caption\" style={{ color: theme.textSecondary, marginLeft: 4 }}>\n            {org.memberCount} members\n          </ThemedText>\n          {isMember ? (\n            <View style={[styles.memberBadge, { backgroundColor: theme.success }]}>\n              <ThemedText type=\"caption\" style={{ color: \"#fff\" }}>\n                Member\n              </ThemedText>\n            </View>\n          ) : null}\n        </View>\n      </View>\n      <Feather name=\"chevron-right\" size={20} color={theme.textSecondary} />\n    </Pressable>\n  );\n}\n\nexport default function OrganizationsScreen() {\n  const { theme } = useTheme();\n  const { user } = useAuth();\n  const navigation = useNavigation<NativeStackNavigationProp<OrgsStackParamList>>();\n  const tabBarHeight = useBottomTabBarHeight();\n  const {\n    organizations,\n    userMemberships,\n    selectedCity,\n    getCityName,\n    refreshOrganizations,\n  } = useData();\n  const [activeTab, setActiveTab] = useState<\"my\" | \"discover\">(\"my\");\n  const [refreshing, setRefreshing] = useState(false);\n\n  const myOrgIds = userMemberships.map((m) => m.organizationId);\n  const myOrgs = organizations.filter((o) => myOrgIds.includes(o.id));\n  const discoverOrgs = organizations.filter(\n    (o) => !myOrgIds.includes(o.id) && o.city === selectedCity && o.isPublic\n  );\n\n  const onRefresh = useCallback(async () => {\n    setRefreshing(true);\n    await refreshOrganizations();\n    setRefreshing(false);\n  }, [refreshOrganizations]);\n\n  const handleOrgPress = (org: Organization) => {\n    navigation.navigate(\"OrganizationHub\", { orgId: org.id });\n  };\n\n  const handleCreateOrg = () => {\n    navigation.navigate(\"CreateOrganization\");\n  };\n\n  const renderOrg = ({ item }: { item: Organization }) => (\n    <OrgCard\n      org={item}\n      isMember={myOrgIds.includes(item.id)}\n      onPress={() => handleOrgPress(item)}\n    />\n  );\n\n  const renderEmpty = () => (\n    <View style={styles.emptyContainer}>\n      <Feather name=\"briefcase\" size={48} color={theme.textSecondary} />\n      <ThemedText type=\"h3\" style={styles.emptyTitle}>\n        {activeTab === \"my\" ? \"No organizations yet\" : \"No organizations to discover\"}\n      </ThemedText>\n      <ThemedText type=\"body\" style={[styles.emptyText, { color: theme.textSecondary }]}>\n        {activeTab === \"my\"\n          ? \"Create or join an organization to get started\"\n          : `No public organizations in ${getCityName(selectedCity)}`}\n      </ThemedText>\n      {activeTab === \"my\" ? (\n        <Pressable\n          style={({ pressed }) => [\n            styles.createButton,\n            { backgroundColor: theme.primary, opacity: pressed ? 0.8 : 1 },\n          ]}\n          onPress={handleCreateOrg}\n        >\n          <ThemedText type=\"body\" style={{ color: \"#fff\", fontWeight: \"600\" }}>\n            Create Organization\n          </ThemedText>\n        </Pressable>\n      ) : null}\n    </View>\n  );\n\n  const currentData = activeTab === \"my\" ? myOrgs : discoverOrgs;\n\n  return (\n    <ThemedView style={styles.container}>\n      <View style={[styles.tabsContainer, { borderBottomColor: theme.border }]}>\n        <Pressable\n          style={[\n            styles.tab,\n            activeTab === \"my\" && [styles.activeTab, { borderBottomColor: theme.primary }],\n          ]}\n          onPress={() => setActiveTab(\"my\")}\n        >\n          <ThemedText\n            type=\"body\"\n            style={[\n              styles.tabText,\n              { color: activeTab === \"my\" ? theme.primary : theme.textSecondary },\n            ]}\n          >\n            My Orgs\n          </ThemedText>\n        </Pressable>\n        <Pressable\n          style={[\n            styles.tab,\n            activeTab === \"discover\" && [styles.activeTab, { borderBottomColor: theme.primary }],\n          ]}\n          onPress={() => setActiveTab(\"discover\")}\n        >\n          <ThemedText\n            type=\"body\"\n            style={[\n              styles.tabText,\n              { color: activeTab === \"discover\" ? theme.primary : theme.textSecondary },\n            ]}\n          >\n            Discover\n          </ThemedText>\n        </Pressable>\n      </View>\n\n      <FlatList\n        data={currentData}\n        renderItem={renderOrg}\n        keyExtractor={(item) => item.id}\n        contentContainerStyle={[\n          styles.listContent,\n          { paddingBottom: tabBarHeight + Spacing.xl },\n        ]}\n        ItemSeparatorComponent={() => <View style={{ height: Spacing.md }} />}\n        ListEmptyComponent={renderEmpty}\n        refreshControl={\n          <RefreshControl\n            refreshing={refreshing}\n            onRefresh={onRefresh}\n            tintColor={theme.primary}\n          />\n        }\n        showsVerticalScrollIndicator={false}\n      />\n    </ThemedView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  tabsContainer: {\n    flexDirection: \"row\",\n    borderBottomWidth: 1,\n  },\n  tab: {\n    flex: 1,\n    paddingVertical: Spacing.md,\n    alignItems: \"center\",\n  },\n  activeTab: {\n    borderBottomWidth: 2,\n  },\n  tabText: {\n    fontWeight: \"600\",\n  },\n  listContent: {\n    padding: Spacing.lg,\n    flexGrow: 1,\n  },\n  orgCard: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    borderRadius: BorderRadius.sm,\n    borderWidth: 1,\n    padding: Spacing.lg,\n  },\n  orgAvatar: {\n    width: 56,\n    height: 56,\n    borderRadius: BorderRadius.sm,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  orgContent: {\n    flex: 1,\n    marginHorizontal: Spacing.md,\n  },\n  orgMeta: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    marginTop: Spacing.xs,\n  },\n  memberBadge: {\n    marginLeft: Spacing.sm,\n    paddingHorizontal: Spacing.sm,\n    paddingVertical: 2,\n    borderRadius: BorderRadius.xs,\n  },\n  emptyContainer: {\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    paddingHorizontal: Spacing.xl,\n    paddingTop: Spacing[\"4xl\"],\n  },\n  emptyTitle: {\n    marginTop: Spacing.lg,\n    marginBottom: Spacing.sm,\n    textAlign: \"center\",\n  },\n  emptyText: {\n    textAlign: \"center\",\n    marginBottom: Spacing.xl,\n  },\n  createButton: {\n    paddingHorizontal: Spacing.xl,\n    paddingVertical: Spacing.md,\n    borderRadius: BorderRadius.full,\n  },\n});\n","path":null,"size_bytes":8010,"size_tokens":null},"navigation/MessagesStackNavigator.tsx":{"content":"import React from \"react\";\nimport { Pressable } from \"react-native\";\nimport { createNativeStackNavigator } from \"@react-navigation/native-stack\";\nimport { Feather } from \"@expo/vector-icons\";\nimport MessagesScreen from \"@/screens/MessagesScreen\";\nimport ConversationScreen from \"@/screens/ConversationScreen\";\nimport NewConversationScreen from \"@/screens/NewConversationScreen\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { getCommonScreenOptions } from \"@/navigation/screenOptions\";\n\nexport type MessagesStackParamList = {\n  Messages: undefined;\n  Conversation: { conversationId: string };\n  NewConversation: { userId?: string; userName?: string };\n};\n\nconst Stack = createNativeStackNavigator<MessagesStackParamList>();\n\nexport default function MessagesStackNavigator() {\n  const { theme, isDark } = useTheme();\n\n  return (\n    <Stack.Navigator\n      screenOptions={{\n        ...getCommonScreenOptions({ theme, isDark, transparent: false }),\n      }}\n    >\n      <Stack.Screen\n        name=\"Messages\"\n        component={MessagesScreen}\n        options={({ navigation }) => ({\n          headerTitle: \"Messages\",\n          headerRight: () => (\n            <Pressable\n              onPress={() => navigation.navigate(\"NewConversation\", {})}\n              style={({ pressed }) => ({ opacity: pressed ? 0.7 : 1 })}\n            >\n              <Feather name=\"edit\" size={22} color={theme.text} />\n            </Pressable>\n          ),\n        })}\n      />\n      <Stack.Screen\n        name=\"Conversation\"\n        component={ConversationScreen}\n        options={({ route }) => ({\n          headerTitle: \"Chat\",\n        })}\n      />\n      <Stack.Screen\n        name=\"NewConversation\"\n        component={NewConversationScreen}\n        options={{\n          headerTitle: \"New Message\",\n          presentation: \"modal\",\n        }}\n      />\n    </Stack.Navigator>\n  );\n}\n","path":null,"size_bytes":1868,"size_tokens":null},"types/index.ts":{"content":"export interface User {\n  id: string;\n  displayName: string;\n  bio: string;\n  avatarColor: string;\n  city: string;\n  createdAt: number;\n  publicKey: string;\n}\n\nexport interface Comrade {\n  id: string;\n  userId: string;\n  comradeId: string;\n  addedAt: number;\n}\n\nexport interface Post {\n  id: string;\n  authorId: string;\n  authorName: string;\n  authorAvatarColor: string;\n  content: string;\n  city: string;\n  organizationId?: string;\n  organizationName?: string;\n  isOrgPost: boolean;\n  createdAt: number;\n  likes: number;\n  commentCount: number;\n  isLiked: boolean;\n}\n\nexport interface Comment {\n  id: string;\n  postId: string;\n  authorId: string;\n  authorName: string;\n  authorAvatarColor: string;\n  content: string;\n  parentId?: string;\n  createdAt: number;\n  likes: number;\n  isLiked: boolean;\n}\n\nexport interface Conversation {\n  id: string;\n  type: \"direct\" | \"group\";\n  participantIds: string[];\n  participantNames: string[];\n  lastMessage?: string;\n  lastMessageAt?: number;\n  unreadCount: number;\n  isEncrypted: boolean;\n}\n\nexport interface Message {\n  id: string;\n  conversationId: string;\n  senderId: string;\n  senderName: string;\n  content: string;\n  encryptedContent?: string;\n  createdAt: number;\n  isRead: boolean;\n}\n\nexport interface Organization {\n  id: string;\n  name: string;\n  description: string;\n  avatarColor: string;\n  ownerId: string;\n  city: string;\n  memberCount: number;\n  isPublic: boolean;\n  createdAt: number;\n}\n\nexport interface OrgMembership {\n  id: string;\n  organizationId: string;\n  userId: string;\n  role: \"owner\" | \"admin\" | \"member\";\n  joinedAt: number;\n}\n\n\nexport const AVATAR_COLORS = [\n  \"#8B7355\",\n  \"#D4A373\",\n  \"#6B8E23\",\n  \"#A67B5B\",\n  \"#9CAF88\",\n  \"#B5838D\",\n];\n","path":null,"size_bytes":1708,"size_tokens":null},"scripts/build.js":{"content":"const fs = require(\"fs\");\nconst path = require(\"path\");\nconst { spawn } = require(\"child_process\");\nconst { Readable } = require(\"stream\");\nconst { pipeline } = require(\"stream/promises\");\n\nlet metroProcess = null;\n\nfunction exitWithError(message) {\n  console.error(message);\n  if (metroProcess) {\n    metroProcess.kill();\n  }\n  process.exit(1);\n}\n\nfunction setupSignalHandlers() {\n  const cleanup = () => {\n    if (metroProcess) {\n      console.log(\"Cleaning up Metro process...\");\n      metroProcess.kill();\n    }\n    process.exit(0);\n  };\n\n  process.on(\"SIGINT\", cleanup);\n  process.on(\"SIGTERM\", cleanup);\n  process.on(\"SIGHUP\", cleanup);\n}\n\nfunction getDeploymentUrl() {\n  if (process.env.REPLIT_INTERNAL_APP_DOMAIN) {\n    const url = `https://${process.env.REPLIT_INTERNAL_APP_DOMAIN}`;\n    console.log(\"Using REPLIT_INTERNAL_APP_DOMAIN:\", url);\n    return url;\n  }\n\n  if (process.env.REPLIT_DEV_DOMAIN) {\n    const url = `https://${process.env.REPLIT_DEV_DOMAIN}`;\n    console.log(\"Using REPLIT_DEV_DOMAIN:\", url);\n    return url;\n  }\n\n  console.error(\n    \"ERROR: REPLIT_INTERNAL_APP_DOMAIN and REPLIT_DEV_DOMAIN not set\",\n  );\n  process.exit(1);\n}\n\nfunction prepareDirectories(timestamp) {\n  console.log(\"Preparing build directories...\");\n\n  if (fs.existsSync(\"static-build\")) {\n    fs.rmSync(\"static-build\", { recursive: true });\n  }\n\n  const dirs = [\n    path.join(\"static-build\", timestamp, \"_expo\", \"static\", \"js\", \"ios\"),\n    path.join(\"static-build\", timestamp, \"_expo\", \"static\", \"js\", \"android\"),\n    path.join(\"static-build\", \"ios\"),\n    path.join(\"static-build\", \"android\"),\n  ];\n\n  for (const dir of dirs) {\n    fs.mkdirSync(dir, { recursive: true });\n  }\n\n  console.log(\"Build:\", timestamp);\n}\n\nfunction clearMetroCache() {\n  console.log(\"Clearing Metro cache...\");\n\n  const cacheDirs = [\n    ...fs.globSync(\".metro-cache\"),\n    ...fs.globSync(\"node_modules/.cache/metro\"),\n  ];\n\n  for (const dir of cacheDirs) {\n    fs.rmSync(dir, { recursive: true, force: true });\n  }\n\n  console.log(\"Cache cleared\");\n}\n\nasync function checkMetroHealth() {\n  try {\n    const response = await fetch(\"http://localhost:8081/status\");\n    return response.ok;\n  } catch {\n    return false;\n  }\n}\n\nasync function startMetro() {\n  const isRunning = await checkMetroHealth();\n  if (isRunning) {\n    return;\n  }\n\n  console.log(\"Starting Metro...\");\n  metroProcess = spawn(\"npm\", [\"run\", \"dev\"], {\n    stdio: [\"ignore\", \"ignore\", \"ignore\"],\n    detached: false,\n  });\n\n  for (let i = 0; i < 30; i++) {\n    await new Promise((resolve) => setTimeout(resolve, 1000));\n    const healthy = await checkMetroHealth();\n    if (healthy) {\n      console.log(\"Metro ready\");\n      return;\n    }\n  }\n\n  console.error(\"Metro timeout\");\n  process.exit(1);\n}\n\nasync function downloadFile(url, outputPath) {\n  try {\n    const response = await fetch(url);\n\n    if (!response.ok) {\n      throw new Error(`HTTP ${response.status}`);\n    }\n\n    const file = fs.createWriteStream(outputPath);\n    await pipeline(Readable.fromWeb(response.body), file);\n\n    const fileSize = fs.statSync(outputPath).size;\n\n    if (fileSize === 0) {\n      fs.unlinkSync(outputPath);\n      throw new Error(\"Downloaded file is empty\");\n    }\n  } catch (error) {\n    if (fs.existsSync(outputPath)) {\n      fs.unlinkSync(outputPath);\n    }\n    throw error;\n  }\n}\n\nasync function downloadBundle(platform, timestamp) {\n  const url = new URL(\"http://localhost:8081/index.bundle\");\n  url.searchParams.set(\"platform\", platform);\n  url.searchParams.set(\"dev\", \"false\");\n  url.searchParams.set(\"hot\", \"false\");\n  url.searchParams.set(\"lazy\", \"false\");\n  url.searchParams.set(\"minify\", \"true\");\n\n  const output = path.join(\n    \"static-build\",\n    timestamp,\n    \"_expo\",\n    \"static\",\n    \"js\",\n    platform,\n    \"bundle.js\",\n  );\n\n  try {\n    await downloadFile(url.toString(), output);\n  } catch (error) {\n    exitWithError(`Failed to download ${platform} bundle: ${error.message}`);\n  }\n}\n\nasync function downloadManifest(platform) {\n  const response = await fetch(\"http://localhost:8081/manifest\", {\n    headers: { \"expo-platform\": platform },\n  });\n\n  if (!response.ok) {\n    throw new Error(`HTTP ${response.status}`);\n  }\n\n  return await response.json();\n}\n\nasync function downloadBundlesAndManifests(timestamp) {\n  console.log(\"Downloading bundles and manifests...\");\n\n  try {\n    const [, , iosManifest, androidManifest] = await Promise.all([\n      downloadBundle(\"ios\", timestamp),\n      downloadBundle(\"android\", timestamp),\n      downloadManifest(\"ios\"),\n      downloadManifest(\"android\"),\n    ]);\n    console.log(\"Downloaded\");\n    return { ios: iosManifest, android: androidManifest };\n  } catch (error) {\n    exitWithError(`Download failed: ${error.message}`);\n  }\n}\n\nfunction extractAssets(timestamp) {\n  const bundles = {\n    ios: fs.readFileSync(\n      path.join(\n        \"static-build\",\n        timestamp,\n        \"_expo\",\n        \"static\",\n        \"js\",\n        \"ios\",\n        \"bundle.js\",\n      ),\n      \"utf-8\",\n    ),\n    android: fs.readFileSync(\n      path.join(\n        \"static-build\",\n        timestamp,\n        \"_expo\",\n        \"static\",\n        \"js\",\n        \"android\",\n        \"bundle.js\",\n      ),\n      \"utf-8\",\n    ),\n  };\n\n  const assetsMap = new Map();\n  const assetPattern =\n    /httpServerLocation:\"([^\"]+)\"[^}]*hash:\"([^\"]+)\"[^}]*name:\"([^\"]+)\"[^}]*type:\"([^\"]+)\"/g;\n\n  const extractFromBundle = (bundle, platform) => {\n    for (const match of bundle.matchAll(assetPattern)) {\n      const originalPath = match[1];\n      const filename = match[3] + \".\" + match[4];\n\n      const tempUrl = new URL(`http://localhost:8081${originalPath}`);\n      const unstablePath = tempUrl.searchParams.get(\"unstable_path\");\n\n      if (!unstablePath) {\n        throw new Error(`Asset missing unstable_path: ${originalPath}`);\n      }\n\n      const decodedPath = decodeURIComponent(unstablePath).replace(/^\\.\\//, \"\");\n      const key = path.posix.join(decodedPath, filename);\n\n      if (!assetsMap.has(key)) {\n        const asset = {\n          url: path.posix.join(\"/\", decodedPath, filename),\n          originalPath: originalPath,\n          filename: filename,\n          relativePath: decodedPath,\n          hash: match[2],\n          platforms: new Set(),\n        };\n\n        assetsMap.set(key, asset);\n      }\n      assetsMap.get(key).platforms.add(platform);\n    }\n  };\n\n  extractFromBundle(bundles.ios, \"ios\");\n  extractFromBundle(bundles.android, \"android\");\n\n  return Array.from(assetsMap.values());\n}\n\nasync function downloadAssets(assets, timestamp) {\n  if (assets.length === 0) {\n    return 0;\n  }\n\n  console.log(\"Downloading assets...\");\n  let successCount = 0;\n  const failures = [];\n\n  const downloadPromises = assets.map(async (asset) => {\n    const platform = Array.from(asset.platforms)[0];\n\n    const tempUrl = new URL(`http://localhost:8081${asset.originalPath}`);\n    const unstablePath = tempUrl.searchParams.get(\"unstable_path\");\n\n    if (!unstablePath) {\n      throw new Error(`Asset missing unstable_path: ${asset.originalPath}`);\n    }\n\n    const decodedPath = decodeURIComponent(unstablePath).replace(/^\\./, \"\");\n    const metroUrl = new URL(\n      `http://localhost:8081${path.posix.join(\"/assets\", decodedPath, asset.filename)}`,\n    );\n    metroUrl.searchParams.set(\"platform\", platform);\n    metroUrl.searchParams.set(\"hash\", asset.hash);\n\n    const outputDir = path.join(\n      \"static-build\",\n      timestamp,\n      \"_expo\",\n      \"static\",\n      \"js\",\n      asset.relativePath,\n    );\n    fs.mkdirSync(outputDir, { recursive: true });\n    const output = path.join(outputDir, asset.filename);\n\n    try {\n      await downloadFile(metroUrl.toString(), output);\n      successCount++;\n    } catch (error) {\n      failures.push({\n        filename: asset.filename,\n        error: error.message,\n        url: metroUrl.toString(),\n      });\n    }\n  });\n\n  await Promise.all(downloadPromises);\n\n  if (failures.length > 0) {\n    const errorMsg =\n      `Failed to download ${failures.length} asset(s):\\n` +\n      failures\n        .map((f) => `  - ${f.filename}: ${f.error} (${f.url})`)\n        .join(\"\\n\");\n    exitWithError(errorMsg);\n  }\n\n  console.log(`Downloaded ${successCount} assets`);\n  return successCount;\n}\n\nfunction updateBundleUrls(timestamp, baseUrl) {\n  const updateForPlatform = (platform) => {\n    const bundlePath = path.join(\n      \"static-build\",\n      timestamp,\n      \"_expo\",\n      \"static\",\n      \"js\",\n      platform,\n      \"bundle.js\",\n    );\n    let bundle = fs.readFileSync(bundlePath, \"utf-8\");\n\n    bundle = bundle.replace(\n      /httpServerLocation:\"(\\/[^\"]+)\"/g,\n      (_match, capturedPath) => {\n        const tempUrl = new URL(`http://localhost:8081${capturedPath}`);\n        const unstablePath = tempUrl.searchParams.get(\"unstable_path\");\n\n        if (!unstablePath) {\n          throw new Error(\n            `Asset missing unstable_path in bundle: ${capturedPath}`,\n          );\n        }\n\n        const decodedPath = decodeURIComponent(unstablePath).replace(\n          /^\\.\\//,\n          \"\",\n        );\n        return `httpServerLocation:\"${baseUrl}/${timestamp}/_expo/static/js/${decodedPath}\"`;\n      },\n    );\n\n    fs.writeFileSync(bundlePath, bundle);\n  };\n\n  updateForPlatform(\"ios\");\n  updateForPlatform(\"android\");\n  console.log(\"Updated bundle URLs\");\n}\n\nfunction updateManifests(manifests, timestamp, baseUrl, assetsByHash) {\n  const updateForPlatform = (platform, manifest) => {\n    if (!manifest.launchAsset || !manifest.extra) {\n      exitWithError(`Malformed manifest for ${platform}`);\n    }\n\n    manifest.launchAsset.url = `${baseUrl}/${timestamp}/_expo/static/js/${platform}/bundle.js`;\n    manifest.launchAsset.key = `bundle-${timestamp}`;\n    manifest.createdAt = new Date(\n      Number(timestamp.split(\"-\")[0]),\n    ).toISOString();\n    manifest.extra.expoClient.hostUri =\n      baseUrl.replace(\"https://\", \"\") + \"/\" + platform;\n    manifest.extra.expoGo.debuggerHost =\n      baseUrl.replace(\"https://\", \"\") + \"/\" + platform;\n    manifest.extra.expoGo.packagerOpts.dev = false;\n\n    if (manifest.assets && manifest.assets.length > 0) {\n      manifest.assets.forEach((asset) => {\n        if (!asset.url) return;\n\n        const hash = asset.hash;\n        if (!hash) return;\n\n        const assetInfo = assetsByHash.get(hash);\n        if (!assetInfo) return;\n\n        asset.url = `${baseUrl}/${timestamp}/_expo/static/js/${assetInfo.relativePath}/${assetInfo.filename}`;\n      });\n    }\n\n    fs.writeFileSync(\n      path.join(\"static-build\", platform, \"manifest.json\"),\n      JSON.stringify(manifest, null, 2),\n    );\n  };\n\n  updateForPlatform(\"ios\", manifests.ios);\n  updateForPlatform(\"android\", manifests.android);\n  console.log(\"Manifests updated\");\n}\n\nfunction createLandingPage(baseUrl) {\n  const expsUrl = baseUrl.replace(\"https://\", \"\");\n  const template = fs.readFileSync(\n    path.join(\"scripts\", \"landing-page-template.html\"),\n    \"utf-8\",\n  );\n\n  const html = template\n    .replace(/BASE_URL_PLACEHOLDER/g, baseUrl)\n    .replace(/EXPS_URL_PLACEHOLDER/g, expsUrl);\n\n  fs.writeFileSync(path.join(\"static-build\", \"index.html\"), html);\n  console.log(\"Complete\");\n}\n\nasync function main() {\n  console.log(\"Building static Expo Go deployment...\");\n\n  setupSignalHandlers();\n\n  const baseUrl = getDeploymentUrl();\n  const timestamp = `${Date.now()}-${process.pid}`;\n\n  prepareDirectories(timestamp);\n  clearMetroCache();\n\n  await startMetro();\n  const manifests = await downloadBundlesAndManifests(timestamp);\n\n  console.log(\"Processing assets...\");\n  const assets = extractAssets(timestamp);\n  console.log(\"Found\", assets.length, \"unique asset(s)\");\n\n  const assetsByHash = new Map();\n  for (const asset of assets) {\n    assetsByHash.set(asset.hash, {\n      relativePath: asset.relativePath,\n      filename: asset.filename,\n    });\n  }\n\n  const assetCount = await downloadAssets(assets, timestamp);\n\n  if (assetCount > 0) {\n    updateBundleUrls(timestamp, baseUrl);\n  }\n\n  console.log(\"Updating manifests and creating landing page...\");\n  updateManifests(manifests, timestamp, baseUrl, assetsByHash);\n  createLandingPage(baseUrl);\n\n  console.log(\"Build complete! Deploy to:\", baseUrl);\n\n  if (metroProcess) {\n    metroProcess.kill();\n  }\n  process.exit(0);\n}\n\nmain().catch((error) => {\n  console.error(\"Build failed:\", error.message);\n  if (metroProcess) {\n    metroProcess.kill();\n  }\n  process.exit(1);\n});\n","path":null,"size_bytes":12348,"size_tokens":null},"index.js":{"content":"import { registerRootComponent } from \"expo\";\n\nimport App from \"@/App\";\n\nregisterRootComponent(App);\n","path":null,"size_bytes":101,"size_tokens":null},"components/Button.tsx":{"content":"import React, { ReactNode } from \"react\";\nimport { StyleSheet, Pressable, ViewStyle, StyleProp } from \"react-native\";\nimport Animated, {\n  useAnimatedStyle,\n  useSharedValue,\n  withSpring,\n  WithSpringConfig,\n} from \"react-native-reanimated\";\n\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { BorderRadius, Spacing } from \"@/constants/theme\";\n\ninterface ButtonProps {\n  onPress?: () => void;\n  children: ReactNode;\n  style?: StyleProp<ViewStyle>;\n  disabled?: boolean;\n}\n\nconst springConfig: WithSpringConfig = {\n  damping: 15,\n  mass: 0.3,\n  stiffness: 150,\n  overshootClamping: true,\n  energyThreshold: 0.001,\n};\n\nconst AnimatedPressable = Animated.createAnimatedComponent(Pressable);\n\nexport function Button({\n  onPress,\n  children,\n  style,\n  disabled = false,\n}: ButtonProps) {\n  const { theme } = useTheme();\n  const scale = useSharedValue(1);\n\n  const animatedStyle = useAnimatedStyle(() => ({\n    transform: [{ scale: scale.value }],\n  }));\n\n  const handlePressIn = () => {\n    if (!disabled) {\n      scale.value = withSpring(0.98, springConfig);\n    }\n  };\n\n  const handlePressOut = () => {\n    if (!disabled) {\n      scale.value = withSpring(1, springConfig);\n    }\n  };\n\n  return (\n    <AnimatedPressable\n      onPress={disabled ? undefined : onPress}\n      onPressIn={handlePressIn}\n      onPressOut={handlePressOut}\n      disabled={disabled}\n      style={[\n        styles.button,\n        {\n          backgroundColor: theme.link,\n          opacity: disabled ? 0.5 : 1,\n        },\n        style,\n        animatedStyle,\n      ]}\n    >\n      <ThemedText\n        type=\"body\"\n        style={[styles.buttonText, { color: theme.buttonText }]}\n      >\n        {children}\n      </ThemedText>\n    </AnimatedPressable>\n  );\n}\n\nconst styles = StyleSheet.create({\n  button: {\n    height: Spacing.buttonHeight,\n    borderRadius: BorderRadius.full,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  buttonText: {\n    fontWeight: \"600\",\n  },\n});\n","path":null,"size_bytes":2014,"size_tokens":null},"App.tsx":{"content":"import React from \"react\";\nimport { StyleSheet } from \"react-native\";\nimport { NavigationContainer } from \"@react-navigation/native\";\nimport { GestureHandlerRootView } from \"react-native-gesture-handler\";\nimport { KeyboardProvider } from \"react-native-keyboard-controller\";\nimport { SafeAreaProvider } from \"react-native-safe-area-context\";\nimport { StatusBar } from \"expo-status-bar\";\n\nimport RootNavigator from \"@/navigation/RootNavigator\";\nimport { ErrorBoundary } from \"@/components/ErrorBoundary\";\nimport { AuthProvider } from \"@/contexts/AuthContext\";\nimport { DataProvider } from \"@/contexts/DataContext\";\n\nfunction AppContent() {\n  return (\n    <AuthProvider>\n      <DataProvider>\n        <NavigationContainer>\n          <RootNavigator />\n        </NavigationContainer>\n        <StatusBar style=\"auto\" />\n      </DataProvider>\n    </AuthProvider>\n  );\n}\n\nexport default function App() {\n  return (\n    <ErrorBoundary>\n      <SafeAreaProvider>\n        <GestureHandlerRootView style={styles.root}>\n          <KeyboardProvider>\n            <AppContent />\n          </KeyboardProvider>\n        </GestureHandlerRootView>\n      </SafeAreaProvider>\n    </ErrorBoundary>\n  );\n}\n\nconst styles = StyleSheet.create({\n  root: {\n    flex: 1,\n  },\n});\n","path":null,"size_bytes":1246,"size_tokens":null},"hooks/useTheme.ts":{"content":"import { Colors } from \"@/constants/theme\";\nimport { useColorScheme } from \"@/hooks/useColorScheme\";\n\nexport function useTheme() {\n  const colorScheme = useColorScheme();\n  const isDark = colorScheme === \"dark\";\n  const theme = Colors[colorScheme ?? \"light\"];\n\n  return {\n    theme,\n    isDark,\n  };\n}\n","path":null,"size_bytes":302,"size_tokens":null},"components/ErrorFallback.tsx":{"content":"import React, { useState } from \"react\";\nimport { reloadAppAsync } from \"expo\";\nimport {\n  StyleSheet,\n  View,\n  Pressable,\n  ScrollView,\n  Text,\n  Modal,\n} from \"react-native\";\nimport { Feather } from \"@expo/vector-icons\";\nimport { ThemedView } from \"@/components/ThemedView\";\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { Spacing, BorderRadius, Fonts } from \"@/constants/theme\";\n\nexport type ErrorFallbackProps = {\n  error: Error;\n  resetError: () => void;\n};\n\nexport function ErrorFallback({ error, resetError }: ErrorFallbackProps) {\n  const { theme } = useTheme();\n  const [isModalVisible, setIsModalVisible] = useState(false);\n\n  const handleRestart = async () => {\n    try {\n      await reloadAppAsync();\n    } catch (restartError) {\n      console.error(\"Failed to restart app:\", restartError);\n      resetError();\n    }\n  };\n\n  const formatErrorDetails = (): string => {\n    let details = `Error: ${error.message}\\n\\n`;\n    if (error.stack) {\n      details += `Stack Trace:\\n${error.stack}`;\n    }\n    return details;\n  };\n\n  return (\n    <ThemedView style={styles.container}>\n      {__DEV__ ? (\n        <Pressable\n          onPress={() => setIsModalVisible(true)}\n          style={({ pressed }) => [\n            styles.topButton,\n            {\n              backgroundColor: theme.backgroundDefault,\n              opacity: pressed ? 0.8 : 1,\n            },\n          ]}\n        >\n          <Feather name=\"alert-circle\" size={20} color={theme.text} />\n        </Pressable>\n      ) : null}\n\n      <View style={styles.content}>\n        <ThemedText type=\"h1\" style={styles.title}>\n          Something went wrong\n        </ThemedText>\n\n        <ThemedText type=\"body\" style={styles.message}>\n          Comrade encountered an issue. Please reload to continue.\n        </ThemedText>\n\n        <Pressable\n          onPress={handleRestart}\n          style={({ pressed }) => [\n            styles.button,\n            {\n              backgroundColor: theme.link,\n              opacity: pressed ? 0.9 : 1,\n              transform: [{ scale: pressed ? 0.98 : 1 }],\n            },\n          ]}\n        >\n          <ThemedText\n            type=\"body\"\n            style={[styles.buttonText, { color: theme.buttonText }]}\n          >\n            Try Again\n          </ThemedText>\n        </Pressable>\n      </View>\n\n      {__DEV__ ? (\n        <Modal\n          visible={isModalVisible}\n          animationType=\"slide\"\n          transparent={true}\n          onRequestClose={() => setIsModalVisible(false)}\n        >\n          <View style={styles.modalOverlay}>\n            <ThemedView style={styles.modalContainer}>\n              <View style={styles.modalHeader}>\n                <ThemedText type=\"h2\" style={styles.modalTitle}>\n                  Error Details\n                </ThemedText>\n                <Pressable\n                  onPress={() => setIsModalVisible(false)}\n                  style={({ pressed }) => [\n                    styles.closeButton,\n                    { opacity: pressed ? 0.6 : 1 },\n                  ]}\n                >\n                  <Feather name=\"x\" size={24} color={theme.text} />\n                </Pressable>\n              </View>\n\n              <ScrollView\n                style={styles.modalScrollView}\n                contentContainerStyle={styles.modalScrollContent}\n                showsVerticalScrollIndicator\n              >\n                <View\n                  style={[\n                    styles.errorContainer,\n                    { backgroundColor: theme.backgroundDefault },\n                  ]}\n                >\n                  <Text\n                    style={[\n                      styles.errorText,\n                      {\n                        color: theme.text,\n                        fontFamily: Fonts?.mono || \"monospace\",\n                      },\n                    ]}\n                    selectable\n                  >\n                    {formatErrorDetails()}\n                  </Text>\n                </View>\n              </ScrollView>\n            </ThemedView>\n          </View>\n        </Modal>\n      ) : null}\n    </ThemedView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    width: \"100%\",\n    height: \"100%\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    padding: Spacing[\"2xl\"],\n  },\n  content: {\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    gap: Spacing.lg,\n    width: \"100%\",\n    maxWidth: 600,\n  },\n  title: {\n    textAlign: \"center\",\n    lineHeight: 40,\n  },\n  message: {\n    textAlign: \"center\",\n    opacity: 0.7,\n    lineHeight: 24,\n  },\n  topButton: {\n    position: \"absolute\",\n    top: Spacing[\"2xl\"] + Spacing.lg,\n    right: Spacing.lg,\n    width: 44,\n    height: 44,\n    borderRadius: BorderRadius.md,\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    zIndex: 10,\n  },\n  button: {\n    paddingVertical: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    paddingHorizontal: Spacing[\"2xl\"],\n    minWidth: 200,\n    shadowColor: \"#000\",\n    shadowOffset: {\n      width: 0,\n      height: 2,\n    },\n    shadowOpacity: 0.1,\n    shadowRadius: 4,\n    elevation: 3,\n  },\n  buttonText: {\n    fontWeight: \"600\",\n    textAlign: \"center\",\n    fontSize: 16,\n  },\n  modalOverlay: {\n    flex: 1,\n    backgroundColor: \"rgba(0, 0, 0, 0.5)\",\n    justifyContent: \"flex-end\",\n  },\n  modalContainer: {\n    width: \"100%\",\n    height: \"90%\",\n    borderTopLeftRadius: BorderRadius.lg,\n    borderTopRightRadius: BorderRadius.lg,\n  },\n  modalHeader: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n    paddingHorizontal: Spacing.lg,\n    paddingTop: Spacing.lg,\n    paddingBottom: Spacing.md,\n    borderBottomWidth: 1,\n    borderBottomColor: \"rgba(128, 128, 128, 0.2)\",\n  },\n  modalTitle: {\n    fontWeight: \"600\",\n  },\n  closeButton: {\n    padding: Spacing.xs,\n  },\n  modalScrollView: {\n    flex: 1,\n  },\n  modalScrollContent: {\n    padding: Spacing.lg,\n  },\n  errorContainer: {\n    width: \"100%\",\n    borderRadius: BorderRadius.md,\n    overflow: \"hidden\",\n    padding: Spacing.lg,\n  },\n  errorText: {\n    fontSize: 12,\n    lineHeight: 18,\n    width: \"100%\",\n  },\n});\n","path":null,"size_bytes":6216,"size_tokens":null},"screens/EditProfileScreen.tsx":{"content":"import React, { useState } from \"react\";\nimport {\n  View,\n  StyleSheet,\n  TextInput,\n  Pressable,\n} from \"react-native\";\nimport { useNavigation } from \"@react-navigation/native\";\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { ScreenKeyboardAwareScrollView } from \"@/components/ScreenKeyboardAwareScrollView\";\nimport { Button } from \"@/components/Button\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { useAuth } from \"@/contexts/AuthContext\";\nimport { Spacing, BorderRadius } from \"@/constants/theme\";\nimport { AVATAR_COLORS } from \"@/types\";\n\nexport default function EditProfileScreen() {\n  const { theme } = useTheme();\n  const { user, updateProfile } = useAuth();\n  const navigation = useNavigation();\n  const [displayName, setDisplayName] = useState(user?.displayName || \"\");\n  const [bio, setBio] = useState(user?.bio || \"\");\n  const [selectedColor, setSelectedColor] = useState(user?.avatarColor || AVATAR_COLORS[0]);\n  const [isSaving, setIsSaving] = useState(false);\n\n  const handleSave = async () => {\n    if (!displayName.trim()) return;\n\n    setIsSaving(true);\n    try {\n      await updateProfile({\n        displayName: displayName.trim(),\n        bio: bio.trim(),\n        avatarColor: selectedColor,\n      });\n      navigation.goBack();\n    } catch (error) {\n      console.error(\"Failed to update profile:\", error);\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  const hasChanges =\n    displayName.trim() !== user?.displayName ||\n    bio.trim() !== (user?.bio || \"\") ||\n    selectedColor !== user?.avatarColor;\n\n  return (\n    <ScreenKeyboardAwareScrollView contentContainerStyle={styles.content}>\n      <View style={styles.avatarSection}>\n        <View style={[styles.avatar, { backgroundColor: selectedColor }]}>\n          <ThemedText\n            type=\"h1\"\n            lightColor=\"#fff\"\n            darkColor=\"#fff\"\n            style={styles.avatarText}\n          >\n            {displayName.charAt(0).toUpperCase() || \"?\"}\n          </ThemedText>\n        </View>\n        <ThemedText type=\"small\" style={[styles.avatarHint, { color: theme.textSecondary }]}>\n          Choose your avatar color\n        </ThemedText>\n        <View style={styles.colorPicker}>\n          {AVATAR_COLORS.map((color) => (\n            <Pressable\n              key={color}\n              style={({ pressed }) => [\n                styles.colorOption,\n                { backgroundColor: color, opacity: pressed ? 0.8 : 1 },\n                selectedColor === color && [styles.selectedColor, { borderColor: theme.text }],\n              ]}\n              onPress={() => setSelectedColor(color)}\n            />\n          ))}\n        </View>\n      </View>\n\n      <View style={styles.inputContainer}>\n        <ThemedText type=\"small\" style={styles.label}>\n          Display Name\n        </ThemedText>\n        <TextInput\n          style={[\n            styles.input,\n            {\n              backgroundColor: theme.inputBackground,\n              borderColor: theme.border,\n              color: theme.text,\n            },\n          ]}\n          placeholder=\"Enter your name\"\n          placeholderTextColor={theme.textSecondary}\n          value={displayName}\n          onChangeText={setDisplayName}\n          autoCapitalize=\"words\"\n          maxLength={30}\n        />\n      </View>\n\n      <View style={styles.inputContainer}>\n        <ThemedText type=\"small\" style={styles.label}>\n          Bio\n        </ThemedText>\n        <TextInput\n          style={[\n            styles.textArea,\n            {\n              backgroundColor: theme.inputBackground,\n              borderColor: theme.border,\n              color: theme.text,\n            },\n          ]}\n          placeholder=\"Tell us about yourself\"\n          placeholderTextColor={theme.textSecondary}\n          value={bio}\n          onChangeText={setBio}\n          multiline\n          numberOfLines={3}\n          maxLength={150}\n          textAlignVertical=\"top\"\n        />\n        <ThemedText type=\"caption\" style={[styles.charCount, { color: theme.textSecondary }]}>\n          {bio.length}/150\n        </ThemedText>\n      </View>\n\n      <Button\n        onPress={handleSave}\n        disabled={!displayName.trim() || !hasChanges || isSaving}\n        style={[styles.saveButton, { backgroundColor: theme.primary }]}\n      >\n        {isSaving ? \"Saving...\" : \"Save Changes\"}\n      </Button>\n    </ScreenKeyboardAwareScrollView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  content: {\n    paddingHorizontal: Spacing.xl,\n  },\n  avatarSection: {\n    alignItems: \"center\",\n    marginBottom: Spacing[\"3xl\"],\n  },\n  avatar: {\n    width: 100,\n    height: 100,\n    borderRadius: 50,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    marginBottom: Spacing.md,\n  },\n  avatarText: {\n    fontSize: 40,\n  },\n  avatarHint: {\n    marginBottom: Spacing.md,\n  },\n  colorPicker: {\n    flexDirection: \"row\",\n    gap: Spacing.md,\n  },\n  colorOption: {\n    width: 36,\n    height: 36,\n    borderRadius: 18,\n  },\n  selectedColor: {\n    borderWidth: 3,\n  },\n  inputContainer: {\n    marginBottom: Spacing.xl,\n  },\n  label: {\n    marginBottom: Spacing.sm,\n    fontWeight: \"500\",\n  },\n  input: {\n    height: Spacing.inputHeight,\n    borderWidth: 1,\n    borderRadius: BorderRadius.xs,\n    paddingHorizontal: Spacing.lg,\n    fontSize: 16,\n  },\n  textArea: {\n    minHeight: 80,\n    borderWidth: 1,\n    borderRadius: BorderRadius.xs,\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.md,\n    fontSize: 16,\n  },\n  charCount: {\n    textAlign: \"right\",\n    marginTop: Spacing.xs,\n  },\n  saveButton: {\n    marginTop: Spacing.lg,\n  },\n});\n","path":null,"size_bytes":5586,"size_tokens":null},"screens/CreatePostScreen.tsx":{"content":"import React, { useState } from \"react\";\nimport {\n  View,\n  StyleSheet,\n  TextInput,\n  Pressable,\n  Platform,\n} from \"react-native\";\nimport { useSafeAreaInsets } from \"react-native-safe-area-context\";\nimport { useNavigation, useRoute, RouteProp } from \"@react-navigation/native\";\nimport { Feather } from \"@expo/vector-icons\";\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { ThemedView } from \"@/components/ThemedView\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { useAuth } from \"@/contexts/AuthContext\";\nimport { useData } from \"@/contexts/DataContext\";\nimport { Spacing, BorderRadius } from \"@/constants/theme\";\n\ntype CreatePostParams = {\n  CreatePost: {\n    orgId?: string;\n    orgName?: string;\n    postToOrgFeed?: boolean;\n  };\n};\n\ntype CreatePostRouteProp = RouteProp<CreatePostParams, \"CreatePost\">;\n\nexport default function CreatePostScreen() {\n  const { theme } = useTheme();\n  const { user } = useAuth();\n  const navigation = useNavigation();\n  const route = useRoute<CreatePostRouteProp>();\n  const insets = useSafeAreaInsets();\n  const { createPost, getCityName, selectedCity } = useData();\n  const [content, setContent] = useState(\"\");\n  const [isPosting, setIsPosting] = useState(false);\n\n  const { orgId, orgName, postToOrgFeed } = route.params || {};\n  const isOrgPost = !!orgId;\n\n  const handlePost = async () => {\n    if (!content.trim()) return;\n\n    setIsPosting(true);\n    try {\n      await createPost(\n        content.trim(),\n        postToOrgFeed ? orgId : undefined,\n        postToOrgFeed ? orgName : undefined\n      );\n      navigation.goBack();\n    } catch (error) {\n      console.error(\"Failed to create post:\", error);\n    } finally {\n      setIsPosting(false);\n    }\n  };\n\n  const handleClose = () => {\n    navigation.goBack();\n  };\n\n  const canPost = content.trim().length > 0 && !isPosting;\n\n  return (\n    <ThemedView style={styles.container}>\n      <View style={[styles.header, { borderBottomColor: theme.border }]}>\n        <Pressable\n          style={({ pressed }) => [{ opacity: pressed ? 0.7 : 1 }]}\n          onPress={handleClose}\n        >\n          <Feather name=\"x\" size={24} color={theme.text} />\n        </Pressable>\n        <ThemedText type=\"h4\">Create Post</ThemedText>\n        <Pressable\n          style={({ pressed }) => [\n            styles.postButton,\n            {\n              backgroundColor: canPost ? theme.primary : theme.backgroundSecondary,\n              opacity: canPost ? (pressed ? 0.8 : 1) : 0.5,\n            },\n          ]}\n          onPress={handlePost}\n          disabled={!canPost}\n        >\n          <ThemedText\n            type=\"body\"\n            style={{ color: canPost ? \"#fff\" : theme.textSecondary, fontWeight: \"600\" }}\n          >\n            {isPosting ? \"Posting...\" : \"Post\"}\n          </ThemedText>\n        </Pressable>\n      </View>\n\n      <View style={styles.content}>\n        <View style={styles.userRow}>\n          <View style={[styles.avatar, { backgroundColor: user?.avatarColor || theme.primary }]}>\n            <ThemedText type=\"body\" lightColor=\"#fff\" darkColor=\"#fff\" style={{ fontWeight: \"600\" }}>\n              {user?.displayName.charAt(0).toUpperCase() || \"?\"}\n            </ThemedText>\n          </View>\n          <View>\n            <ThemedText type=\"h4\">{user?.displayName}</ThemedText>\n            <View style={styles.postingTo}>\n              <Feather\n                name={isOrgPost && postToOrgFeed ? \"briefcase\" : \"globe\"}\n                size={12}\n                color={theme.textSecondary}\n              />\n              <ThemedText type=\"caption\" style={{ color: theme.textSecondary, marginLeft: 4 }}>\n                {isOrgPost && postToOrgFeed\n                  ? `Posting to ${orgName}`\n                  : `Posting to ${getCityName(selectedCity)}`}\n              </ThemedText>\n            </View>\n          </View>\n        </View>\n\n        <TextInput\n          style={[styles.input, { color: theme.text }]}\n          placeholder=\"What's on your mind?\"\n          placeholderTextColor={theme.textSecondary}\n          value={content}\n          onChangeText={setContent}\n          multiline\n          autoFocus\n          maxLength={500}\n          textAlignVertical=\"top\"\n        />\n\n        <View style={[styles.footer, { borderTopColor: theme.border }]}>\n          <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n            {content.length}/500\n          </ThemedText>\n          <View style={styles.encryptedBadge}>\n            <Feather name=\"lock\" size={12} color={theme.success} />\n            <ThemedText type=\"caption\" style={{ color: theme.success, marginLeft: 4 }}>\n              End-to-end encrypted\n            </ThemedText>\n          </View>\n        </View>\n      </View>\n    </ThemedView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  header: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"space-between\",\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.md,\n    borderBottomWidth: 1,\n  },\n  postButton: {\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.sm,\n    borderRadius: BorderRadius.full,\n  },\n  content: {\n    flex: 1,\n    padding: Spacing.lg,\n  },\n  userRow: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    marginBottom: Spacing.lg,\n  },\n  avatar: {\n    width: 44,\n    height: 44,\n    borderRadius: 22,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    marginRight: Spacing.md,\n  },\n  postingTo: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    marginTop: 2,\n  },\n  input: {\n    flex: 1,\n    fontSize: 18,\n    lineHeight: 26,\n  },\n  footer: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"space-between\",\n    paddingTop: Spacing.md,\n    borderTopWidth: 1,\n  },\n  encryptedBadge: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n  },\n});\n","path":null,"size_bytes":5854,"size_tokens":null},"screens/QRScannerScreen.tsx":{"content":"import React, { useState, useEffect } from \"react\";\nimport {\n  View,\n  StyleSheet,\n  Pressable,\n  Platform,\n} from \"react-native\";\nimport { useSafeAreaInsets } from \"react-native-safe-area-context\";\nimport { useNavigation } from \"@react-navigation/native\";\nimport { CameraView, useCameraPermissions } from \"expo-camera\";\nimport { Feather } from \"@expo/vector-icons\";\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { ThemedView } from \"@/components/ThemedView\";\nimport { Button } from \"@/components/Button\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { useData } from \"@/contexts/DataContext\";\nimport { Spacing, BorderRadius } from \"@/constants/theme\";\nimport { AVATAR_COLORS } from \"@/types\";\n\nexport default function QRScannerScreen() {\n  const { theme } = useTheme();\n  const navigation = useNavigation();\n  const insets = useSafeAreaInsets();\n  const { addComrade } = useData();\n  const [permission, requestPermission] = useCameraPermissions();\n  const [scanned, setScanned] = useState(false);\n  const [scannedUser, setScannedUser] = useState<{ id: string; name: string } | null>(null);\n  const [isAdding, setIsAdding] = useState(false);\n\n  const handleBarCodeScanned = ({ type, data }: { type: string; data: string }) => {\n    if (scanned) return;\n    setScanned(true);\n    \n    try {\n      if (data.startsWith(\"comrade://user/\")) {\n        const userId = data.replace(\"comrade://user/\", \"\");\n        setScannedUser({\n          id: userId,\n          name: \"Scanned Comrade\",\n        });\n      } else {\n        setScannedUser({\n          id: data.substring(0, 20),\n          name: \"New Comrade\",\n        });\n      }\n    } catch (error) {\n      console.error(\"Failed to parse QR code:\", error);\n      setScanned(false);\n    }\n  };\n\n  const handleAddComrade = async () => {\n    if (!scannedUser) return;\n\n    setIsAdding(true);\n    try {\n      await addComrade(scannedUser.id);\n      navigation.goBack();\n    } catch (error) {\n      console.error(\"Failed to add comrade:\", error);\n    } finally {\n      setIsAdding(false);\n    }\n  };\n\n  const handleScanAgain = () => {\n    setScanned(false);\n    setScannedUser(null);\n  };\n\n  if (Platform.OS === \"web\") {\n    return (\n      <ThemedView style={styles.container}>\n        <View style={[styles.webFallback, { paddingTop: insets.top + Spacing.xl }]}>\n          <Feather name=\"camera-off\" size={64} color={theme.textSecondary} />\n          <ThemedText type=\"h3\" style={styles.webTitle}>\n            Camera Not Available\n          </ThemedText>\n          <ThemedText type=\"body\" style={[styles.webText, { color: theme.textSecondary }]}>\n            Run this app in Expo Go on your mobile device to scan QR codes\n          </ThemedText>\n          <Button onPress={() => navigation.goBack()} style={{ marginTop: Spacing.xl }}>\n            Go Back\n          </Button>\n        </View>\n      </ThemedView>\n    );\n  }\n\n  if (!permission) {\n    return (\n      <ThemedView style={styles.container}>\n        <View style={styles.centered}>\n          <ThemedText type=\"body\">Loading camera...</ThemedText>\n        </View>\n      </ThemedView>\n    );\n  }\n\n  if (!permission.granted) {\n    return (\n      <ThemedView style={styles.container}>\n        <View style={[styles.permissionContainer, { paddingTop: insets.top + Spacing[\"4xl\"] }]}>\n          <Feather name=\"camera\" size={64} color={theme.textSecondary} />\n          <ThemedText type=\"h3\" style={styles.permissionTitle}>\n            Camera Access Required\n          </ThemedText>\n          <ThemedText type=\"body\" style={[styles.permissionText, { color: theme.textSecondary }]}>\n            We need camera access to scan QR codes and connect with comrades\n          </ThemedText>\n          <Button onPress={requestPermission} style={{ marginTop: Spacing.xl }}>\n            Grant Permission\n          </Button>\n        </View>\n      </ThemedView>\n    );\n  }\n\n  return (\n    <View style={styles.container}>\n      <CameraView\n        style={StyleSheet.absoluteFillObject}\n        facing=\"back\"\n        onBarcodeScanned={scanned ? undefined : handleBarCodeScanned}\n        barcodeScannerSettings={{\n          barcodeTypes: [\"qr\"],\n        }}\n      />\n\n      <View style={[styles.overlay, { paddingTop: insets.top }]}>\n        <View style={styles.header}>\n          <Pressable\n            style={({ pressed }) => [\n              styles.closeButton,\n              { backgroundColor: \"rgba(0,0,0,0.5)\", opacity: pressed ? 0.7 : 1 },\n            ]}\n            onPress={() => navigation.goBack()}\n          >\n            <Feather name=\"x\" size={24} color=\"#fff\" />\n          </Pressable>\n          <ThemedText type=\"h4\" lightColor=\"#fff\" darkColor=\"#fff\">\n            Scan QR Code\n          </ThemedText>\n          <View style={{ width: 44 }} />\n        </View>\n\n        <View style={styles.scanArea}>\n          <View style={[styles.scanFrame, { borderColor: theme.primary }]}>\n            <View style={[styles.corner, styles.topLeft, { borderColor: theme.primary }]} />\n            <View style={[styles.corner, styles.topRight, { borderColor: theme.primary }]} />\n            <View style={[styles.corner, styles.bottomLeft, { borderColor: theme.primary }]} />\n            <View style={[styles.corner, styles.bottomRight, { borderColor: theme.primary }]} />\n          </View>\n        </View>\n\n        {scannedUser ? (\n          <View style={[styles.resultContainer, { backgroundColor: theme.surface }]}>\n            <View style={[styles.scannedAvatar, { backgroundColor: AVATAR_COLORS[0] }]}>\n              <ThemedText type=\"h3\" lightColor=\"#fff\" darkColor=\"#fff\">\n                {scannedUser.name.charAt(0)}\n              </ThemedText>\n            </View>\n            <ThemedText type=\"h4\" style={styles.scannedName}>\n              {scannedUser.name}\n            </ThemedText>\n            <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n              ID: {scannedUser.id.substring(0, 12)}...\n            </ThemedText>\n            <View style={styles.resultButtons}>\n              <Pressable\n                style={({ pressed }) => [\n                  styles.resultButton,\n                  { backgroundColor: theme.backgroundSecondary, opacity: pressed ? 0.8 : 1 },\n                ]}\n                onPress={handleScanAgain}\n              >\n                <ThemedText type=\"body\">Scan Again</ThemedText>\n              </Pressable>\n              <Pressable\n                style={({ pressed }) => [\n                  styles.resultButton,\n                  { backgroundColor: theme.primary, opacity: isAdding ? 0.5 : pressed ? 0.8 : 1 },\n                ]}\n                onPress={handleAddComrade}\n                disabled={isAdding}\n              >\n                <ThemedText type=\"body\" style={{ color: \"#fff\" }}>\n                  {isAdding ? \"Adding...\" : \"Add Comrade\"}\n                </ThemedText>\n              </Pressable>\n            </View>\n          </View>\n        ) : (\n          <View style={styles.hint}>\n            <ThemedText type=\"body\" lightColor=\"#fff\" darkColor=\"#fff\" style={{ textAlign: \"center\" }}>\n              Point your camera at a comrade's QR code\n            </ThemedText>\n          </View>\n        )}\n      </View>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: \"#000\",\n  },\n  centered: {\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  webFallback: {\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    padding: Spacing.xl,\n  },\n  webTitle: {\n    marginTop: Spacing.lg,\n    textAlign: \"center\",\n  },\n  webText: {\n    textAlign: \"center\",\n    marginTop: Spacing.sm,\n  },\n  permissionContainer: {\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    padding: Spacing.xl,\n  },\n  permissionTitle: {\n    marginTop: Spacing.lg,\n    textAlign: \"center\",\n  },\n  permissionText: {\n    textAlign: \"center\",\n    marginTop: Spacing.sm,\n  },\n  overlay: {\n    ...StyleSheet.absoluteFillObject,\n    justifyContent: \"space-between\",\n  },\n  header: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"space-between\",\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.md,\n  },\n  closeButton: {\n    width: 44,\n    height: 44,\n    borderRadius: 22,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  scanArea: {\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  scanFrame: {\n    width: 250,\n    height: 250,\n    borderWidth: 2,\n    borderRadius: BorderRadius.sm,\n    position: \"relative\",\n  },\n  corner: {\n    position: \"absolute\",\n    width: 30,\n    height: 30,\n    borderWidth: 4,\n  },\n  topLeft: {\n    top: -2,\n    left: -2,\n    borderRightWidth: 0,\n    borderBottomWidth: 0,\n    borderTopLeftRadius: BorderRadius.sm,\n  },\n  topRight: {\n    top: -2,\n    right: -2,\n    borderLeftWidth: 0,\n    borderBottomWidth: 0,\n    borderTopRightRadius: BorderRadius.sm,\n  },\n  bottomLeft: {\n    bottom: -2,\n    left: -2,\n    borderRightWidth: 0,\n    borderTopWidth: 0,\n    borderBottomLeftRadius: BorderRadius.sm,\n  },\n  bottomRight: {\n    bottom: -2,\n    right: -2,\n    borderLeftWidth: 0,\n    borderTopWidth: 0,\n    borderBottomRightRadius: BorderRadius.sm,\n  },\n  hint: {\n    padding: Spacing.xl,\n    backgroundColor: \"rgba(0,0,0,0.5)\",\n  },\n  resultContainer: {\n    margin: Spacing.lg,\n    padding: Spacing.xl,\n    borderRadius: BorderRadius.md,\n    alignItems: \"center\",\n  },\n  scannedAvatar: {\n    width: 60,\n    height: 60,\n    borderRadius: 30,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    marginBottom: Spacing.md,\n  },\n  scannedName: {\n    marginBottom: Spacing.xs,\n  },\n  resultButtons: {\n    flexDirection: \"row\",\n    gap: Spacing.md,\n    marginTop: Spacing.xl,\n  },\n  resultButton: {\n    paddingHorizontal: Spacing.xl,\n    paddingVertical: Spacing.md,\n    borderRadius: BorderRadius.full,\n  },\n});\n","path":null,"size_bytes":9861,"size_tokens":null},"eslint.config.js":{"content":"// https://docs.expo.dev/guides/using-eslint/\nconst { defineConfig } = require(\"eslint/config\");\nconst expoConfig = require(\"eslint-config-expo/flat\");\nconst eslintPluginPrettierRecommended = require(\"eslint-plugin-prettier/recommended\");\n\nmodule.exports = defineConfig([\n  expoConfig,\n  eslintPluginPrettierRecommended,\n  {\n    ignores: [\"dist/*\"],\n  },\n]);\n","path":null,"size_bytes":359,"size_tokens":null},"hooks/useColorScheme.web.ts":{"content":"import { useEffect, useState } from \"react\";\nimport { useColorScheme as useRNColorScheme } from \"react-native\";\n\n/**\n * To support static rendering, this value needs to be re-calculated on the client side for web\n */\nexport function useColorScheme() {\n  const [hasHydrated, setHasHydrated] = useState(false);\n\n  useEffect(() => {\n    setHasHydrated(true);\n  }, []);\n\n  const colorScheme = useRNColorScheme();\n\n  if (hasHydrated) {\n    return colorScheme;\n  }\n\n  return \"light\";\n}\n","path":null,"size_bytes":480,"size_tokens":null},"utils/locationUtils.ts":{"content":"import { Country, State, City } from \"country-state-city\";\n\n// Major world cities with coordinates for location matching via GPS\nconst MAJOR_CITIES_WITH_COORDS: Array<{ name: string; lat: number; lng: number }> = [\n  { name: \"San Francisco\", lat: 37.7749, lng: -122.4194 },\n  { name: \"New York\", lat: 40.7128, lng: -74.006 },\n  { name: \"Los Angeles\", lat: 34.0522, lng: -118.2437 },\n  { name: \"Chicago\", lat: 41.8781, lng: -87.6298 },\n  { name: \"Seattle\", lat: 47.6062, lng: -122.3321 },\n  { name: \"Austin\", lat: 30.2672, lng: -97.7431 },\n  { name: \"Boston\", lat: 42.3601, lng: -71.0589 },\n  { name: \"Denver\", lat: 39.7392, lng: -104.9903 },\n  { name: \"Miami\", lat: 25.7617, lng: -80.1918 },\n  { name: \"Portland\", lat: 45.5152, lng: -122.6784 },\n  { name: \"London\", lat: 51.5074, lng: -0.1278 },\n  { name: \"Paris\", lat: 48.8566, lng: 2.3522 },\n  { name: \"Tokyo\", lat: 35.6762, lng: 139.6503 },\n  { name: \"Sydney\", lat: -33.8688, lng: 151.2093 },\n  { name: \"Toronto\", lat: 43.6532, lng: -79.3832 },\n  { name: \"Vancouver\", lat: 49.2827, lng: -123.1207 },\n  { name: \"Mexico City\", lat: 19.4326, lng: -99.1332 },\n  { name: \"SÃ£o Paulo\", lat: -23.5505, lng: -46.6333 },\n  { name: \"Singapore\", lat: 1.3521, lng: 103.8198 },\n  { name: \"Hong Kong\", lat: 22.3193, lng: 114.1694 },\n];\n\n// Cache for all cities from country-state-city\nlet allCitiesCache: string[] | null = null;\n\nfunction getDistanceFromCoordinates(\n  lat1: number,\n  lon1: number,\n  lat2: number,\n  lon2: number\n): number {\n  const R = 3959; // Earth's radius in miles\n  const dLat = ((lat2 - lat1) * Math.PI) / 180;\n  const dLon = ((lon2 - lon1) * Math.PI) / 180;\n  const a =\n    Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n    Math.cos((lat1 * Math.PI) / 180) *\n      Math.cos((lat2 * Math.PI) / 180) *\n      Math.sin(dLon / 2) *\n      Math.sin(dLon / 2);\n  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n  return R * c;\n}\n\nexport function findNearestCity(latitude: number, longitude: number): string {\n  let nearestCity = MAJOR_CITIES_WITH_COORDS[0];\n  let minDistance = getDistanceFromCoordinates(\n    latitude,\n    longitude,\n    nearestCity.lat,\n    nearestCity.lng\n  );\n\n  for (let i = 1; i < MAJOR_CITIES_WITH_COORDS.length; i++) {\n    const city = MAJOR_CITIES_WITH_COORDS[i];\n    const distance = getDistanceFromCoordinates(\n      latitude,\n      longitude,\n      city.lat,\n      city.lng\n    );\n\n    if (distance < minDistance) {\n      minDistance = distance;\n      nearestCity = city;\n    }\n  }\n\n  return nearestCity.name;\n}\n\n// Get major cities for immediate display\nexport function getMajorCities(): string[] {\n  return MAJOR_CITIES_WITH_COORDS.map((city) => city.name).sort();\n}\n\n// Lazy-load all cities when needed (with limit to prevent memory crash)\nexport function searchCities(query: string, limit: number = 100): string[] {\n  if (!query.trim()) {\n    // Return major cities if no search\n    return getMajorCities();\n  }\n\n  if (!allCitiesCache) {\n    // Load all cities on first search\n    const cities = new Set<string>();\n    const countries = Country.getAllCountries();\n\n    countries.forEach((country) => {\n      const states = State.getStatesOfCountry(country.isoCode);\n      states.forEach((state) => {\n        const stateCities = City.getCitiesOfState(country.isoCode, state.isoCode);\n        stateCities.forEach((city) => {\n          cities.add(city.name);\n        });\n      });\n    });\n\n    allCitiesCache = Array.from(cities).sort();\n  }\n\n  // Filter and limit results\n  const searchLower = query.toLowerCase();\n  return allCitiesCache\n    .filter((city) => city.toLowerCase().includes(searchLower))\n    .slice(0, limit);\n}\n","path":null,"size_bytes":3620,"size_tokens":null},"components/ErrorBoundary.tsx":{"content":"import React, { Component, ComponentType, PropsWithChildren } from \"react\";\nimport { ErrorFallback, ErrorFallbackProps } from \"@/components/ErrorFallback\";\n\nexport type ErrorBoundaryProps = PropsWithChildren<{\n  FallbackComponent?: ComponentType<ErrorFallbackProps>;\n  onError?: (error: Error, stackTrace: string) => void;\n}>;\n\ntype ErrorBoundaryState = { error: Error | null };\n\n/**\n * This is a special case for for using the class components. Error boundaries must be class components because React only provides error boundary functionality through lifecycle methods (componentDidCatch and getDerivedStateFromError) which are not available in functional components.\n * https://react.dev/reference/react/Component#catching-rendering-errors-with-an-error-boundary\n */\n\nexport class ErrorBoundary extends Component<\n  ErrorBoundaryProps,\n  ErrorBoundaryState\n> {\n  state: ErrorBoundaryState = { error: null };\n\n  static defaultProps: {\n    FallbackComponent: ComponentType<ErrorFallbackProps>;\n  } = {\n    FallbackComponent: ErrorFallback,\n  };\n\n  static getDerivedStateFromError(error: Error): ErrorBoundaryState {\n    return { error };\n  }\n\n  componentDidCatch(error: Error, info: { componentStack: string }): void {\n    if (typeof this.props.onError === \"function\") {\n      this.props.onError(error, info.componentStack);\n    }\n  }\n\n  resetError = (): void => {\n    this.setState({ error: null });\n  };\n\n  render() {\n    const { FallbackComponent } = this.props;\n\n    return this.state.error && FallbackComponent ? (\n      <FallbackComponent\n        error={this.state.error}\n        resetError={this.resetError}\n      />\n    ) : (\n      this.props.children\n    );\n  }\n}\n","path":null,"size_bytes":1674,"size_tokens":null},"hooks/useColorScheme.ts":{"content":"export { useColorScheme } from \"react-native\";\n","path":null,"size_bytes":47,"size_tokens":null},"navigation/ProfileStackNavigator.tsx":{"content":"import React from \"react\";\nimport { Pressable } from \"react-native\";\nimport { createNativeStackNavigator } from \"@react-navigation/native-stack\";\nimport { Feather } from \"@expo/vector-icons\";\nimport UserProfileScreen from \"@/screens/UserProfileScreen\";\nimport SettingsScreen from \"@/screens/SettingsScreen\";\nimport EditProfileScreen from \"@/screens/EditProfileScreen\";\nimport QRScannerScreen from \"@/screens/QRScannerScreen\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { getCommonScreenOptions } from \"@/navigation/screenOptions\";\n\nexport type ProfileStackParamList = {\n  Profile: undefined;\n  Settings: undefined;\n  EditProfile: undefined;\n  QRScanner: undefined;\n};\n\nconst Stack = createNativeStackNavigator<ProfileStackParamList>();\n\nexport default function ProfileStackNavigator() {\n  const { theme, isDark } = useTheme();\n\n  return (\n    <Stack.Navigator\n      screenOptions={{\n        ...getCommonScreenOptions({ theme, isDark, transparent: false }),\n      }}\n    >\n      <Stack.Screen\n        name=\"Profile\"\n        component={UserProfileScreen}\n        options={({ navigation }) => ({\n          headerTitle: \"Profile\",\n          headerRight: () => (\n            <Pressable\n              onPress={() => navigation.navigate(\"Settings\")}\n              style={({ pressed }) => ({ opacity: pressed ? 0.7 : 1 })}\n            >\n              <Feather name=\"settings\" size={22} color={theme.text} />\n            </Pressable>\n          ),\n        })}\n      />\n      <Stack.Screen\n        name=\"Settings\"\n        component={SettingsScreen}\n        options={{\n          headerTitle: \"Settings\",\n        }}\n      />\n      <Stack.Screen\n        name=\"EditProfile\"\n        component={EditProfileScreen}\n        options={{\n          headerTitle: \"Edit Profile\",\n          presentation: \"modal\",\n        }}\n      />\n      <Stack.Screen\n        name=\"QRScanner\"\n        component={QRScannerScreen}\n        options={{\n          headerShown: false,\n          presentation: \"fullScreenModal\",\n        }}\n      />\n    </Stack.Navigator>\n  );\n}\n","path":null,"size_bytes":2040,"size_tokens":null}},"version":2}